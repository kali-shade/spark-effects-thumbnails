"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const sA=require("three");var ke=typeof document<"u"?document.currentScript:null;function Go(t){const A=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const e in t)if(e!=="default"){const s=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(A,e,s.get?s:{enumerable:!0,get:()=>t[e]})}}return A.default=t,Object.freeze(A)}const I=Go(sA),Ro=new sA.OrthographicCamera(-1,1,1,-1,0,1);class Yo extends sA.BufferGeometry{constructor(){super(),this.setAttribute("position",new sA.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new sA.Float32BufferAttribute([0,2,0,0,2,0],2))}}const Jo=new Yo;class Ds{constructor(A){this._mesh=new sA.Mesh(Jo,A)}dispose(){this._mesh.geometry.dispose()}render(A){A.render(this._mesh,Ro)}get material(){return this._mesh.material}set material(A){this._mesh.material=A}}var hA=Uint8Array,xt=Uint16Array,_o=Int32Array,Ms=new hA([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vs=new hA([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Lo=new hA([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bs=function(t,A){for(var e=new xt(31),s=0;s<31;++s)e[s]=A+=1<<t[s-1];for(var n=new _o(e[30]),s=1;s<30;++s)for(var i=e[s];i<e[s+1];++i)n[i]=i-e[s]<<5|s;return{b:e,r:n}},Fs=bs(Ms,2),Ns=Fs.b,zo=Fs.r;Ns[28]=258,zo[258]=28;var Ho=bs(vs,0),qo=Ho.b,Le=new xt(32768);for(var nA=0;nA<32768;++nA){var tt=(nA&43690)>>1|(nA&21845)<<1;tt=(tt&52428)>>2|(tt&13107)<<2,tt=(tt&61680)>>4|(tt&3855)<<4,Le[nA]=((tt&65280)>>8|(tt&255)<<8)>>1}var Ht=function(t,A,e){for(var s=t.length,n=0,i=new xt(A);n<s;++n)t[n]&&++i[t[n]-1];var r=new xt(A);for(n=1;n<A;++n)r[n]=r[n-1]+i[n-1]<<1;var a;if(e){a=new xt(1<<A);var o=15-A;for(n=0;n<s;++n)if(t[n])for(var g=n<<4|t[n],l=A-t[n],c=r[t[n]-1]++<<l,u=c|(1<<l)-1;c<=u;++c)a[Le[c]>>o]=g}else for(a=new xt(s),n=0;n<s;++n)t[n]&&(a[n]=Le[r[t[n]-1]++]>>15-t[n]);return a},te=new hA(288);for(var nA=0;nA<144;++nA)te[nA]=8;for(var nA=144;nA<256;++nA)te[nA]=9;for(var nA=256;nA<280;++nA)te[nA]=7;for(var nA=280;nA<288;++nA)te[nA]=8;var Ts=new hA(32);for(var nA=0;nA<32;++nA)Ts[nA]=5;var Ko=Ht(te,9,1),$o=Ht(Ts,5,1),Ue=function(t){for(var A=t[0],e=1;e<t.length;++e)t[e]>A&&(A=t[e]);return A},_A=function(t,A,e){var s=A/8|0;return(t[s]|t[s+1]<<8)>>(A&7)&e},Ge=function(t,A){var e=A/8|0;return(t[e]|t[e+1]<<8|t[e+2]<<16)>>(A&7)},ks=function(t){return(t+7)/8|0},vt=function(t,A,e){return(A==null||A<0)&&(A=0),(e==null||e>t.length)&&(e=t.length),new hA(t.subarray(A,e))},Po=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],wA=function(t,A,e){var s=new Error(A||Po[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,wA),!e)throw s;return s},Us=function(t,A,e,s){var n=t.length,i=s?s.length:0;if(!n||A.f&&!A.l)return e||new hA(0);var r=!e,a=r||A.i!=2,o=A.i;r&&(e=new hA(n*3));var g=function(mA){var SA=e.length;if(mA>SA){var BA=new hA(Math.max(SA*2,mA));BA.set(e),e=BA}},l=A.f||0,c=A.p||0,u=A.b||0,h=A.l,E=A.d,C=A.m,B=A.n,Q=n*8;do{if(!h){l=_A(t,c,1);var f=_A(t,c+1,3);if(c+=3,f)if(f==1)h=Ko,E=$o,C=9,B=5;else if(f==2){var D=_A(t,c,31)+257,x=_A(t,c+10,15)+4,m=D+_A(t,c+5,31)+1;c+=14;for(var w=new hA(m),T=new hA(19),M=0;M<x;++M)T[Lo[M]]=_A(t,c+M*3,7);c+=x*3;for(var S=Ue(T),U=(1<<S)-1,F=Ht(T,S,1),M=0;M<m;){var b=F[_A(t,c,U)];c+=b&15;var p=b>>4;if(p<16)w[M++]=p;else{var k=0,R=0;for(p==16?(R=3+_A(t,c,3),c+=2,k=w[M-1]):p==17?(R=3+_A(t,c,7),c+=3):p==18&&(R=11+_A(t,c,127),c+=7);R--;)w[M++]=k}}var X=w.subarray(0,D),_=w.subarray(D);C=Ue(X),B=Ue(_),h=Ht(X,C,1),E=Ht(_,B,1)}else wA(1);else{var p=ks(c)+4,d=t[p-4]|t[p-3]<<8,y=p+d;if(y>n){o&&wA(0);break}a&&g(u+d),e.set(t.subarray(p,y),u),A.b=u+=d,A.p=c=y*8,A.f=l;continue}if(c>Q){o&&wA(0);break}}a&&g(u+131072);for(var eA=(1<<C)-1,q=(1<<B)-1,Z=c;;Z=c){var k=h[Ge(t,c)&eA],L=k>>4;if(c+=k&15,c>Q){o&&wA(0);break}if(k||wA(2),L<256)e[u++]=L;else if(L==256){Z=c,h=null;break}else{var j=L-254;if(L>264){var M=L-257,V=Ms[M];j=_A(t,c,(1<<V)-1)+Ns[M],c+=V}var W=E[Ge(t,c)&q],G=W>>4;W||wA(3),c+=W&15;var _=qo[G];if(G>3){var V=vs[G];_+=Ge(t,c)&(1<<V)-1,c+=V}if(c>Q){o&&wA(0);break}a&&g(u+131072);var dA=u+j;if(u<_){var lA=i-_,yA=Math.min(_,dA);for(lA+u<0&&wA(3);u<yA;++u)e[u]=s[lA+u]}for(;u<dA;++u)e[u]=e[u-_]}}A.l=h,A.p=Z,A.b=u,A.f=l,h&&(l=1,A.m=C,A.d=E,A.n=B)}while(!l);return u!=e.length&&r?vt(e,0,u):e.subarray(0,u)},Vo=new hA(0),KA=function(t,A){return t[A]|t[A+1]<<8},LA=function(t,A){return(t[A]|t[A+1]<<8|t[A+2]<<16|t[A+3]<<24)>>>0},Re=function(t,A){return LA(t,A)+LA(t,A+4)*4294967296},Oo=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&wA(6,"invalid gzip data");var A=t[3],e=10;A&4&&(e+=(t[10]|t[11]<<8)+2);for(var s=(A>>3&1)+(A>>4&1);s>0;s-=!t[e++]);return e+(A&2)},Ye=function(){function t(A,e){typeof A=="function"&&(e=A,A={}),this.ondata=e;var s=A&&A.dictionary&&A.dictionary.subarray(-32768);this.s={i:0,b:s?s.length:0},this.o=new hA(32768),this.p=new hA(0),s&&this.o.set(s)}return t.prototype.e=function(A){if(this.ondata||wA(5),this.d&&wA(4),!this.p.length)this.p=A;else if(A.length){var e=new hA(this.p.length+A.length);e.set(this.p),e.set(A,this.p.length),this.p=e}},t.prototype.c=function(A){this.s.i=+(this.d=A||!1);var e=this.s.b,s=Us(this.p,this.s,this.o);this.ondata(vt(s,e,this.s.b),this.d),this.o=vt(s,this.s.b-32768),this.s.b=this.o.length,this.p=vt(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(A,e){this.e(A),this.c(e)},t}();function Xo(t,A){return Us(t,{i:2},A&&A.out,A&&A.dictionary)}var Zo=function(){function t(A,e){this.v=1,this.r=0,Ye.call(this,A,e)}return t.prototype.push=function(A,e){if(Ye.prototype.e.call(this,A),this.r+=A.length,this.v){var s=this.p.subarray(this.v-1),n=s.length>3?Oo(s):4;if(n>s.length){if(!e)return}else this.v>1&&this.onmember&&this.onmember(this.r-s.length);this.p=s.subarray(n),this.v=0}Ye.prototype.c.call(this,e),this.s.f&&!this.s.l&&!e&&(this.v=ks(this.s.p)+9,this.s={i:0},this.o=new hA(0),this.push(new hA(0),e))},t}(),ze=typeof TextDecoder<"u"&&new TextDecoder,jo=0;try{ze.decode(Vo,{stream:!0}),jo=1}catch{}var Wo=function(t){for(var A="",e=0;;){var s=t[e++],n=(s>127)+(s>223)+(s>239);if(e+n>t.length)return{s:A,r:vt(t,e-1)};n?n==3?(s=((s&15)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,A+=String.fromCharCode(55296|s>>10,56320|s&1023)):n&1?A+=String.fromCharCode((s&31)<<6|t[e++]&63):A+=String.fromCharCode((s&15)<<12|(t[e++]&63)<<6|t[e++]&63):A+=String.fromCharCode(s)}};function Ac(t,A){if(A){for(var e="",s=0;s<t.length;s+=16384)e+=String.fromCharCode.apply(null,t.subarray(s,s+16384));return e}else{if(ze)return ze.decode(t);var n=Wo(t),i=n.s,e=n.r;return e.length&&wA(8),i}}var tc=function(t,A){return A+30+KA(t,A+26)+KA(t,A+28)},ec=function(t,A,e){var s=KA(t,A+28),n=Ac(t.subarray(A+46,A+46+s),!(KA(t,A+8)&2048)),i=A+46+s,r=LA(t,A+20),a=e&&r==4294967295?sc(t,i):[r,LA(t,A+24),LA(t,A+42)],o=a[0],g=a[1],l=a[2];return[KA(t,A+10),o,g,n,i+KA(t,A+30)+KA(t,A+32),l]},sc=function(t,A){for(;KA(t,A)!=1;A+=4+KA(t,A+2));return[Re(t,A+12),Re(t,A+4),Re(t,A+20)]};function nc(t,A){for(var e={},s=t.length-22;LA(t,s)!=101010256;--s)(!s||t.length-s>65558)&&wA(13);var n=KA(t,s+8);if(!n)return{};var i=LA(t,s+16),r=i==4294967295||n==65535;if(r){var a=LA(t,s-12);r=LA(t,a)==101075792,r&&(n=LA(t,a+32),i=LA(t,a+48))}for(var o=A&&A.filter,g=0;g<n;++g){var l=ec(t,i,r),c=l[0],u=l[1],h=l[2],E=l[3],C=l[4],B=l[5],Q=tc(t,B);i=C,(!o||o({name:E,size:u,originalSize:h,compression:c}))&&(c?c==8?e[E]=Xo(t.subarray(Q,Q+u),{out:new hA(h)}):wA(14,"unknown compression type "+c):e[E]=vt(t,Q,Q+u))}return e}let ZA;const Gs=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Gs.decode();let _t=null;function ic(){return(_t===null||_t.byteLength===0)&&(_t=new Uint8Array(ZA.memory.buffer)),_t}function rc(t,A){return t=t>>>0,Gs.decode(ic().subarray(t,t+A))}function ac(t,A,e,s,n,i,r,a,o,g,l,c,u){return ZA.raycast_splats(t,A,e,s,n,i,r,a,o,g,l,c,u)}async function oc(t,A){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,A)}catch(s){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",s);else throw s}const e=await t.arrayBuffer();return await WebAssembly.instantiate(e,A)}else{const e=await WebAssembly.instantiate(t,A);return e instanceof WebAssembly.Instance?{instance:e,module:t}:e}}function cc(){const t={};return t.wbg={},t.wbg.__wbg_buffer_609cc3eee51ed158=function(A){return A.buffer},t.wbg.__wbg_length_3b4f022188ae8db6=function(A){return A.length},t.wbg.__wbg_length_6ca527665d89694d=function(A){return A.length},t.wbg.__wbg_length_8cfd2c6409af88ad=function(A){return A.length},t.wbg.__wbg_new_9fee97a409b32b68=function(A){return new Uint16Array(A)},t.wbg.__wbg_new_e3b321dcfef89fc7=function(A){return new Uint32Array(A)},t.wbg.__wbg_newwithbyteoffsetandlength_e6b7e69acd4c7354=function(A,e,s){return new Float32Array(A,e>>>0,s>>>0)},t.wbg.__wbg_newwithbyteoffsetandlength_f1dead44d1fc7212=function(A,e,s){return new Uint32Array(A,e>>>0,s>>>0)},t.wbg.__wbg_newwithlength_5a5efe313cfd59f1=function(A){return new Float32Array(A>>>0)},t.wbg.__wbg_set_10bad9bee0e9c58b=function(A,e,s){A.set(e,s>>>0)},t.wbg.__wbg_set_d23661d19148b229=function(A,e,s){A.set(e,s>>>0)},t.wbg.__wbg_set_f4f1f0daa30696fc=function(A,e,s){A.set(e,s>>>0)},t.wbg.__wbg_subarray_3aaeec89bb2544f0=function(A,e,s){return A.subarray(e>>>0,s>>>0)},t.wbg.__wbg_subarray_769e1e0f81bb259b=function(A,e,s){return A.subarray(e>>>0,s>>>0)},t.wbg.__wbindgen_init_externref_table=function(){const A=ZA.__wbindgen_export_0,e=A.grow(4);A.set(0,void 0),A.set(e+0,void 0),A.set(e+1,null),A.set(e+2,!0),A.set(e+3,!1)},t.wbg.__wbindgen_memory=function(){return ZA.memory},t.wbg.__wbindgen_throw=function(A,e){throw new Error(rc(A,e))},t}function gc(t,A){return ZA=t.exports,Rs.__wbindgen_wasm_module=A,_t=null,ZA.__wbindgen_start(),ZA}async function Rs(t){if(ZA!==void 0)return ZA;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("data:application/wasm;base64,AGFzbQEAAAABzAEeYAJ/fwF/YAJ/fwBgA39/fwF/YAN/f38AYAF/AX9gAX8AYANvf38Bb2AFf39/f38Bf2AFf39/f38AYAFvAW9gA29vfwBgAW8Bf2AAAGAAAX9gBH9/f38AYAR/f39/AX9gA39vbwF/YAF/AW9gAAFvYAF9AX1gBn9/f39/fwBgDX19fX19fX19f29/fX0Bb2AGf39/f39/AX9gBX9/fX9/AGAEf31/fwBgBX9/fH9/AGAEf3x/fwBgBX9/fn9/AGAEf35/fwBgAn19AX0C8gQRA3diZx1fX3diZ19idWZmZXJfNjA5Y2MzZWVlNTFlZDE1OAAJA3diZxpfX3diZ19uZXdfOWZlZTk3YTQwOWIzMmI2OAAJA3diZxpfX3diZ19zZXRfZjRmMWYwZGFhMzA2OTZmYwAKA3diZx1fX3diZ19sZW5ndGhfOGNmZDJjNjQwOWFmODhhZAALA3diZzFfX3diZ19uZXd3aXRoYnl0ZW9mZnNldGFuZGxlbmd0aF9mMWRlYWQ0NGQxZmM3MjEyAAYDd2JnGl9fd2JnX25ld19lM2IzMjFkY2ZlZjg5ZmM3AAkDd2JnGl9fd2JnX3NldF9kMjM2NjFkMTkxNDhiMjI5AAoDd2JnHV9fd2JnX2xlbmd0aF82Y2E1Mjc2NjVkODk2OTRkAAsDd2JnMV9fd2JnX25ld3dpdGhieXRlb2Zmc2V0YW5kbGVuZ3RoX2U2YjdlNjlhY2Q0YzczNTQABgN3YmcaX193Ymdfc2V0XzEwYmFkOWJlZTBlOWM1OGIACgN3YmcdX193YmdfbGVuZ3RoXzNiNGYwMjIxODhhZThkYjYACwN3YmcfX193Ymdfc3ViYXJyYXlfNzY5ZTFlMGY4MWJiMjU5YgAGA3diZx9fX3diZ19zdWJhcnJheV8zYWFlZWM4OWJiMjU0NGYwAAYDd2JnJF9fd2JnX25ld3dpdGhsZW5ndGhfNWE1ZWZlMzEzY2ZkNTlmMQARA3diZxBfX3diaW5kZ2VuX3Rocm93AAEDd2JnEV9fd2JpbmRnZW5fbWVtb3J5ABIDd2JnH19fd2JpbmRnZW5faW5pdF9leHRlcm5yZWZfdGFibGUADANeXQQAAQcFAgMCEwEBAAABAQAADQABAwgIAwEBBQ0BFA4DAAMBAwIMDAIBAQcDABUBFggXBxkb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wAA2AgBBsJnAAEGomcAANgIAQbyZwABBsJnAADYCAEG4mcAAQbCZwAA2AgBBxJnAAEG4mcAANgIAQcCZwABBuJnAADYCAEHMmcAAQcCZwAA2AgBByJnAAEHAmcAANgIAQdSZwABByJnAADYCAEHcmcAAQdCZwAA2AgBB0JnAAEHImcAANgIAQeSZwABB2JnAADYCAEHYmcAAQdCZwAA2AgBB7JnAAEHgmcAANgIAQeCZwABB2JnAADYCAEH0mcAAQeiZwAA2AgBB6JnAAEHgmcAANgIAQfyZwABB8JnAADYCAEHwmcAAQeiZwAA2AgBBhJrAAEH4mcAANgIAQfiZwABB8JnAADYCAEGMmsAAQYCawAA2AgBBgJrAAEH4mcAANgIAQZSawABBiJrAADYCAEGImsAAQYCawAA2AgBBnJrAAEGQmsAANgIAQZCawABBiJrAADYCAEGkmsAAQZiawAA2AgBBmJrAAEGQmsAANgIAQayawABBoJrAADYCAEGgmsAAQZiawAA2AgBBtJrAAEGomsAANgIAQaiawABBoJrAADYCAEG8msAAQbCawAA2AgBBsJrAAEGomsAANgIAQcSawABBuJrAADYCAEG4msAAQbCawAA2AgBBzJrAAEHAmsAANgIAQcCawABBuJrAADYCAEHkmsAAIAFBD2pBeHEiAEEIayICNgIAQciawABBwJrAADYCAEHcmsAAIARBKGsiAyABIABrakEIaiIANgIAIAIgAEEBcjYCBCABIANqQSg2AgRB8JrAAEGAgIABNgIADAgLIAIgA0kgASACTXINACAAKAIMIgNBAXENACADQQF2IAZGDQMLQfSawABB9JrAACgCACIAIAEgACABSRs2AgAgASAEaiEDQbiYwAAhAAJAAkADQCADIAAoAgAiB0cEQCAAKAIIIgANAQwCCwsgACgCDCIDQQFxDQAgA0EBdiAGRg0BC0G4mMAAIQADQAJAIAIgACgCACIDTwRAIAIgAyAAKAIEaiIHSQ0BCyAAKAIIIQAMAQsLQeSawAAgAUEPakF4cSIAQQhrIgM2AgBB3JrAACAEQShrIgkgASAAa2pBCGoiADYCACADIABBAXI2AgQgASAJakEoNgIEQfCawABBgICAATYCACACIAdBIGtBeHFBCGsiACAAIAJBEGpJGyIDQRs2AgRBuJjAACkCACEK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NgIYIABCBDcCICAAQRhqQZiKwAAQPwALIABBKGogAikDADcCACAAIAApAwg3AiAgACABNgIcIABBATYCGAJAIABBGGoiASgCAEUNACABKAIEIgJFDQAgASgCCCACQQJ0EGELIABBADYCKCAAQQE2AhwgAEG4isAANgIYIABCBDcCICABQcCKwAAQPwALhgIBA38jAEGAAWsiBCQAIAAoAgAhAAJ/AkAgASgCCCICQYCAgBBxRQRAIAJBgICAIHENASAAKAIAIAEQHQwCCyAAKAIAIQBBACECA0AgAiAEakH/AGogAEEPcSIDQTByIANB1wBqIANBCkkbOgAAIAJBAWshAiAAQQ9LIABBBHYhAA0ACyABQcuTwABBAiACIARqQYABakEAIAJrEBQMAQsgACgCACEAQQAhAgNAIAIgBGpB/wBqIABBD3EiA0EwciADQTdqIANBCkkbOgAAIAJBAWshAiAAQQ9LIABBBHYhAA0ACyABQcuTwABBAiACIARqQYABakEAIAJrEBQLIARBgAFqJAALqAICA38BfiMAQUBqIgIkACABKAIAQYCAgIB4RgRAIAEoAgwhAyACQSRqIgRBADYCACACQoCAgIAQNwIcIAJBMGogAygCACIDQQhqKQIANwMAIAJBOGogA0EQaikCADcDACACIAMpAgA3AyggAkEcakGwi8AAIAJBKGoQGBogAkEYaiAEKAIAIgM2AgAgAiACKQIcIgU3AxAgAUEIaiADNgIAIAEgBTcCAAsgASkCACEFIAFCgICAgBA3AgAgAkEIaiIDIAFBCGoiASgCADYCACABQQA2AgBBmZfAAC0AABogAiAFNwMAQQxBBBBZIgFFBEBBBEEMEGoACyABIAIpAwA3AgAgAUEIaiADKAIANgIAIABBqI7AADYCBCAAIAE2AgAgAkFAayQAC9QBAgR/AX4jAEEgayIDJAACQAJAIAEgASACaiICSwRAQQAhAQwBC0EAIQFBCCACIAAoAgAiBUEBdCIEIAIgBEsbIgIgAkEITRsiBK0iB0IgiFBFDQAgB6ciBkH/////B0sNACADIAUEfyADIAU2AhwgAyAAKAIENgIUQQEFQQALNgIYIANBCGpBASAGIANBFGoQLyADKAIIQQFHDQEgAygCECECIAMoAgwhAQsgASACQaCLwAAQTAALIAMoAgwhASAAIAQ2AgAgACABNgIEIANBIGokAAvuAQIEfwF+IwBBIGsiBSQAAkACQCABIAEgAmoiAksEQEEAIQEMAQtBACEBIAMgBGpBAWtBACADa3GtQQQgAiAAKAIAIgdBAXQiBiACIAZLGyICIAJBBE0bIgatfiIJQiCIUEUNACAJpyIIQYCAgIB4IANrSw0AQQAhAiAFIAcEfyAFIAQgB2w2AhwgBSAAKAIENgIUIAMFIAILNgIYIAVBCGogAyAIIAVBFGoQLyAFKAIIQQFHDQEgBSgCECECIAUoAgwhAQsgASACQdCAwAAQTAALIAUoAgwhASAAIAY2AgAgACABNgIEIAVBIGokAAuVAgECfyMAQSBrIgUkAEG0l8AAQbSXwAAoAgAiBkEBajYCAAJ/QQAgBkEASA0AGkEBQYCbwAAtAAANABpBgJvAAEEBOgAAQfyawABB/JrAACgCAEEBajYCAEECC0H/AXEiBkECRwRAIAZBAXEEQCAFQQhqIAAgASgCGBEBAAsACwJAQaiXwAAoAgAiBkEATgRAQaiXwAAgBkEBajYCAEGsl8AAKAIABEAgBSAAIAEoAhQRAQAgBSAEOgAdIAUgAzoAHCAFIAI2AhggBSAFKQMANwIQQayXwAAoAgAgBUEQakGwl8AAKAIAKAIUEQEAC0Gol8AAQaiXwAAoAgBBAWs2AgBBgJvAAEEAOgAAIANFDQEACwALAAu6AQECfyMAQSBrIgMkAAJAAn9BACABIAEgAmoiAksNABpBAEEIIAIgACgCACIBQQF0IgQgAiAESxsiAiACQQhNGyIEQQBIDQAaQQAhAiADIAEEfyADIAE2AhwgAyAAKAIENgIUQQEFIAILNgIYIANBCGpBASAEIANBFGoQLyADKAIIQQFHDQEgAygCECEAIAMoAgwLIABB3I/AABBMAAsgAygCDCEBIAAgBDYCACAAIAE2AgQgA0EgaiQAC7kBAQV/IwBBIGsiAiQAIAAoAgAiBEH/////AUsEQEEAQQAgARBMAAsCQEEEIARBAXQiBSAFQQRNGyIFQQJ0IgZB/P///wdNBH8gAiAEBH8gAiAEQQJ0NgIcIAIgACgCBDYCFEEEBSADCzYCGCACQQhqQQQgBiACQRRqEC8gAigCCEEBRw0BIAIoAhAhAyACKAIMBSADCyADIAEQTAALIAIoAgwhASAAIAU2AgAgACABNgIEIAJBIGokAAvBAQIDfwF+IwBBMGsiAiQAIAEoAgBBgICAgHhGBEAgASgCDCEDIAJBFGoiBEEANgIAIAJCgICAgBA3AgwgAkEgaiADKAIAIgNBCGopAgA3AwAgAkEoaiADQRBqKQIANwMAIAIgAykCADcDGCACQQxqQbCLwAAgAkEYahAYGiACQQhqIAQoAgAiAzYCACACIAIpAgwiBTcDACABQQhqIAM2AgAgASAFNwIACyAAQaiOwAA2AgQgACABNgIAIAJBMGokAAuvAQEGfwJAAkAgAEGEAUkNACAA0G8mARAiIgEoAgwhBSABKAIQIQIgAUIANwIMIAEoAgghAyABKAIEIQQgAUIENwIEIAEoAgAhBiABQQA2AgAgACACSQ0BIAAgAmsiACADTw0BIAQgAEECdGogBTYCACABIAI2AhAgASAANgIMIAEgAzYCCCABKAIEIAEgBDYCBCABKAIAIQAgASAGNgIAIABFDQAgAEECdBBhCw8LAAvOAwIMfwF+IwBBIGsiBCQAIARBGGoiCRAiIgVBEGoiBygCADYCACAEQRBqIgogBUEIaiIIKQIANwMAIAdBADYCACAIQgA3AgAgBSkCACEMIAVCgICAgMAANwIAIAQgDDcDCAJ/IwBBIGsiAyQAAkACQCAEQQhqIgAoAgwiASAAKAIIIgJGBEACQCAAKAIAIgIgAUYEQNBvQYABIAEgAUGAAU0bIgb8DwEiAkF/Rg0EAkAgACgCECILRQRAIAAgAjYCEAwBCyABIAtqIAJHDQULIAEgBmoiAkH/////AUsNBCADIAEEfyADIAFBAnQ2AhwgAyAAKAIENgIUQQQFQQALNgIYIANBCGpBBCACQQJ0IANBFGoQLyADKAIIQQFGDQQgAygCDCEGIAAgAjYCACAAIAY2AgQMAQsgASACTw0DCyAAIAFBAWoiAjYCCCAAKAIEIAFBAnRqIAI2AgAMAQsgASACTw0BCyAAIAAoAgQgAUECdGooAgA2AgwgACgCECADQSBqJAAgAWoMAQsACyAIIAopAwA3AgAgByAJKAIANgIAIAUoAgQhAyAFKAIAIQEgBSAEKQMINwIAIAEEQCADIAFBAnQQYQsgBEEgaiQAC7YBAQN/IAEoAgwhAgJAAkACQAJAAkACQCABKAIEDgIAAQILIAINAUEBIQNBACEBQQEhAgwDCyACRQ0BCyAAIAEQGw8LIAEoAgAiAigCBCIBQQBIDQEgAigCACEDIAFFBEBBASECQQAhAQwBC0GZl8AALQAAGkEBIQQgAUEBEFkiAkUNAQsgAQRAIAIgAyAB/AoAAAsgACABNgIIIAAgAjYCBCAAIAE2AgAPCyAEIAFB1ILAABBMAAuoAQEBfyMAQRBrIgYkAAJAIAEEQCAGQQRqIAEgAyAEIAUgAigCEBEIAAJAIAYoAgQiAiAGKAIMIgFNBEAgBigCCCEFDAELIAJBAnQhAiAGKAIIIQMgAUUEQEEEIQUgAyACEGEMAQsgAyACQQQgAUECdCICEFAiBUUNAgsgACABNgIEIAAgBTYCACAGQRBqJAAPC0HUiMAAQTIQZQALQQQgAkHEiMAAEEwAC40BAQF/IAJBAE4EQAJ/IAMoAgQEQAJAIAMoAggiBEUEQAwBCyADKAIAIAQgASACEFAMAgsLIAEgAkUNABpBmZfAAC0AABogAiABEFkLIgNFBEAgACACNgIIIAAgATYCBCAAQQE2AgAPCyAAIAI2AgggACADNgIEIABBADYCAA8LIABBADYCBCAAQQE2AgALlwECBH8BbyMAQSBrIgMkACAAKAIAIgYQbSEAIAMgAjYCBCADIAA2AgAgACACRgRAEFciBBBPIgUlASABIAIQBCEHECwiACAHJgEgBEGEAU8EQCAEECsLIAVBhAFPBEAgBRArCyAGIABBABBgIABBhAFPBEAgABArCyADQSBqJAAPCyADQQA2AgggAyADQQRqIANBCGoQPAALeQEBfyMAQSBrIgIkAAJ/IAAoAgBBgICAgHhHBEAgASAAKAIEIAAoAggQUgwBCyACQRBqIAAoAgwoAgAiAEEIaikCADcDACACQRhqIABBEGopAgA3AwAgAiAAKQIANwMIIAEoAgAgASgCBCACQQhqEBgLIAJBIGokAAtpAgF/AX4jAEEwayIDJAAgAyABNgIEIAMgADYCACADQQI2AgwgA0GEksAANgIIIANCAjcCFCADQoCAgIDQACIEIAOthDcDKCADIAQgA0EEaq2ENwMgIAMgA0EgajYCECADQQhqIAIQPwALaAAjAEEwayIAJABBmJfAAC0AAEUEQCAAQTBqJAAPCyAAQQI2AgwgAEHwjcAANgIIIABCATcCFCAAIAE2AiwgACAAQSxqrUKAgICA0ACENwMgIAAgAEEgajYCECAAQQhqQZiOwAAQPwALlAECA38BbyMAQSBrIgMkACADIAAoAgAQbSIENgIAIAMgAjYCBCACIARHBEAgA0EANgIIIAMgA0EEaiADQQhqEDwACxBXIgQQTyIFJQEQBSEGECwiAiAGJgEgBUGEAU8EQCAFECsLIAIgACgCACABQQJ2EGAgAkGEAU8EQCACECsLIARBhAFPBEAgBBArCyADQSBqJAALRwEBfyAAKAIAIAAoAggiA2sgAkkEQCAAIAMgAhAlIAAoAgghAwsgAgRAIAAoAgQgA2ogASAC/AoAAAsgACACIANqNgIIQQALTwEBfyMAQTBrIgAkACAAQQE2AgwgAEHEjcAANgIIIABCATcCFCAAIABBL2qtQoCAgICwAoQ3AyAgACAAQSBqNgIQIABBCGpB6IHAABA/AAtPAQF/IwBBMGsiACQAIABBATYCDCAAQciRwAA2AgggAEIBNwIUIAAgAEEvaq1CgICAgJAFhDcDICAAIABBIGo2AhAgAEEIakH4gcAAED8AC0cBAX8gACgCACAAKAIIIgNrIAJJBEAgACADIAIQKCAAKAIIIQMLIAIEQCAAKAIEIANqIAEgAvwKAAALIAAgAiADajYCCEEAC00BAn9BmZfAAC0AABogASgCBCECIAEoAgAhA0EIQQQQWSIBRQRAQQRBCBBqAAsgASACNgIEIAEgAzYCACAAQbiOwAA2AgQgACABNgIAC0EBAX8jAEEgayICJAAgAkEANgIQIAJBATYCBCACQgQ3AgggAkEuNgIcIAIgADYCGCACIAJBGGo2AgAgAiABED8ACzgAAkAgAkGAgMQARg0AIAAgAiABKAIQEQAARQ0AQQEPCyADRQRAQQAPCyAAIAMgBCABKAIMEQIAC9gCAQF/IwBBEGsiAyQAIAMgATYCDCADIAA2AggjAEHwAGsiACQAIABBlJLAADYCDCAAIANBCGo2AgggAEGUksAANgIUIAAgA0EMajYCECAAQeSVwAAoAgA2AhwgAEHYlcAAKAIANgIYAkAgAigCAARAIABBMGogAkEQaikCADcDACAAQShqIAJBCGopAgA3AwAgACACKQIANwMgIABBBDYCXCAAQZSTwAA2AlggAEIENwJkIAAgAEEQaq1CgICAgKAFhDcDUCAAIABBCGqtQoCAgICgBYQ3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ACAIJQEgCBArC/oBAgJ/AX4jAEEQayICJAAgAkEBOwEMIAIgATYCCCACIAA2AgQjAEEQayIBJAAgAkEEaiIAKQIAIQQgASAANgIMIAEgBDcCBCMAQRBrIgAkACABQQRqIgEoAgAiAigCDCEDAkACQAJAAkAgAigCBA4CAAECCyADDQFBASECQQAhAwwCCyADDQAgAigCACICKAIEIQMgAigCACECDAELIABBgICAgHg2AgAgACABNgIMIABB5I7AACABKAIEIAEoAggiAC0ACCAALQAJECcACyAAIAM2AgQgACACNgIAIABByI7AACABKAIEIAEoAggiAC0ACCAALQAJECcACyQAIABFBEBB1IjAAEEyEGUACyAAIAIgAyAEIAUgASgCEBEHAAsiACAARQRAQdSIwABBMhBlAAsgACACIAMgBCABKAIQEQ4ACyIAIABFBEBB1IjAAEEyEGUACyAAIAIgAyAEIAEoAhARGAALIgAgAEUEQEHUiMAAQTIQZQALIAAgAiADIAQgASgCEBEPAAsiACAARQRAQdSIwABBMhBlAAsgACACIAMgBCABKAIQERoACyIAIABFBEBB1IjAAEEyEGUACyAAIAIgAyAEIAEoAhARHAALJQEBfyAAKAIAIgFBgICAgHhyQYCAgIB4RwRAIAAoAgQgARBhCwsgACAARQRAQdSIwABBMhBlAAsgACACIAMgASgCEBEDAAseACAARQRAQdSIwABBMhBlAAsgACACIAEoAhARAAALrw8BEX8QLCIDIAEmARAsIgQgAiYBIwBBIGsiCyQAIAsgBDYCCCALIAM2AgQgCyAANgIAIAsgC0EEaiIAKAIAEGw2AgwgCyALQQhqNgIcIAsgCzYCGCALIAA2AhQgCyALQQxqNgIQIAtBEGohACMAQdAAayIGJAACQAJAAkACQAJAQQBBjIHAACgCABEEACIPBEAgDygCAA0BIAAoAgwhESAAKAIIIQggD0F/NgIAIAAoAgQgACgCACgCACIFIA9BBGoiDiIEKAIIIgNLBEAgBSADIgBrIgkgBCgCACAAa0sEQCAEIAAgCUECQQIQJiAEKAIIIQALIAQoAgQiByAAQQF0aiEKIAlBAk8EQCAFIANBf3NqQQF0IgwEQCAKQQAgDPwLAAsgACAFakEBdCADQQF0ayAHakECayEKIAAgCWpBAWsh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EAAcAAAARQAAAC0AAADUARAAHAAAAF4AAAAoAAAAc3BhcmstaW50ZXJuYWwtcnNcc3JjXHNvcnQucnMAAABIAhAAHQAAABsAAAAdAAAARXhwZWN0ZWQgIGFjdGl2ZSBzcGxhdHMgYnV0IGdvdCB4AhAACQAAAIECEAAXAAAASAIQAB0AAAAzAAAAHQAAAEgCEAAdAAAAMwAAABUAAABIAhAAHQAAACQAAAAUAAAASAIQAB0AAAB0AAAAGQAAAEgCEAAdAAAApwAAABMAAABIAhAAHQAAAJ8AAAATAAAASAIQAB0AAACiAAAAHQAAAEgCEAAdAAAAogAAABEAAABIAhAAHQAAAJAAAAAgAAAASAIQAB0AAACQAAAAFAAAAEgCEAAdAAAAfAAAABgAAABIAhAAHQAAAH0AAAAYAAAAQzpcVXNlcnNcS2FsaVwuY2FyZ29ccmVnaXN0cnlcc3JjXGluZGV4LmNyYXRlcy5pby0xOTQ5Y2Y4YzZiNWI1NTdmXGpzLXN5cy0wLjMuNzdcc3JjXGxpYi5ycwBoAxAAWwAAAPsYAAABAAAAQzpcVXNlcnNcS2FsaVwuY2FyZ29ccmVnaXN0cnlcc3JjXGluZGV4LmNyYXRlcy5pby0xOTQ5Y2Y4YzZiNWI1NTdmXHdhc20tYmluZGdlbi0wLjIuMTAwXHNyY1xjb252ZXJ0XHNsaWNlcy5ycwAAANQDEABtAAAAJAEAAA4AAABjbG9zdXJlIGludm9rZWQgcmVjdXJzaXZlbHkgb3IgYWZ0ZXIgYmVpbmcgZHJvcHBlZExhenkgaW5zdGFuY2UgaGFzIHByZXZpb3VzbHkgYmVlbiBwb2lzb25lZIYEEAAqAAAAQzpcVXNlcnNcS2FsaVwuY2FyZ29ccmVnaXN0cnlcc3JjXGluZGV4LmNyYXRlcy5pby0xOTQ5Y2Y4YzZiNWI1NTdmXG9uY2VfY2VsbC0xLjIxLjNcc3JjXGxpYi5ycwAAuAQQAF4AAAAIAwAAGQAAAHJlZW50cmFudCBpbml0AAAoBRAADgAAALgEEABeAAAAegIAAA0AAAAvcnVzdGMvNmIwMGJjMzg4MDE5ODYwMDEzMGUxY2Y2MmI4ZjhhOTM0OTQ0ODhjYy9saWJyYXJ5L2FsbG9jL3NyYy9yYXdfdmVjL21vZC5yc1AFEABQAAAALgIAABEAAAAVAAAADAAAAAQAAAAWAAAAFwAAABgAAAAvcnVzdC9kZXBzL2RsbWFsbG9jLTAuMi44L3NyYy9kbG1hbGxvYy5yc2Fzc2VydGlvbiBmYWlsZWQ6IHBzaXplID49IHNpemUgKyBtaW5fb3ZlcmhlYWQAyAUQACkAAACsBAAACQAAAGFzc2VydGlvbiBmYWlsZWQ6IHBzaXplIDw9IHNpemUgKyBtYXhfb3ZlcmhlYWQAAMgFEAApAAAAsgQAAA0AAABBY2Nlc3NFcnJvcmNhbm5vdCBhY2Nlc3MgYSBUaHJlYWQgTG9jYWwgU3RvcmFnZSB2YWx1ZSBkdXJpbmcgb3IgYWZ0ZXIgZGVzdHJ1Y3Rpb246IAB7BhAASAAAAG1lbW9yeSBhbGxvY2F0aW9uIG9mICBieXRlcyBmYWlsZWQAAMwGEAAVAAAA4QYQAA0AAABsaWJyYXJ5L3N0ZC9zcmMvYWxsb2MucnMABxAAGAAAAGQBAAAJAAAAFQAAAAwAAAAEAAAAGQAAAAAAAAAIAAAABAAAABoAAAAAAAAACAAAAAQAAAAbAAAAHAAAAB0AAAAeAAAAHwAAABAAAAAEAAAAIAAAACEAAAAiAAAAIwAAAEVycm9yAAAAJAAAAAwAAAAEAAAAJQAAACYAAAAnAAAAY2FwYWNpdHkgb3ZlcmZsb3cAAACgBxAAEQAAAGxpYnJhcnkvYWxsb2Mvc3JjL3Jhd192ZWMvbW9kLnJzvAcQACAAAAAuAgAAEQAAAGxpYnJhcnkvYWxsb2Mvc3JjL3N0cmluZy5ycwDsBxAAGwAAAOgBAAAXAEGgkMAAC9gFAQAAACgAAABhIGZvcm1hdHRpbmcgdHJhaXQgaW1wbGVtZW50YXRpb24gcmV0dXJuZWQgYW4gZXJyb3Igd2hlbiB0aGUgdW5kZXJseWluZyBzdHJlYW0gZGlkIG5vdGxpYnJhcnkvYWxsb2Mvc3JjL2ZtdC5ycwAAfggQABgAAACKAgAADgAAAEJvcnJvd011dEVycm9yYWxyZWFkeSBib3Jyb3dlZDogtggQABIAAABpbmRleCBvdXQgb2YgYm91bmRzOiB0aGUgbGVuIGlzICBidXQgdGhlIGluZGV4IGlzIAAA0AgQACAAAADwCBAAEgAAAAAAAAAEAAAABAAAAC0AAAA9PSE9bWF0Y2hlc2Fzc2VydGlvbiBgbGVmdCAgcmlnaHRgIGZhaWxlZAogIGxlZnQ6IAogcmlnaHQ6IAAvCRAAEAAAAD8JEAAXAAAAVgkQAAkAAAAgcmlnaHRgIGZhaWxlZDogCiAgbGVmdDogAAAALwkQABAAAAB4CRAAEAAAAIgJEAAJAAAAVgkQAAkAAAA6IAAAAQAAAAAAAAC0CRAAAgAAAH0gfTB4MDAwMTAyMDMwNDA1MDYwNzA4MDkxMDExMTIxMzE0MTUxNjE3MTgxOTIwMjEyMjIzMjQyNTI2MjcyODI5MzAzMTMyMzMzNDM1MzYzNzM4Mzk0MDQxNDI0MzQ0NDU0NjQ3NDg0OTUwNTE1MjUzNTQ1NTU2NTc1ODU5NjA2MTYyNjM2NDY1NjY2NzY4Njk3MDcxNzI3Mzc0NzU3Njc3Nzg3OTgwODE4MjgzODQ4NTg2ODc4ODg5OTA5MTkyOTM5NDk1OTY5Nzk4OTkgb3V0IG9mIHJhbmdlIGZvciBzbGljZSBvZiBsZW5ndGggcmFuZ2UgZW5kIGluZGV4IAC3ChAAEAAAAJUKEAAiAAAAJAkQACYJEAAoCRAAAgAAAAIAAAAHAAAAAAAAPwAAAL8AQZCWwAALARIAfAlwcm9kdWNlcnMCCGxhbmd1YWdlAQRSdXN0AAxwcm9jZXNzZWQtYnkDBXJ1c3RjHTEuODguMCAoNmIwMGJjMzg4IDIwMjUtMDYtMjMpBndhbHJ1cwYwLjIzLjMMd2FzbS1iaW5kZ2VuEzAuMi4xMDAgKDI0MDVlYzJiNCkAaw90YXJnZXRfZmVhdHVyZXMGKw9tdXRhYmxlLWdsb2JhbHMrE25vbnRyYXBwaW5nLWZwdG9pbnQrC2J1bGstbWVtb3J5KwhzaWduLWV4dCsPcmVmZXJlbmNlLXR5cGVzKwptdWx0aXZhbHVl",typeof document>"u"?require("url").pathToFileURL(__filename).href:ke&&ke.tagName.toUpperCase()==="SCRIPT"&&ke.src||new URL("spark.cjs.min.js",document.baseURI).href));const A=cc();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:e,module:s}=await oc(await t,A);return gc(e,s)}const TA=-12,kA=9,lc=Math.exp(TA),uc=Math.exp(kA),Ys=-30,Ct=Math.exp(Ys),Ze=11,je=11,Js=11,Ic=Ze+je,O=1<<Ze,$A=1<<je,_s=1<<Js,We=1,hc=O-1,Cc=$A-1,Bc=_s-1,Ec=!0,Qc=!0,pc=Object.freeze(Object.defineProperty({__proto__:null,LN_SCALE_MAX:kA,LN_SCALE_MIN:TA,LN_SCALE_ZERO:Ys,SCALE_MAX:uc,SCALE_MIN:lc,SCALE_ZERO:Ct,SPLAT_TEX_DEPTH:_s,SPLAT_TEX_DEPTH_BITS:Js,SPLAT_TEX_DEPTH_MASK:Bc,SPLAT_TEX_HEIGHT:$A,SPLAT_TEX_HEIGHT_BITS:je,SPLAT_TEX_HEIGHT_MASK:Cc,SPLAT_TEX_LAYER_BITS:Ic,SPLAT_TEX_MIN_HEIGHT:We,SPLAT_TEX_WIDTH:O,SPLAT_TEX_WIDTH_BITS:Ze,SPLAT_TEX_WIDTH_MASK:hc,USE_COMPILED_PARSER_FUNCTION:Qc,WASM_SPLAT_SORT:Ec},Symbol.toStringTag,{value:"Module"}));function dt(t){return t==="bool"||t==="bvec2"||t==="bvec3"||t==="bvec4"}function yt(t){return t==="int"||t==="uint"||t==="float"}function QA(t){return t==="int"||t==="ivec2"||t==="ivec3"||t==="ivec4"}function pA(t){return t==="uint"||t==="uvec2"||t==="uvec3"||t==="uvec4"}function ee(t){return t==="float"||t==="vec2"||t==="vec3"||t==="vec4"}function Ls(t){return t==="mat2"||t==="mat2x2"||t==="mat2x3"||t==="mat2x4"||t==="mat3"||t==="mat3x2"||t==="mat3x3"||t==="mat3x4"||t==="mat4"||t==="mat4x2"||t==="mat4x3"||t==="mat4x4"}function ot(t){return ee(t)||Ls(t)}function kt(t){return t==="vec2"||t==="ivec2"||t==="uvec2"}function Ut(t){return t==="vec3"||t==="ivec3"||t==="uvec3"}function se(t){return t==="vec4"||t==="ivec4"||t==="uvec4"}function fc(t){return kt(t)||Ut(t)||se(t)}function gt(t){return t==="mat2"||t==="mat2x2"}function lt(t){return t==="mat3"||t==="mat3x3"}function ut(t){return t==="mat4"||t==="mat4x4"}function zs(t){switch(t){case"vec2":return"float";case"vec3":return"float";case"vec4":return"float";case"ivec2":return"int";case"ivec3":return"int";case"ivec4":return"int";case"uvec2":return"uint";case"uvec3":return"uint";case"uvec4":return"uint";default:throw new Error(`Invalid vector type: ${t}`)}}function Hs(t){switch(t){case"vec2":case"ivec2":case"uvec2":return 2;case"vec3":case"ivec3":case"uvec3":return 3;case"vec4":case"ivec4":case"uvec4":return 4;default:throw new Error(`Invalid vector type: ${t}`)}}function dc(t){if(yt(t))return"float";if(kt(t))return"vec2";if(Ut(t))return"vec3";if(se(t))return"vec4";throw new Error(`Invalid vector type: ${t}`)}function qs(t){if(yt(t))return"uint";if(kt(t))return"uvec2";if(Ut(t))return"uvec3";if(se(t))return"uvec4";throw new Error(`Invalid vector type: ${t}`)}function yc(t){if(yt(t))return"int";if(kt(t))return"ivec2";if(Ut(t))return"ivec3";if(se(t))return"ivec4";throw new Error(`Invalid vector type: ${t}`)}function Ks(t){if(typeof t=="string")return t;if(typeof t=="object"&&t.type)return t.type;throw new Error(`Invalid DynoType: ${String(t)}`)}function aA(t){return Math.trunc(t).toString()}function oA(t){return`${Math.max(0,Math.trunc(t)).toString()}u`}function H(t){return t===Number.POSITIVE_INFINITY?"INFINITY":t===Number.NEGATIVE_INFINITY?"-INFINITY":Number.isInteger(t)?t.toFixed(1):t.toString()}function $(t){return t instanceof it?t.type:t.dynoOut().type}class it{constructor(A){this.__isDynoValue=!0,this.type=A}}class K extends it{constructor(A,e){super(A.outTypes[e]),this.dyno=A,this.key=e}}class bt extends it{constructor(A,e){super(A),this.literal=e}getLiteral(){return this.literal}}function he(t,A){return new bt(t,A)}class $s extends bt{constructor(A,e){super(A,""),this.value=e}getLiteral(){const{type:A,value:e}=this;switch(A){case"bool":return e?"true":"false";case"uint":return oA(e);case"int":return aA(e);case"float":return H(e);case"bvec2":{const s=e;return`bvec2(${s[0]}, ${s[1]})`}case"uvec2":{if(e instanceof I.Vector2)return`uvec2(${oA(e.x)}, ${oA(e.y)})`;const s=e;return`uvec2(${oA(s[0])}, ${oA(s[1])})`}case"ivec2":{if(e instanceof I.Vector2)return`ivec2(${aA(e.x)}, ${aA(e.y)})`;const s=e;return`ivec2(${aA(s[0])}, ${aA(s[1])})`}case"vec2":{if(e instanceof I.Vector2)return`vec2(${H(e.x)}, ${H(e.y)})`;const s=e;return`vec2(${H(s[0])}, ${H(s[1])})`}case"bvec3":{const s=e;return`bvec3(${s[0]}, ${s[1]}, ${s[2]})`}case"uvec3":{if(e instanceof I.Vector3)return`uvec3(${oA(e.x)}, ${oA(e.y)}, ${oA(e.z)})`;const s=e;return`uvec3(${oA(s[0])}, ${oA(s[1])}, ${oA(s[2])})`}case"ivec3":{if(e instanceof I.Vector3)return`ivec3(${aA(e.x)}, ${aA(e.y)}, ${aA(e.z)})`;const s=e;return`ivec3(${aA(s[0])}, ${aA(s[1])}, ${aA(s[2])})`}case"vec3":{if(e instanceof I.Vector3)return`vec3(${H(e.x)}, ${H(e.y)}, ${H(e.z)})`;const s=e;return`vec3(${H(s[0])}, ${H(s[1])}, ${H(s[2])})`}case"bvec4":{const s=e;return`bvec4(${s[0]}, ${s[1]}, ${s[2]}, ${s[3]})`}case"uvec4":{if(e instanceof I.Vector4)return`uvec4(${oA(e.x)}, ${oA(e.y)}, ${oA(e.z)}, ${oA(e.w)})`;const s=e;return`uvec4(${oA(s[0])}, ${oA(s[1])}, ${oA(s[2])}, ${oA(s[3])})`}case"ivec4":{if(e instanceof I.Vector4)return`ivec4(${aA(e.x)}, ${aA(e.y)}, ${aA(e.z)}, ${aA(e.w)})`;const s=e;return`ivec4(${aA(s[0])}, ${aA(s[1])}, ${aA(s[2])}, ${aA(s[3])})`}case"vec4":{if(e instanceof I.Vector4)return`vec4(${H(e.x)}, ${H(e.y)}, ${H(e.z)}, ${H(e.w)})`;if(e instanceof I.Quaternion)return`vec4(${H(e.x)}, ${H(e.y)}, ${H(e.z)}, ${H(e.w)})`;const s=e;return`vec4(${H(s[0])}, ${H(s[1])}, ${H(s[2])}, ${H(s[3])})`}case"mat2":case"mat2x2":{const s=e,n=s instanceof I.Matrix2?s.elements:e,i=new Array(4).fill(0).map((r,a)=>H(n[a]));return`${A}(${i.join(", ")})`}case"mat2x3":{const s=e,n=new Array(6).fill(0).map((i,r)=>H(s[r]));return`${A}(${n.join(", ")})`}case"mat2x4":{const s=e,n=new Array(8).fill(0).map((i,r)=>H(s[r]));return`${A}(${n.join(", ")})`}case"mat3":case"mat3x3":{const s=e,n=s instanceof I.Matrix3?s.elements:e,i=new Array(9).fill(0).map((r,a)=>H(n[a]));return`${A}(${i.join(", ")})`}case"mat3x2":{const s=e,n=new Array(6).fill(0).map((i,r)=>H(s[r]));return`${A}(${n.join(", ")})`}case"mat3x4":{const s=e,n=new Array(12).fill(0).map((i,r)=>H(s[r]));return`${A}(${n.join(", ")})`}case"mat4":case"mat4x4":{const s=e,n=s instanceof I.Matrix4?s.elements:e,i=new Array(16).fill(0).map((r,a)=>H(n[a]));return`${A}(${i.join(", ")})`}case"mat4x2":{const s=e,n=new Array(8).fill(0).map((i,r)=>H(s[r]));return`${A}(${n.join(", ")})`}case"mat4x3":{const s=e,n=new Array(12).fill(0).map((i,r)=>H(s[r]));return`${A}(${n.join(", ")})`}default:throw new Error(`Type not implemented: ${String(A)}`)}}}function J(t,A){return new $s(t,A)}function Lt(t){const A=String(t);if(dt(t))return`${A}(false)`;if(ot(t))return`${A}(0.0)`;if(QA(t))return`${A}(0)`;if(pA(t))return`${A}(0u)`;throw new Error(`Type not implemented: ${A}`)}function mc(t){const A=String(t);if(dt(t))return`${A}(true)`;if(ot(t))return`${A}(1.0)`;if(QA(t))return`${A}(1)`;if(pA(t))return`${A}(1u)`;throw new Error(`Type not implemented: ${A}`)}function wc(t){const A=String(t);if(dt(t))return`${A}(true)`;if(ot(t))return`${A}(-1.0)`;if(QA(t))return`${A}(-1)`;if(pA(t))return`${A}(0xFFFFFFFFu)`;throw new Error(`Type not implemented: ${A}`)}const Qs="    ";class Ps{constructor({indent:A}={}){this.globals=new Set,this.statements=[],this.uniforms={},this.declares=new Set,this.updaters=[],this.sequence=0,this.indent=Qs,this.indent=A??Qs}nextSequence(){return this.sequence++}}class P{constructor({inTypes:A,outTypes:e,inputs:s,update:n,globals:i,statements:r,generate:a}){this.inTypes=A??{},this.outTypes=e??{},this.inputs=s??{},this.update=n,this.globals=i,this.statements=r,this.generate=a??(({inputs:o,outputs:g,compile:l})=>{var c,u;return{globals:(c=this.globals)==null?void 0:c.call(this,{inputs:o,outputs:g,compile:l}),statements:(u=this.statements)==null?void 0:u.call(this,{inputs:o,outputs:g,compile:l})}})}get outputs(){const A={};for(const e in this.outTypes)A[e]=new K(this,e);return A}apply(A){return Object.assign(this.inputs,A),this.outputs}compile({inputs:A,outputs:e,compile:s}){const n=[`// ${this.constructor.name}(${Object.values(A).join(", ")}) => (${Object.values(e).join(", ")})`],i=[];for(const g in e){const l=e[g];l&&!s.declares.has(l)&&(s.declares.add(l),i.push(g))}const{globals:r,statements:a,uniforms:o}=this.generate({inputs:A,outputs:e,compile:s});for(const g of r??[])s.globals.add(g);for(const g in o)s.uniforms[g]=o[g];this.update&&s.updaters.push(this.update);for(const g of i){const l=e[g];l&&(s.uniforms[l]||n.push(`${As(l,this.outTypes[g])};`))}return a!=null&&a.length&&(n.push("{"),n.push(...a.map(g=>s.indent+g)),n.push("}")),n}}class VA extends P{constructor({inTypes:A,outTypes:e,inputs:s,update:n,globals:i,construct:r}){super({inTypes:A,outTypes:e,inputs:s,update:n,globals:i,generate:a=>this.generateBlock(a)}),this.construct=r}generateBlock({inputs:A,outputs:e,compile:s}){var E,C;const n={},i={};for(const B in A)A[B]!=null&&(n[B]=new bt(this.inTypes[B],A[B]));for(const B in e)e[B]!=null&&(i[B]=new it(this.outTypes[B]));const r={roots:[]},a=this.construct(n,i,r);for(const B of((E=this.globals)==null?void 0:E.call(this,{inputs:A,outputs:e,compile:s}))??[])s.globals.add(B);const o=[],g=new Map;function l(B,Q,f){let p=g.get(B);if(!p){p={sequence:s.nextSequence(),outNames:new Map,newOuts:new Set},g.set(B,p);for(const d in B.inputs){let y=B.inputs[d];for(;y;){if(y instanceof it){y instanceof K&&l(y.dyno,y.key);break}y=y.dynoOut()}}o.push(B)}Q&&(f||p.newOuts.add(Q),p.outNames.set(Q,f??`${Q}_${p.sequence}`))}for(const B of r.roots)l(B);for(const B in i){let Q=(a==null?void 0:a[B])??i[B];for(;Q;){if(Q instanceof it){Q instanceof K&&l(Q.dyno,Q.key,e[B]);break}Q=Q.dynoOut()}i[B]=Q}const c=[];for(const B of o){const Q={},f={};for(const y in B.inputs){let D=B.inputs[y];for(;D;){if(D instanceof it){if(D instanceof bt)Q[y]=D.getLiteral();else if(D instanceof K){const x=(C=g.get(D.dyno))==null?void 0:C.outNames.get(D.key);if(!x)throw new Error(`Source not found for ${D.dyno.constructor.name}.${D.key}`);Q[y]=x}break}D=D.dynoOut()}}const p=g.get(B)??{outNames:new Map};for(const[y,D]of p.outNames.entries())f[y]=D;const d=B.compile({inputs:Q,outputs:f,compile:s});c.push(d)}const u=[];for(const B in e)i[B]instanceof bt&&u.push(`${e[B]} = ${i[B].getLiteral()};`);return u.length>0&&c.push(u),{statements:c.flatMap((B,Q)=>Q===0?B:["",...B])}}}function FA(t,A,e,{update:s,globals:n}={}){return new VA({inTypes:t,outTypes:A,construct:e,update:s,globals:n})}function ne({inTypes:t,outTypes:A,inputs:e,update:s,globals:n,statements:i,generate:r}){return new P({inTypes:t,outTypes:A,inputs:e,update:s,globals:n,statements:i,generate:r})}function As(t,A,e){const s=typeof A=="string"?A:A.type;if(!s)throw new Error(`Invalid DynoType: ${String(A)}`);return`${s} ${t}${e!=null?`[${e}]`:""}`}function YA(t){var i;let A=!1;const e=t.split(`
`).map(r=>{const a=r.trimEnd();return A?a:a.length>0?(A=!0,a):null}).filter(r=>r!=null);for(;e.length>0&&e[e.length-1].length===0;)e.pop();if(e.length===0)return[];const s=(i=e[0].match(/^\s*/))==null?void 0:i[0];if(!s)return e;const n=new RegExp(`^${s}`);return e.map(r=>r.replace(n,""))}function CA(t){return YA(t).join(`
`)}class v extends P{constructor({a:A,outKey:e,outTypeFunc:s}){const n={a:$(A)},i=s($(A)),r={[e]:i};super({inTypes:n,outTypes:r,inputs:{a:A}}),this.outKey=e}dynoOut(){return new K(this,this.outKey)}}class tA extends P{constructor({a:A,b:e,outKey:s,outTypeFunc:n}){const i={a:$(A),b:$(e)},r=n($(A),$(e)),a={[s]:r};super({inTypes:i,outTypes:a,inputs:{a:A,b:e}}),this.outKey=s}dynoOut(){return new K(this,this.outKey)}}class mt extends P{constructor({a:A,b:e,c:s,outKey:n,outTypeFunc:i}){const r={a:$(A),b:$(e),c:$(s)},a=i($(A),$(e),$(s)),o={[n]:a};super({inTypes:r,outTypes:o,inputs:{a:A,b:e,c:s}}),this.outKey=n}dynoOut(){return new K(this,this.outKey)}}const AA={type:"Gsplat"},ie={type:"PackedSplats"},xc=t=>new Os({packedSplats:t}),Ft=(t,A)=>new Zs({packedSplats:t,index:A}),Vs=(t,A,e,s)=>new js({packedSplats:t,index:A,base:e,count:s}),Bt=t=>new Ws({gsplat:t}),rt=({gsplat:t,flags:A,index:e,center:s,scales:n,quaternion:i,rgba:r,rgb:a,opacity:o,x:g,y:l,z:c,r:u,g:h,b:E})=>new An({gsplat:t,flags:A,index:e,center:s,scales:n,quaternion:i,rgba:r,rgb:a,opacity:o,x:g,y:l,z:c,r:u,g:h,b:E}),He=t=>new en({gsplat:t}),ts=(t,{scale:A,rotate:e,translate:s,recolor:n})=>new sn({gsplat:t,scale:A,rotate:e,translate:s,recolor:n}),NA=CA(`
  struct Gsplat {
    vec3 center;
    uint flags;
    vec3 scales;
    int index;
    vec4 quaternion;
    vec4 rgba;
  };
  const uint GSPLAT_FLAG_ACTIVE = 1u << 0u;

  bool isGsplatActive(uint flags) {
    return (flags & GSPLAT_FLAG_ACTIVE) != 0u;
  }
`),we=CA(`
  struct PackedSplats {
    usampler2DArray texture;
    int numSplats;
    vec4 rgbMinMaxLnScaleMinMax;
  };
`);class Os extends v{constructor({packedSplats:A}){super({a:A,outKey:"numSplats",outTypeFunc:()=>"int"}),this.statements=({inputs:e,outputs:s})=>[`${s.numSplats} = ${e.a}.numSplats;`]}}const Xs=CA(`
  bool readPackedSplat(usampler2DArray texture, int numSplats, vec4 rgbMinMaxLnScaleMinMax, int index, out Gsplat gsplat) {
    if ((index >= 0) && (index < numSplats)) {
      uvec4 packed = texelFetch(texture, splatTexCoord(index), 0);
      unpackSplatEncoding(packed, gsplat.center, gsplat.scales, gsplat.quaternion, gsplat.rgba, rgbMinMaxLnScaleMinMax);
      return true;
    } else {
      return false;
    }
  }
`);class Zs extends P{constructor({packedSplats:A,index:e}){super({inTypes:{packedSplats:ie,index:"int"},outTypes:{gsplat:AA},inputs:{packedSplats:A,index:e},globals:()=>[NA,we,Xs],statements:({inputs:s,outputs:n})=>{const{gsplat:i}=n;if(!i)return[];const{packedSplats:r,index:a}=s;let o;return r&&a?o=YA(`
            if (readPackedSplat(${r}.texture, ${r}.numSplats, ${r}.rgbMinMaxLnScaleMinMax, ${a}, ${i})) {
              bool zeroSize = all(equal(${i}.scales, vec3(0.0, 0.0, 0.0)));
              ${i}.flags = zeroSize ? 0u : GSPLAT_FLAG_ACTIVE;
            } else {
              ${i}.flags = 0u;
            }
          `):o=[`${i}.flags = 0u;`],o.push(`${i}.index = ${a??"0"};`),o}})}dynoOut(){return new K(this,"gsplat")}}class js extends P{constructor({packedSplats:A,index:e,base:s,count:n}){super({inTypes:{packedSplats:ie,index:"int",base:"int",count:"int"},outTypes:{gsplat:AA},inputs:{packedSplats:A,index:e,base:s,count:n},globals:()=>[NA,we,Xs],statements:({inputs:i,outputs:r})=>{const{gsplat:a}=r;if(!a)return[];const{packedSplats:o,index:g,base:l,count:c}=i;let u;return o&&g&&l&&c?u=YA(`
            ${a}.flags = 0u;
            if ((${g} >= ${l}) && (${g} < (${l} + ${c}))) {
              if (readPackedSplat(${o}.texture, ${o}.numSplats, ${o}.rgbMinMaxLnScaleMinMax, ${g}, ${a})) {
                bool zeroSize = all(equal(${a}.scales, vec3(0.0, 0.0, 0.0)));
                ${a}.flags = zeroSize ? 0u : GSPLAT_FLAG_ACTIVE;
              }
            }
          `):u=[`${a}.flags = 0u;`],u.push(`${a}.index = ${g??"0"};`),u}})}dynoOut(){return new K(this,"gsplat")}}class Ws extends P{constructor({gsplat:A}){super({inTypes:{gsplat:AA},outTypes:{flags:"uint",active:"bool",index:"int",center:"vec3",scales:"vec3",quaternion:"vec4",rgba:"vec4",rgb:"vec3",opacity:"float",x:"float",y:"float",z:"float",r:"float",g:"float",b:"float"},inputs:{gsplat:A},globals:()=>[NA],statements:({inputs:e,outputs:s})=>{const{gsplat:n}=e,{flags:i,active:r,index:a,center:o,scales:g,quaternion:l,rgba:c,rgb:u,opacity:h,x:E,y:C,z:B,r:Q,g:f,b:p}=s;return[i?`${i} = ${n?`${n}.flags`:"0u"};`:null,r?`${r} = isGsplatActive(${n?`${n}.flags`:"0u"});`:null,a?`${a} = ${n?`${n}.index`:"0"};`:null,o?`${o} = ${n?`${n}.center`:"vec3(0.0, 0.0, 0.0)"};`:null,g?`${g} = ${n?`${n}.scales`:"vec3(0.0, 0.0, 0.0)"};`:null,l?`${l} = ${n?`${n}.quaternion`:"vec4(0.0, 0.0, 0.0, 1.0)"};`:null,c?`${c} = ${n?`${n}.rgba`:"vec4(0.0, 0.0, 0.0, 0.0)"};`:null,u?`${u} = ${n?`${n}.rgba.rgb`:"vec3(0.0, 0.0, 0.0)"};`:null,h?`${h} = ${n?`${n}.rgba.a`:"0.0"};`:null,E?`${E} = ${n?`${n}.center.x`:"0.0"};`:null,C?`${C} = ${n?`${n}.center.y`:"0.0"};`:null,B?`${B} = ${n?`${n}.center.z`:"0.0"};`:null,Q?`${Q} = ${n?`${n}.rgba.r`:"0.0"};`:null,f?`${f} = ${n?`${n}.rgba.g`:"0.0"};`:null,p?`${p} = ${n?`${n}.rgba.b`:"0.0"};`:null].filter(Boolean)}})}}class An extends P{constructor({gsplat:A,flags:e,index:s,center:n,scales:i,quaternion:r,rgba:a,rgb:o,opacity:g,x:l,y:c,z:u,r:h,g:E,b:C}){super({inTypes:{gsplat:AA,flags:"uint",index:"int",center:"vec3",scales:"vec3",quaternion:"vec4",rgba:"vec4",rgb:"vec3",opacity:"float",x:"float",y:"float",z:"float",r:"float",g:"float",b:"float"},outTypes:{gsplat:AA},inputs:{gsplat:A,flags:e,index:s,center:n,scales:i,quaternion:r,rgba:a,rgb:o,opacity:g,x:l,y:c,z:u,r:h,g:E,b:C},globals:()=>[NA],statements:({inputs:B,outputs:Q})=>{const{gsplat:f}=Q;if(!f)return[];const{gsplat:p,flags:d,index:y,center:D,scales:x,quaternion:m,rgba:w,rgb:T,opacity:M,x:S,y:U,z:F,r:b,g:k,b:R}=B;return[`${f}.flags = ${d??(p?`${p}.flags`:"0u")};`,`${f}.index = ${y??(p?`${p}.index`:"0")};`,`${f}.center = ${D??(p?`${p}.center`:"vec3(0.0, 0.0, 0.0)")};`,`${f}.scales = ${x??(p?`${p}.scales`:"vec3(0.0, 0.0, 0.0)")};`,`${f}.quaternion = ${m??(p?`${p}.quaternion`:"vec4(0.0, 0.0, 0.0, 1.0)")};`,`${f}.rgba = ${w??(p?`${p}.rgba`:"vec4(0.0, 0.0, 0.0, 0.0)")};`,T?`${f}.rgba.rgb = ${T};`:null,M?`${f}.rgba.a = ${M};`:null,S?`${f}.center.x = ${S};`:null,U?`${f}.center.y = ${U};`:null,F?`${f}.center.z = ${F};`:null,b?`${f}.rgba.r = ${b};`:null,k?`${f}.rgba.g = ${k};`:null,R?`${f}.rgba.b = ${R};`:null].filter(Boolean)}})}dynoOut(){return new K(this,"gsplat")}}const tn=CA(`
  vec3 gsplatNormal(vec3 scales, vec4 quaternion) {
    float minScale = min(scales.x, min(scales.y, scales.z));
    vec3 normal;
    if (scales.z == minScale) {
      normal = vec3(0.0, 0.0, 1.0);
    } else if (scales.y == minScale) {
      normal = vec3(0.0, 1.0, 0.0);
    } else {
      normal = vec3(1.0, 0.0, 0.0);
    }
    return quatVec(quaternion, normal);
  }
`);class en extends v{constructor({gsplat:A}){super({a:A,outKey:"normal",outTypeFunc:()=>"vec3"}),this.globals=()=>[NA,tn],this.statements=({inputs:e,outputs:s})=>[`${s.normal} = gsplatNormal(${e.a}.scales, ${e.a}.quaternion);`]}}class sn extends P{constructor({gsplat:A,scale:e,rotate:s,translate:n,recolor:i}){super({inTypes:{gsplat:AA,scale:"float",rotate:"vec4",translate:"vec3",recolor:"vec4"},outTypes:{gsplat:AA},inputs:{gsplat:A,scale:e,rotate:s,translate:n,recolor:i},globals:()=>[NA],statements:({inputs:r,outputs:a,compile:o})=>{const{gsplat:g}=a;if(!g||!r.gsplat)return[];const{scale:l,rotate:c,translate:u,recolor:h}=r,E=o.indent;return[`${g} = ${r.gsplat};`,`if (isGsplatActive(${g}.flags)) {`,l?`${E}${g}.center *= ${l};`:null,c?`${E}${g}.center = quatVec(${c}, ${g}.center);`:null,u?`${E}${g}.center += ${u};`:null,l?`${E}${g}.scales *= ${l};`:null,c?`${E}${g}.quaternion = quatQuat(${c}, ${g}.quaternion);`:null,h?`${E}${g}.rgba *= ${h};`:null,"}"].filter(Boolean)}})}dynoOut(){return new K(this,"gsplat")}}const nn=(t,A)=>new rn({gsplat:t,rgbMinMaxLnScaleMinMax:A}),Sc=t=>new es({rgba8:t});class rn extends P{constructor({gsplat:A,rgbMinMaxLnScaleMinMax:e}){super({inTypes:{gsplat:AA,rgbMinMaxLnScaleMinMax:"vec4"},inputs:{gsplat:A,rgbMinMaxLnScaleMinMax:e},globals:()=>[NA],statements:({inputs:s,outputs:n})=>{const{output:i}=n;if(!i)return[];const{gsplat:r,rgbMinMaxLnScaleMinMax:a}=s;return r?YA(`
            if (isGsplatActive(${r}.flags)) {
              ${i} = packSplatEncoding(${r}.center, ${r}.scales, ${r}.quaternion, ${r}.rgba, ${a});
            } else {
              ${i} = uvec4(0u, 0u, 0u, 0u);
            }
          `):[`${i} = uvec4(0u, 0u, 0u, 0u);`]}})}dynoOut(){return new K(this,"output")}}class es extends P{constructor({rgba8:A}){super({inTypes:{rgba8:"vec4"},inputs:{rgba8:A},statements:({inputs:e,outputs:s})=>[`target = ${e.rgba8??"vec4(0.0, 0.0, 0.0, 0.0)"};`]})}dynoOut(){return new K(this,"rgba8")}}const Dc=(t,A,e)=>new N({key:t,type:A,value:e}),Mc=(t=!1,A)=>new Ce({key:A,value:t}),vc=(t=0,A)=>new an({key:A,value:t}),bc=(t=0,A)=>new Ot({key:A,value:t}),qA=(t=0,A)=>new Et({key:A,value:t}),Fc=(t,A)=>new on({key:A,value:t}),Nc=(t,A)=>new cn({key:A,value:t}),Tc=(t,A)=>new gn({key:A,value:t}),kc=(t,A)=>new qt({key:A,value:t}),Uc=(t,A)=>new ln({key:A,value:t}),Gc=(t,A)=>new un({key:A,value:t}),Rc=(t,A)=>new In({key:A,value:t}),et=(t,A)=>new Nt({key:A,value:t}),Yc=(t,A)=>new hn({key:A,value:t}),Jc=(t,A)=>new Cn({key:A,value:t}),_c=(t,A)=>new Bn({key:A,value:t}),Lc=(t,A)=>new Gt({key:A,value:t}),zc=(t,A)=>new En({key:A,value:t}),Hc=(t,A)=>new Qn({key:A,value:t}),qc=(t,A)=>new pn({key:A,value:t}),Kc=(t,A)=>new fn({key:A,value:t}),$c=(t,A)=>new dn({key:A,value:t}),Pc=(t,A)=>new yn({key:A,value:t}),Vc=(t,A)=>new mn({key:A,value:t}),Oc=(t,A)=>new wn({key:A,value:t}),Xc=(t,A)=>new xn({key:A,value:t}),Zc=(t,A)=>new Sn({key:A,value:t}),jc=(t,A)=>new Dn({key:A,value:t}),Wc=(t,A)=>new Mn({key:A,value:t}),Ag=(t,A)=>new vn({key:A,value:t}),tg=(t,A)=>new bn({key:A,value:t}),eg=(t,A)=>new Fn({key:A,value:t}),sg=(t,A)=>new Kt({key:A,value:t}),ng=(t,A)=>new Nn({key:t,value:A}),ig=(t,A)=>new Tn({key:A,value:t}),rg=(t,A)=>new kn({key:A,value:t}),ag=(t,A)=>new Un({key:A,value:t}),og=(t,A)=>new Gn({key:A,value:t}),cg=(t,A)=>new Rn({key:A,value:t}),gg=(t,A)=>new Yn({key:A,value:t}),lg=(t,A)=>new Jn({key:A,value:t}),ug=(t,A)=>new _n({key:A,value:t}),Ig=(t,A)=>new Ln({key:A,value:t}),hg=(t,A)=>new zn({key:A,value:t});class N extends P{constructor({key:A,type:e,count:s,value:n,update:i,globals:r}){A=A??"value",super({outTypes:{[A]:e},update:()=>{if(i){const a=i(this.value);a!==void 0&&(this.value=a)}this.uniform.value=this.value},generate:({inputs:a,outputs:o})=>{const g=(r==null?void 0:r({inputs:a,outputs:o}))??[],l={},c=o[A];return c&&(g.push(`uniform ${As(c,e,s)};`),l[c]=this.uniform),{globals:g,uniforms:l}}}),this.type=e,this.count=s,this.value=n,this.uniform={value:n},this.outKey=A}dynoOut(){return new K(this,this.outKey)}}class Ce extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"bool",value:e,update:s})}}class an extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"uint",value:e,update:s})}}class Ot extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"int",value:e,update:s})}}class Et extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"float",value:e,update:s})}}class on extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"bvec2",value:e,update:s})}}class cn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"uvec2",value:e,update:s})}}class gn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"ivec2",value:e,update:s})}}class qt extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"vec2",value:e,update:s})}}class ln extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"bvec3",value:e,update:s})}}class un extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"uvec3",value:e,update:s})}}class In extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"ivec3",value:e,update:s})}}class Nt extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"vec3",value:e,update:s})}}class hn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"bvec4",value:e,update:s})}}class Cn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"uvec4",value:e,update:s})}}class Bn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"ivec4",value:e,update:s})}}class Gt extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"vec4",value:e,update:s})}}class En extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat2",value:e,update:s})}}class Qn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat2x2",value:e,update:s})}}class pn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat2x3",value:e,update:s})}}class fn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat2x4",value:e,update:s})}}class dn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat3",value:e,update:s})}}class yn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat3x2",value:e,update:s})}}class mn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat3x3",value:e,update:s})}}class wn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat3x4",value:e,update:s})}}class xn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat4",value:e,update:s})}}class Sn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat4x2",value:e,update:s})}}class Dn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat4x3",value:e,update:s})}}class Mn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"mat4x4",value:e,update:s})}}class vn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"usampler2D",value:e,update:s})}}class bn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"isampler2D",value:e,update:s})}}class Fn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"sampler2D",value:e,update:s})}}class Kt extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"usampler2DArray",value:e,update:s})}}class Nn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"isampler2DArray",value:e,update:s})}}class Tn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"sampler2DArray",value:e,update:s})}}class kn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"usampler3D",value:e,update:s})}}class Un extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"isampler3D",value:e,update:s})}}class Gn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"sampler3D",value:e,update:s})}}class Rn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"usamplerCube",value:e,update:s})}}class Yn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"isamplerCube",value:e,update:s})}}class Jn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"samplerCube",value:e,update:s})}}class _n extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"sampler2DShadow",value:e,update:s})}}class Ln extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"sampler2DArrayShadow",value:e,update:s})}}class zn extends N{constructor({key:A,value:e,update:s}){super({key:A,type:"samplerCubeShadow",value:e,update:s})}}const re=new Float32Array(1),xe=new Uint32Array(re.buffer),ss="Float16Array"in globalThis,$t=ss?new globalThis.Float16Array(1):null,Hn=new Uint16Array($t==null?void 0:$t.buffer);function qn(t){const A=Math.sqrt(t.reduce((e,s)=>e+s*s,0));return t.map(e=>e/A)}function Cg(t){return re[0]=t,xe[0]}function Bg(t){return xe[0]=t,re[0]}const at=ss?Eg:Qg,fA=ss?pg:fg;function Eg(t){return $t[0]=t,Hn[0]}function Qg(t){re[0]=t;const A=xe[0],e=A>>31&1,s=A>>23&255,n=A&8388607,i=e<<15;if(s===255)return n!==0?i|32767:i|31744;const r=s-127+15;if(r>=31)return i|31744;if(r<=0){if(r<-10)return i;const o=(n|8388608)>>1-r+13;return i|o}const a=n>>13;return i|r<<10|a}function pg(t){return Hn[0]=t,$t[0]}function fg(t){const A=t>>15&1,e=t>>10&31,s=t&1023;let n;if(e===0)if(s===0)n=A<<31;else{let i=s,r=-14;for(;(i&1024)===0;)i<<=1,r--;i&=1023;const a=r+127,o=i<<13;n=A<<31|a<<23|o}else if(e===31)s===0?n=A<<31|2139095040:n=A<<31|2143289344;else{const i=e-15+127,r=s<<13;n=A<<31|i<<23|r}return xe[0]=n,re[0]}function bA(t){return Math.max(0,Math.min(255,Math.round(t*255)))}function Pt(t){return Math.max(-127,Math.min(127,Math.round(t*127)))}function Kn(t){return t/255}function $n(t){return t/127}class dg{constructor({asyncFetch:A,maxItems:e=5}){this.asyncFetch=A,this.maxItems=e,this.items=[]}async getFetch(A){const e=this.items.findIndex(n=>n.key===A);if(e>=0){const n=this.items.splice(e,1)[0];return this.items.push(n),n.data}const s=await this.asyncFetch(A);for(this.items.push({key:A,data:s});this.items.length>this.maxItems;)this.items.shift();return s}}function yg(t,A){const e=Object.entries(t).map(([s,n])=>[s,A(n,s)]);return Object.fromEntries(e)}function mg(t,A){const e=Object.entries(t).map(([s,n])=>[s,A(n,s)]).filter(([s,n])=>n!==void 0);return Object.fromEntries(e)}function Pn(t){const A=[],e=new Set;function s(n){n&&typeof n=="object"&&!e.has(n)&&(e.add(n),n instanceof ArrayBuffer?A.push(n):ArrayBuffer.isView(n)?A.push(n.buffer):Array.isArray(n)?n.forEach(s):Object.values(n).forEach(s))}return s(t),A}function wg(t,A){return new Array(t).fill(null).map((e,s)=>A(s))}class Vn{constructor({allocate:A,dispose:e,valid:s}){this.items=[],this.allocate=A,this.dispose=e,this.valid=s}alloc(A){for(;;){const e=this.items.pop();if(!e)break;if(this.valid(e,A))return e;this.dispose&&this.dispose(e)}return this.allocate(A)}free(A){this.items.push(A)}disposeAll(){let A;for(A=this.items.pop();A;)this.dispose&&this.dispose(A),A=this.items.pop()}}function Be(t,A,e,s,n,i,r,a,o,g,l,c,u,h,E,C,B){const Q=(B==null?void 0:B.rgbMin)??0,p=((B==null?void 0:B.rgbMax)??1)-Q,d=bA((h-Q)/p),y=bA((E-Q)/p),D=bA((C-Q)/p),x=bA(u),m=ns(On.set(o,g,l,c)),w=m&255,T=m>>>8&255,M=m>>>16&255,S=(B==null?void 0:B.lnScaleMin)??TA,F=254/(((B==null?void 0:B.lnScaleMax)??kA)-S),b=i<Ct?0:Math.min(255,Math.max(1,Math.round((Math.log(i)-S)*F)+1)),k=r<Ct?0:Math.min(255,Math.max(1,Math.round((Math.log(r)-S)*F)+1)),R=a<Ct?0:Math.min(255,Math.max(1,Math.round((Math.log(a)-S)*F)+1)),X=at(e),_=at(s),eA=at(n),q=A*4;t[q]=d|y<<8|D<<16|x<<24,t[q+1]=X|_<<16,t[q+2]=eA|w<<16|T<<24,t[q+3]=b|k<<8|R<<16|M<<24}function xg(t,A,e,s,n){const i=at(e),r=at(s),a=at(n),o=A*4;t[o+1]=i|r<<16,t[o+2]=a|t[o+2]&4294901760}function Sg(t,A,e,s,n,i){const r=(i==null?void 0:i.lnScaleMin)??TA,o=254/(((i==null?void 0:i.lnScaleMax)??kA)-r),g=e<Ct?0:Math.min(255,Math.max(1,Math.round((Math.log(e)-r)*o)+1)),l=s<Ct?0:Math.min(255,Math.max(1,Math.round((Math.log(s)-r)*o)+1)),c=n<Ct?0:Math.min(255,Math.max(1,Math.round((Math.log(n)-r)*o)+1)),u=A*4;t[u+3]=g|l<<8|c<<16|t[u+3]&4278190080}const On=new I.Quaternion;function Dg(t,A,e,s,n,i){const r=ns(On.set(e,s,n,i)),a=r&255,o=r>>>8&255,g=r>>>16&255,l=A*4;t[l+2]=t[l+2]&65535|a<<16|o<<24,t[l+3]=t[l+3]&16777215|g<<24}function Mg(t,A,e,s,n,i,r){const a=(r==null?void 0:r.rgbMin)??0,g=((r==null?void 0:r.rgbMax)??1)-a,l=bA((e-a)/g),c=bA((s-a)/g),u=bA((n-a)/g),h=bA(i),E=A*4;t[E]=l|c<<8|u<<16|h<<24}function vg(t,A,e,s,n,i){const r=(i==null?void 0:i.rgbMin)??0,o=((i==null?void 0:i.rgbMax)??1)-r,g=bA((e-r)/o),l=bA((s-r)/o),c=bA((n-r)/o),u=A*4;t[u]=g|l<<8|c<<16|t[u]&4278190080}function bg(t,A,e){const s=bA(e),n=A*4;t[n]=t[n]&16777215|s<<24}const Fg=new I.Vector3,Ng=new I.Vector3,Tg=new I.Quaternion,kg=new I.Color,Ug={center:Fg,scales:Ng,quaternion:Tg,color:kg,opacity:0};function Ee(t,A,e){const s=Ug,n=A*4,i=t[n],r=t[n+1],a=t[n+2],o=t[n+3],g=(e==null?void 0:e.rgbMin)??0,c=((e==null?void 0:e.rgbMax)??1)-g;s.color.set(g+(i&255)/255*c,g+(i>>>8&255)/255*c,g+(i>>>16&255)/255*c),s.opacity=(i>>>24&255)/255,s.center.set(fA(r&65535),fA(r>>>16&65535),fA(a&65535));const u=(e==null?void 0:e.lnScaleMin)??TA,E=(((e==null?void 0:e.lnScaleMax)??kA)-u)/254,C=o&255;s.scales.x=C===0?0:Math.exp(u+(C-1)*E);const B=o>>>8&255;s.scales.y=B===0?0:Math.exp(u+(B-1)*E);const Q=o>>>16&255;s.scales.z=Q===0?0:Math.exp(u+(Q-1)*E);const f=a>>>16&65535|o>>>8&16711680;return ai(f,s.quaternion),s}function xA(t){const A=O,e=Math.max(We,Math.min($A,Math.ceil(t/A))),s=Math.ceil(t/(A*e)),n=A*e*s;return{width:A,height:e,depth:s,maxSplats:n}}function Gg(t){const A=O,e=Math.max(We,Math.min($A,Math.ceil(t/A))),s=Math.ceil(t/(A*e));return A*e*s}function Xn(){return navigator.maxTouchPoints>0?!0:/Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile/.test(navigator.userAgent)}function Zn(){return/Android/.test(navigator.userAgent)}function jn(){return/Oculus/.test(navigator.userAgent)}function Wn(t,A,e){const s=new Uint8Array(A*4);for(let n=0;n<e/2;n++){const i=n*A*4,r=(e-1-n)*A*4;s.set(t.subarray(i,i+A*4)),t.set(t.subarray(r,r+A*4),i),t.set(s,r)}return t}function Ai(t,A,e){const s=document.createElement("canvas");s.width=A,s.height=e;const n=s.getContext("2d");if(!n)throw new Error("Can't get 2d context");const i=n.createImageData(A,e);return i.data.set(t),n.putImageData(i,0,0),s.toDataURL("image/png")}function ti(t){const A=new I.Clock(t.autoStart);return A.startTime=t.startTime,A.oldTime=t.oldTime,A.elapsedTime=t.elapsedTime,A.running=t.running,A}function Rg(t){return Object.fromEntries(Object.entries(t).filter(([A,e])=>e!==void 0))}const ei=CA(`
  precision highp float;

  in vec3 position;

  void main() {
    gl_Position = vec4(position.xy, 0.0, 1.0);
  }
`);function si(t){const A=new I.Vector3;for(const e of t)A.add(e);return A.divideScalar(t.length)}function ni(t){if(t.length===0)return new I.Quaternion;const A=t[0].clone();for(let e=1;e<t.length;e++)t[e].dot(t[0])<0?(A.x-=t[e].x,A.y-=t[e].y,A.z-=t[e].z,A.w-=t[e].w):(A.x+=t[e].x,A.y+=t[e].y,A.z+=t[e].z,A.w+=t[e].w);return A.normalize()}function ii(t,A){const e=new I.Vector3(0,0,0).applyMatrix4(t),s=new I.Vector3(0,0,0).applyMatrix4(A),n=new I.Vector3(0,0,-1).applyMatrix4(t).sub(e).normalize(),i=new I.Vector3(0,0,-1).applyMatrix4(A).sub(s).normalize(),r=e.distanceTo(s),a=n.dot(i);return{distance:r,coincidence:a}}function Yg({matrix1:t,matrix2:A,maxDistance:e}){const s=new I.Vector3(0,0,0).applyMatrix4(t),n=new I.Vector3(0,0,0).applyMatrix4(A);return s.distanceTo(n)<=e}function Jg({matrix1:t,matrix2:A,maxDistance:e,minCoincidence:s}){const{distance:n,coincidence:i}=ii(t,A);return n<=e&&(s==null||i>=s)}function ri(t,A){const[e,s]=[new I.Vector3,new I.Quaternion],[n,i]=[new I.Vector3,new I.Quaternion];t.decompose(e,s,new I.Vector3),A.decompose(n,i,new I.Vector3);const r=e.distanceTo(n),a=Math.abs(s.dot(i));return{distance:r,coorient:a}}function Qe({matrix1:t,matrix2:A,maxDistance:e,minCoorient:s}){const{distance:n,coorient:i}=ri(t,A);return n<=e&&(s==null||i>=s)}function _g(t,A=.001){return Math.abs(t)<A?0:Math.sign(t)}function Lg(t){const A=t.w<0,e=Pt(A?-t.x:t.x),s=Pt(A?-t.y:t.y),n=Pt(A?-t.z:t.z),i=e&255,r=s&255,a=n&255;return i|r<<8|a<<16}function zg(t,A){const e=t<<24>>24,s=t<<16>>24,n=t<<8>>24;A.set(e/127,s/127,n/127,0);const i=A.x*A.x+A.y*A.y+A.z*A.z;return A.w=Math.sqrt(Math.max(0,1-i)),A}const Hg=new I.Quaternion,qe=new I.Vector3;function ns(t){const A=Hg.copy(t).normalize();A.w<0&&A.set(-A.x,-A.y,-A.z,-A.w);const e=2*Math.acos(A.w),s=Math.sqrt(A.x*A.x+A.y*A.y+A.z*A.z),n=s<1e-6?qe.set(1,0,0):qe.set(A.x,A.y,A.z).divideScalar(s),i=Math.abs(n.x)+Math.abs(n.y)+Math.abs(n.z);let r=n.x/i,a=n.y/i;if(n.z<0){const h=r;r=(1-Math.abs(a))*(r>=0?1:-1),a=(1-Math.abs(h))*(a>=0?1:-1)}const o=r*.5+.5,g=a*.5+.5,l=Math.round(o*255),c=Math.round(g*255);return Math.round(e*(255/Math.PI))<<16|c<<8|l}function ai(t,A){const e=t&255,s=t>>>8&255,n=t>>>16&255,i=e/255,r=s/255;let a=(i-.5)*2,o=(r-.5)*2;const g=1-(Math.abs(a)+Math.abs(o)),l=Math.max(-g,0);a+=a>=0?-l:l,o+=o>=0?-l:l;const c=qe.set(a,o,g).normalize(),h=n/255*Math.PI*.5,E=Math.sin(h),C=Math.cos(h);return A.set(c.x*E,c.y*E,c.z*E,C),A}function qg(t){const A=t.clone().normalize(),e=2*(A.w*A.x+A.y*A.z),s=1-2*(A.x*A.x+A.y*A.y),n=Math.atan2(e,s),i=2*(A.w*A.y-A.z*A.x),r=Math.abs(i)>=1?Math.sign(i)*(Math.PI/2):Math.asin(i),a=2*(A.w*A.z+A.x*A.y),o=1-2*(A.y*A.y+A.z*A.z),g=Math.atan2(a,o),l=(n+Math.PI)/(2*Math.PI),c=(r+Math.PI)/(2*Math.PI),u=(g+Math.PI)/(2*Math.PI),h=Math.round(l*255),E=Math.round(c*255);return Math.round(u*255)<<16|E<<8|h}function Kg(t,A){const e=t&255,s=t>>>8&255,n=t>>>16&255,i=e/255,r=s/255,a=n/255,o=i*(2*Math.PI)-Math.PI,g=r*(2*Math.PI)-Math.PI,l=a*(2*Math.PI)-Math.PI,c=Math.cos(o*.5),u=Math.sin(o*.5),h=Math.cos(g*.5),E=Math.sin(g*.5),C=Math.cos(l*.5),B=Math.sin(l*.5);return A.w=c*h*C+u*E*B,A.x=u*h*C-c*E*B,A.y=c*E*C+u*h*B,A.z=c*h*B-u*E*C,A.normalize(),A}function oe(t,A,e,s){const n=Math.max(-127,Math.min(127,t*127)),i=Math.max(-127,Math.min(127,A*127)),r=Math.max(-127,Math.min(127,e*127)),a=Math.max(-127,Math.min(127,s*127));return n&255|(i&255)<<8|(r&255)<<16|(a&255)<<24}function $g(t,A,e,s){const n=(s==null?void 0:s.sh1Min)??-1,i=(s==null?void 0:s.sh1Max)??1,r=.5*(n+i),a=126/(i-n),o=A*2;for(let g=0;g<9;++g){const l=(e[g]-r)*a,c=Math.round(Math.max(-63,Math.min(63,l)))&127,u=g*7,h=u+7,E=Math.floor(u/32),C=u-E*32,B=c<<C&4294967295;if(t[o+E]|=B,h>E*32+32){const Q=c>>>32-C&4294967295;t[o+E+1]|=Q}}}function Pg(t,A,e,s){const n=(s==null?void 0:s.sh2Min)??-1,i=(s==null?void 0:s.sh2Max)??1,r=.5*(n+i),a=2/(i-n);t[A*4+0]=oe((e[0]-r)*a,(e[1]-r)*a,(e[2]-r)*a,(e[3]-r)*a),t[A*4+1]=oe((e[4]-r)*a,(e[5]-r)*a,(e[6]-r)*a,(e[7]-r)*a),t[A*4+2]=oe((e[8]-r)*a,(e[9]-r)*a,(e[10]-r)*a,(e[11]-r)*a),t[A*4+3]=oe((e[12]-r)*a,(e[13]-r)*a,(e[14]-r)*a,0)}function Vg(t,A,e,s){const n=(s==null?void 0:s.sh3Min)??-1,i=(s==null?void 0:s.sh3Max)??1,r=.5*(n+i),a=62/(i-n),o=A*4;for(let g=0;g<21;++g){const l=(e[g]-r)*a,c=Math.round(Math.max(-31,Math.min(31,l)))&63,u=g*6,h=u+6,E=Math.floor(u/32),C=u-E*32,B=c<<C&4294967295;if(t[o+E]|=B,h>E*32+32){const Q=c>>>32-C&4294967295;t[o+E+1]|=Q}}}function oi(t,A){const e=[];let s=0,n=null;const i=new Zo((o,g)=>{if(e.push(o),s+=o.length,g||s>=A){const l=new Uint8Array(s);let c=0;for(const u of e)l.set(u,c),c+=u.length;n=l.slice(0,A)}}),r=1024;let a=0;for(;n==null&&a<t.length;){const o=t.slice(a,a+r);i.push(o,!1),a+=r}if(n==null&&(i.push(new Uint8Array,!0),n==null))throw new Error("Failed to decompress partial gzip");return n}class ci{constructor({fileBytes:A,chunkBytes:e=64*1024}){this.fileBytes=A,this.chunkBytes=e,this.chunks=[],this.totalBytes=0;const s=new DecompressionStream("gzip"),n=new Blob([A]).stream().pipeThrough(s);this.reader=n.getReader()}async read(A){for(;this.totalBytes<A;){const{value:i,done:r}=await this.reader.read();if(r)break;this.chunks.push(i),this.totalBytes+=i.length}if(this.totalBytes<A)throw new Error(`Unexpected EOF: needed ${A}, got ${this.totalBytes}`);const e=new Uint8Array(this.totalBytes);let s=0;for(const i of this.chunks)e.set(i,s),s+=i.length;const n=e.subarray(0,A);return this.chunks=[e.subarray(A)],this.totalBytes-=A,n}}const Og=Object.freeze(Object.defineProperty({__proto__:null,DataCache:dg,FreeList:Vn,GunzipReader:ci,IDENT_VERTEX_SHADER:ei,Sint8ToFloat:$n,Uint8ToFloat:Kn,averagePositions:si,averageQuaternions:ni,cloneClock:ti,coinciDist:ii,computeMaxSplats:Gg,coorientDist:ri,decodeQuatEulerXyz888:Kg,decodeQuatOctXy88R8:ai,decodeQuatXyz888:zg,decompressPartialGzip:oi,encodeQuatEulerXyz888:qg,encodeQuatOctXy88R8:ns,encodeQuatXyz888:Lg,encodeSh1Rgb:$g,encodeSh2Rgb:Pg,encodeSh3Rgb:Vg,epsilonSign:_g,flipPixels:Wn,floatBitsToUint:Cg,floatToSint8:Pt,floatToUint8:bA,fromHalf:fA,getArrayBuffers:Pn,getTextureSize:xA,isAndroid:Zn,isMobile:Xn,isOculus:jn,mapFilterObject:mg,mapObject:yg,newArray:wg,normalize:qn,omitUndefined:Rg,pixelsToPngUrl:Ai,setPackedSplat:Be,setPackedSplatCenter:xg,setPackedSplatOpacity:bg,setPackedSplatQuat:Dg,setPackedSplatRgb:vg,setPackedSplatRgba:Mg,setPackedSplatScales:Sg,toHalf:at,uintBitsToFloat:Bg,unpackSplat:Ee,withinCoinciDist:Jg,withinCoorientDist:Qe,withinDist:Yg},Symbol.toStringTag,{value:"Module"}));class is{constructor({graph:A,inputs:e,outputs:s,template:n}){this.graph=A,this.template=n,this.inputs=e??{},this.outputs=s??{};const i=new Ps({indent:this.template.indent});for(const a in this.outputs)this.outputs[a]&&i.declares.add(this.outputs[a]);const r=A.compile({inputs:this.inputs,outputs:this.outputs,compile:i});this.shader=n.generate({globals:i.globals,statements:r}),this.uniforms=i.uniforms,this.updaters=i.updaters}prepareMaterial(){return Xg(this)}update(){for(const A of this.updaters)A()}}class rs{constructor(A){const e=A.match(/^([ \t]*)\{\{\s*GLOBALS\s*\}\}/m),s=A.match(/^([ \t]*)\{\{\s*STATEMENTS\s*\}\}/m);if(!e||!s)throw new Error("Template must contain {{ GLOBALS }} and {{ STATEMENTS }}");this.before=A.substring(0,e.index),this.between=A.substring(e.index+e[0].length,s.index),this.after=A.substring(s.index+s[0].length),this.indent=s[1]}generate({globals:A,statements:e}){return this.before+Array.from(A).join(`

`)+this.between+e.map(s=>this.indent+s).join(`
`)+this.after}}const ps=new WeakMap;function Xg(t){let A=ps.get(t);return A||(A=new I.RawShaderMaterial({glslVersion:I.GLSL3,vertexShader:ei,fragmentShader:t.shader,uniforms:t.uniforms}),ps.set(t,A),A)}function as(t,A,e="add"){const s=()=>{throw new Error(`Invalid ${e} types: ${t}, ${A}`)};if(t===A)return t;if(t==="int"){if(QA(A))return A;s()}if(A==="int"){if(QA(t))return t;s()}if(t==="uint"){if(pA(A))return A;s()}if(A==="uint"){if(pA(t))return t;s()}if(t==="float"){if(ot(A))return A;s()}if(A==="float"){if(ot(t))return t;s()}throw new Error(`Invalid ${e} types: ${t}, ${A}`)}function Zg(t,A){return as(t,A,"sub")}function jg(t,A){const e=()=>{throw new Error(`Invalid mul types: ${t}, ${A}`)},s=n=>n;if(t==="int"){if(QA(A))return s(A);e()}if(A==="int"){if(QA(t))return s(t);e()}if(t==="uint"){if(pA(A))return s(A);e()}if(A==="uint"){if(pA(t))return s(t);e()}if(t==="float"){if(ot(A))return s(A);e()}if(A==="float"){if(ot(t))return s(t);e()}if(QA(t)||pA(t)||QA(A)||pA(A)){if(t===A)return s(t);e()}if(t==="vec2"){if(A==="vec2"||gt(A))return s("vec2");if(A==="mat3x2")return s("vec3");if(A==="mat4x2")return s("vec4");e()}if(t==="vec3"){if(A==="mat2x3")return s("vec2");if(A==="vec3"||lt(A))return s("vec3");if(A==="mat4x3")return s("vec4");e()}if(t==="vec4"){if(A==="mat2x4")return s("vec2");if(A==="mat3x4")return s("vec3");if(A==="vec4"||ut(A))return s("vec4");e()}if(A==="vec2"){if(gt(t))return s("vec2");if(t==="mat2x3")return s("vec3");if(t==="mat2x4")return s("vec4");e()}if(A==="vec3"){if(t==="mat3x2")return s("vec2");if(lt(t))return s("vec3");if(t==="mat3x4")return s("vec4");e()}if(A==="vec4"){if(t==="mat4x2")return s("vec2");if(t==="mat4x3")return s("vec3");if(ut(t))return s("vec4");e()}if(gt(t)){if(gt(A))return s("mat2");if(A==="mat3x2")return s("mat3x2");if(A==="mat4x2")return s("mat4x2");e()}if(t==="mat2x3"){if(gt(A))return s("mat2x3");if(A==="mat3x2")return s("mat3");if(A==="mat4x2")return s("mat4x3");e()}if(t==="mat2x4"){if(gt(A))return s("mat2x4");if(A==="mat3x2")return s("mat3x4");if(A==="mat4x2")return s("mat4");e()}if(t==="mat3x2"){if(A==="mat2x3")return s("mat2");if(lt(A))return s("mat3x2");if(A==="mat4x3")return s("mat4x2");e()}if(lt(t)){if(A==="mat2x3")return s("mat2x3");if(lt(A))return s("mat3");if(A==="mat4x3")return s("mat4x3");e()}if(t==="mat3x4"){if(A==="mat2x3")return s("mat2x4");if(lt(A))return s("mat3x4");if(A==="mat4x3")return s("mat4");e()}if(t==="mat4x2"){if(A==="mat2x4")return s("mat2");if(A==="mat3x4")return s("mat3x2");if(ut(A))return s("mat4x2");e()}if(t==="mat4x3"){if(A==="mat2x4")return s("mat2x3");if(A==="mat3x4")return s("mat3");if(ut(A))return s("mat4x3");e()}if(ut(t)){if(A==="mat2x4")return s("mat2x4");if(A==="mat3x4")return s("mat3x4");if(ut(A))return s("mat4");e()}throw new Error(`Invalid mul types: ${t}, ${A}`)}function Wg(t,A){return as(t,A,"div")}function Al(t,A){if(t===A)return t;if(t==="int"){if(QA(A))return A}else if(A==="int"){if(QA(t))return t}else if(t==="uint"){if(pA(A))return A}else if(A==="uint"&&pA(t))return t;throw new Error(`Invalid imod types: ${t}, ${A}`)}function tl(t,A){if(t===A||A==="float")return t;throw new Error(`Invalid mod types: ${t}, ${A}`)}function el(t){return t}function sl(t){return t}function nl(t){return t}function il(t){return t}function rl(t){return t}function al(t){return t}function ol(t){return t}function cl(t){return t}function gl(t){return t}function ll(t){return t}function ul(t){return t}function Il(t){return t}function hl(t){return t}function Cl(t){return t}function Bl(t){return t}function El(t){return t}function gi(t,A,e="min"){if(t===A)return t;if(A==="float"){if(ee(t))return t}else if(A==="int"){if(QA(t))return t}else if(A==="uint"&&pA(t))return t;throw new Error(`Invalid ${e} types: ${t}, ${A}`)}function Ql(t,A){return gi(t,A,"max")}function pl(t,A,e){if(A==="float"){if(ee(t))return t}else if(A==="int"){if(QA(t))return t}else if(A==="uint"&&pA(t))return t;throw new Error(`Invalid clamp types: ${t}, ${A}`)}function fl(t,A,e){if(e===t||e==="float"||e==="bool"&&t==="float"||e==="bvec2"&&t==="vec2"||e==="bvec3"&&t==="vec3"||e==="bvec4"&&t==="vec4")return t;throw new Error(`Invalid mix types: ${t}, ${A}, ${e}`)}function dl(t,A){if(t===A||A==="float")return A;throw new Error(`Invalid step types: ${t}, ${A}`)}function yl(t,A,e){if(t===A&&(t===e||t==="float"))return e;throw new Error(`Invalid smoothstep types: ${t}, ${A}, ${e}`)}function li(t,A="isNan"){if(t==="float")return"bool";if(t==="vec2")return"bvec2";if(t==="vec3")return"bvec3";if(t==="vec4")return"bvec4";throw new Error(`Invalid ${A} types: ${t}`)}function ml(t){return li(t,"isInf")}const EA=(t,A)=>new Ci({a:t,b:A}),ft=(t,A)=>new Bi({a:t,b:A}),rA=(t,A)=>new Ei({a:t,b:A}),le=(t,A)=>new Qi({a:t,b:A}),Ke=(t,A)=>new pi({a:t,b:A}),ui=(t,A)=>new fi({a:t,b:A}),wl=t=>new di({a:t}).outputs,os=t=>new yi({a:t}),xl=t=>new mi({a:t}),Sl=t=>new wi({a:t}),Dl=t=>new xi({a:t}),Ml=t=>new Si({a:t}),vl=t=>new Di({a:t}),bl=t=>new Mi({a:t}),ue=t=>new vi({a:t}),Fl=(t,A)=>new bi({a:t,b:A}),Nl=t=>new Fi({a:t}),Tl=t=>new Ni({a:t}),kl=t=>new Ti({a:t}),Ul=t=>new ki({a:t}),Gl=t=>new Ui({a:t}),Rl=t=>new Gi({a:t}),Yl=t=>new Ri({a:t}),Jl=(t,A)=>new Yi({a:t,b:A}),Ii=(t,A)=>new Ji({a:t,b:A}),_l=(t,A,e)=>new _i({a:t,min:A,max:e}),hi=(t,A,e)=>new Li({a:t,b:A,t:e}),Ll=(t,A)=>new zi({edge:t,x:A}),zl=(t,A,e)=>new Hi({edge0:t,edge1:A,x:e}),Hl=t=>new qi({a:t}),ql=t=>new Ki({a:t});class Ci extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"sum",outTypeFunc:as}),this.statements=({inputs:s,outputs:n})=>[`${n.sum} = ${s.a} + ${s.b};`]}}class Bi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"difference",outTypeFunc:Zg}),this.statements=({inputs:s,outputs:n})=>[`${n.difference} = ${s.a} - ${s.b};`]}}class Ei extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"product",outTypeFunc:jg}),this.statements=({inputs:s,outputs:n})=>[`${n.product} = ${s.a} * ${s.b};`]}}class Qi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"quotient",outTypeFunc:Wg}),this.statements=({inputs:s,outputs:n})=>[`${n.quotient} = ${s.a} / ${s.b};`]}}class pi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"remainder",outTypeFunc:Al}),this.statements=({inputs:s,outputs:n})=>[`${n.remainder} = ${s.a} % ${s.b};`]}}class fi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"remainder",outTypeFunc:tl}),this.statements=({inputs:s,outputs:n})=>[`${n.remainder} = mod(${s.a}, ${s.b});`]}}class di extends P{constructor({a:A}){const e={a:$(A)},s=e.a,n={fract:s,integer:s};super({inTypes:e,outTypes:n,inputs:{a:A}}),this.statements=({inputs:i,outputs:r})=>[`${r.fract} = modf(${i.a}, ${r.integer});`]}}class yi extends v{constructor({a:A}){super({a:A,outKey:"neg",outTypeFunc:el}),this.statements=({inputs:e,outputs:s})=>[`${s.neg} = -${e.a};`]}}class mi extends v{constructor({a:A}){super({a:A,outKey:"abs",outTypeFunc:sl}),this.statements=({inputs:e,outputs:s})=>[`${s.abs} = abs(${e.a});`]}}class wi extends v{constructor({a:A}){super({a:A,outKey:"sign",outTypeFunc:nl}),this.statements=({inputs:e,outputs:s})=>[`${s.sign} = sign(${e.a});`]}}class xi extends v{constructor({a:A}){super({a:A,outKey:"floor",outTypeFunc:il}),this.statements=({inputs:e,outputs:s})=>[`${s.floor} = floor(${e.a});`]}}class Si extends v{constructor({a:A}){super({a:A,outKey:"ceil",outTypeFunc:rl}),this.statements=({inputs:e,outputs:s})=>[`${s.ceil} = ceil(${e.a});`]}}class Di extends v{constructor({a:A}){super({a:A,outKey:"trunc",outTypeFunc:al}),this.statements=({inputs:e,outputs:s})=>[`${s.trunc} = trunc(${e.a});`]}}class Mi extends v{constructor({a:A}){super({a:A,outKey:"round",outTypeFunc:ol}),this.statements=({inputs:e,outputs:s})=>[`${s.round} = round(${e.a});`]}}class vi extends v{constructor({a:A}){super({a:A,outKey:"fract",outTypeFunc:cl}),this.statements=({inputs:e,outputs:s})=>[`${s.fract} = fract(${e.a});`]}}class bi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"power",outTypeFunc:gl}),this.statements=({inputs:s,outputs:n})=>[`${n.power} = pow(${s.a}, ${s.b});`]}}class Fi extends v{constructor({a:A}){super({a:A,outKey:"exp",outTypeFunc:ll}),this.statements=({inputs:e,outputs:s})=>[`${s.exp} = exp(${e.a});`]}}class Ni extends v{constructor({a:A}){super({a:A,outKey:"exp2",outTypeFunc:ul}),this.statements=({inputs:e,outputs:s})=>[`${s.exp2} = exp2(${e.a});`]}}class Ti extends v{constructor({a:A}){super({a:A,outKey:"log",outTypeFunc:Il}),this.statements=({inputs:e,outputs:s})=>[`${s.log} = log(${e.a});`]}}class ki extends v{constructor({a:A}){super({a:A,outKey:"log2",outTypeFunc:hl}),this.statements=({inputs:e,outputs:s})=>[`${s.log2} = log2(${e.a});`]}}class Ui extends v{constructor({a:A}){super({a:A,outKey:"sqr",outTypeFunc:Cl}),this.statements=({inputs:e,outputs:s})=>[`${s.sqr} = ${e.a} * ${e.a};`]}}class Gi extends v{constructor({a:A}){super({a:A,outKey:"sqrt",outTypeFunc:Bl}),this.statements=({inputs:e,outputs:s})=>[`${s.sqrt} = sqrt(${e.a});`]}}class Ri extends v{constructor({a:A}){super({a:A,outKey:"inversesqrt",outTypeFunc:El}),this.statements=({inputs:e,outputs:s})=>[`${s.inversesqrt} = inversesqrt(${e.a});`]}}class Yi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"min",outTypeFunc:gi}),this.statements=({inputs:s,outputs:n})=>[`${n.min} = min(${s.a}, ${s.b});`]}}class Ji extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"max",outTypeFunc:Ql}),this.statements=({inputs:s,outputs:n})=>[`${n.max} = max(${s.a}, ${s.b});`]}}class _i extends mt{constructor({a:A,min:e,max:s}){super({a:A,b:e,c:s,outKey:"clamp",outTypeFunc:pl}),this.statements=({inputs:n,outputs:i})=>{const{a:r,b:a,c:o}=n;return[`${i.clamp} = clamp(${r}, ${a}, ${o});`]}}}class Li extends mt{constructor({a:A,b:e,t:s}){super({a:A,b:e,c:s,outKey:"mix",outTypeFunc:fl}),this.statements=({inputs:n,outputs:i})=>{const{a:r,b:a,c:o}=n;return[`${i.mix} = mix(${r}, ${a}, ${o});`]}}}class zi extends tA{constructor({edge:A,x:e}){super({a:A,b:e,outKey:"step",outTypeFunc:dl}),this.statements=({inputs:s,outputs:n})=>{const{a:i,b:r}=s;return[`${n.step} = step(${i}, ${r});`]}}}class Hi extends mt{constructor({edge0:A,edge1:e,x:s}){super({a:A,b:e,c:s,outKey:"smoothstep",outTypeFunc:yl}),this.statements=({inputs:n,outputs:i})=>{const{a:r,b:a,c:o}=n;return[`${i.smoothstep} = smoothstep(${r}, ${a}, ${o});`]}}}class qi extends v{constructor({a:A}){super({a:A,outKey:"isNan",outTypeFunc:li}),this.statements=({inputs:e,outputs:s})=>[`${s.isNan} = isNan(${e.a});`]}}class Ki extends v{constructor({a:A}){super({a:A,outKey:"isInf",outTypeFunc:ml}),this.statements=({inputs:e,outputs:s})=>[`${s.isInf} = isInf(${e.a});`]}}const Kl=(t,A)=>new Pi({a:t,b:A}),$l=(t,A)=>new Vi({a:t,b:A}),Pl=(t,A)=>new Oi({a:t,b:A}),Vl=t=>new Xi({a:t}),Ol=(t,A)=>new Zi({a:t,b:A}),Xl=(t,A)=>new ji({a:t,b:A}),Zl=(t,A)=>new Wi({a:t,b:A}),$i=(t,A)=>new Ar({a:t,b:A}),jl=(t,A)=>new tr({a:t,b:A}),Wl=(t,A)=>new er({a:t,b:A}),Au=t=>new sr({a:t}),tu=t=>new nr({a:t}),cs=(t,A,e)=>new ir({cond:t,t:A,f:e}),eu=t=>new ar({a:t});class Pi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outTypeFunc:(s,n)=>s,outKey:"and"}),this.statements=({inputs:s,outputs:n})=>this.outTypes.and==="bool"?[`${n.and} = ${s.a} && ${s.b};`]:[`${n.and} = ${s.a} & ${s.b};`]}}class Vi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outTypeFunc:(s,n)=>s,outKey:"or"}),this.statements=({inputs:s,outputs:n})=>this.outTypes.or==="bool"?[`${n.or} = ${s.a} || ${s.b};`]:[`${n.or} = ${s.a} | ${s.b};`]}}class Oi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outTypeFunc:(s,n)=>s,outKey:"xor"}),this.statements=({inputs:s,outputs:n})=>this.outTypes.xor==="bool"?[`${n.xor} = ${s.a} ^^ ${s.b};`]:[`${n.xor} = ${s.a} ^ ${s.b};`]}}class Xi extends v{constructor({a:A}){super({a:A,outTypeFunc:e=>e,outKey:"not"}),this.statements=({inputs:e,outputs:s})=>this.outTypes.not==="bool"?[`${s.not} = !${e.a};`]:[`${s.not} = not(${e.a});`]}}class Zi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outTypeFunc:(s,n)=>Se(s,"lessThan"),outKey:"lessThan"}),this.statements=({inputs:s,outputs:n})=>this.outTypes.lessThan==="bool"?[`${n.lessThan} = ${s.a} < ${s.b};`]:[`${n.lessThan} = lessThan(${s.a}, ${s.b});`]}}class ji extends tA{constructor({a:A,b:e}){super({a:A,b:e,outTypeFunc:(s,n)=>Se(s,"lessThanEqual"),outKey:"lessThanEqual"}),this.statements=({inputs:s,outputs:n})=>this.outTypes.lessThanEqual==="bool"?[`${n.lessThanEqual} = ${s.a} <= ${s.b};`]:[`${n.lessThanEqual} = lessThanEqual(${s.a}, ${s.b});`]}}class Wi extends tA{constructor({a:A,b:e}){super({a:A,b:e,outTypeFunc:(s,n)=>Se(s,"greaterThan"),outKey:"greaterThan"}),this.statements=({inputs:s,outputs:n})=>this.outTypes.greaterThan==="bool"?[`${n.greaterThan} = ${s.a} > ${s.b};`]:[`${n.greaterThan} = greaterThan(${s.a}, ${s.b});`]}}class Ar extends tA{constructor({a:A,b:e}){super({a:A,b:e,outTypeFunc:(s,n)=>Se(s,"greaterThanEqual"),outKey:"greaterThanEqual"}),this.statements=({inputs:s,outputs:n})=>this.outTypes.greaterThanEqual==="bool"?[`${n.greaterThanEqual} = ${s.a} >= ${s.b};`]:[`${n.greaterThanEqual} = greaterThanEqual(${s.a}, ${s.b});`]}}class tr extends tA{constructor({a:A,b:e}){super({a:A,b:e,outTypeFunc:rr,outKey:"equal"}),this.statements=({inputs:s,outputs:n})=>this.outTypes.equal==="bool"?[`${n.equal} = ${s.a} == ${s.b};`]:[`${n.equal} = equal(${s.a}, ${s.b});`]}}class er extends tA{constructor({a:A,b:e}){super({a:A,b:e,outTypeFunc:su,outKey:"notEqual"}),this.statements=({inputs:s,outputs:n})=>this.outTypes.notEqual==="bool"?[`${n.notEqual} = ${s.a} != ${s.b};`]:[`${n.notEqual} = notEqual(${s.a}, ${s.b});`]}}class sr extends v{constructor({a:A}){super({a:A,outTypeFunc:e=>"bool",outKey:"any"}),this.statements=({inputs:e,outputs:s})=>[`${s.any} = any(${e.a});`]}}class nr extends v{constructor({a:A}){super({a:A,outTypeFunc:e=>"bool",outKey:"all"}),this.statements=({inputs:e,outputs:s})=>[`${s.all} = all(${e.a});`]}}class ir extends mt{constructor({cond:A,t:e,f:s}){super({a:A,b:e,c:s,outKey:"select",outTypeFunc:(n,i,r)=>i}),this.statements=({inputs:n,outputs:i})=>{const{a:r,b:a,c:o}=n;return[`${i.select} = (${r}) ? (${a}) : (${o});`]}}}function Se(t,A){if(yt(t))return"bool";if(t==="ivec2"||t==="uvec2"||t==="vec2")return"bvec2";if(t==="ivec3"||t==="uvec3"||t==="vec3")return"bvec3";if(t==="ivec4"||t==="uvec4"||t==="vec4")return"bvec4";throw new Error(`Invalid ${A} type: ${t}`)}function rr(t,A="equal"){if(yt(t))return"bool";if(dt(t))return t;if(t==="ivec2"||t==="uvec2"||t==="vec2")return"bvec2";if(t==="ivec3"||t==="uvec3"||t==="vec3")return"bvec3";if(t==="ivec4"||t==="uvec4"||t==="vec4")return"bvec4";throw new Error(`Invalid ${A} type: ${t}`)}function su(t){return rr(t,"notEqual")}function nu(t){if(dt(t))return"bool";if(QA(t))return"int";if(pA(t))return"uint";throw new Error(`Invalid compXor type: ${t}`)}class ar extends v{constructor({a:A}){const e=nu($(A));super({a:A,outTypeFunc:s=>e,outKey:"compXor"}),this.statements=({inputs:s,outputs:n})=>{if(yt(this.outTypes.compXor))return[`${n.compXor} = ${s.a};`];const r=(kt(e)?["x","y"]:Ut(e)?["x","y","z"]:["x","y","z","w"]).map(o=>`${s.a}.${o}`),a=dt(e)?"^^":"^";return[`${n.compXor} = ${r.join(` ${a} `)};`]}}}const iu=t=>new hr({value:t}),ru=t=>new Cr({value:t}),au=t=>new Br({value:t}),or=t=>new Er({value:t}),ou=t=>new Qr({value:t}),cu=t=>new pr({value:t}),gu=t=>new fr({value:t}),lu=t=>new dr({value:t}),uu=t=>new yr({value:t}),Iu=t=>new mr({value:t}),hu=t=>new wr({value:t}),Cu=t=>new xr({value:t}),Bu=t=>new Sr({value:t}),cr=t=>new Dr({value:t}),Qt=t=>new Mr({value:t}),gr=t=>new vr({value:t}),Eu=t=>new br({value:t}),Qu=t=>new Fr({value:t}),pu=t=>new Nr({value:t}),lr=t=>new Tr({value:t}),ur=t=>new kr({value:t}),fu=t=>new Ur({value:t}),du=t=>new Gr({value:t}),yu=t=>new Rr({value:t}),mu=t=>new Yr({value:t}),wu=t=>new Jr({value:t}),xu=t=>new _r({value:t}),Ir=t=>new Lr({value:t}),Su=t=>new zr({value:t}),$e=t=>new Hr({value:t});class gA extends v{constructor({value:A,outType:e,outKey:s}){super({a:A,outTypeFunc:()=>e,outKey:s}),this.statements=({inputs:n,outputs:i})=>[`${i[s]} = ${Ks(e)}(${n.a});`]}}class hr extends gA{constructor({value:A}){super({value:A,outType:"bool",outKey:"bool"})}}class Cr extends gA{constructor({value:A}){super({value:A,outType:"int",outKey:"int"})}}class Br extends gA{constructor({value:A}){super({value:A,outType:"uint",outKey:"uint"})}}class Er extends gA{constructor({value:A}){super({value:A,outType:"float",outKey:"float"})}}class Qr extends gA{constructor({value:A}){super({value:A,outType:"bvec2",outKey:"bvec2"})}}class pr extends gA{constructor({value:A}){super({value:A,outType:"bvec3",outKey:"bvec3"})}}class fr extends gA{constructor({value:A}){super({value:A,outType:"bvec4",outKey:"bvec4"})}}class dr extends gA{constructor({value:A}){super({value:A,outType:"ivec2",outKey:"ivec2"})}}class yr extends gA{constructor({value:A}){super({value:A,outType:"ivec3",outKey:"ivec3"})}}class mr extends gA{constructor({value:A}){super({value:A,outType:"ivec4",outKey:"ivec4"})}}class wr extends gA{constructor({value:A}){super({value:A,outType:"uvec2",outKey:"uvec2"})}}class xr extends gA{constructor({value:A}){super({value:A,outType:"uvec3",outKey:"uvec3"})}}class Sr extends gA{constructor({value:A}){super({value:A,outType:"uvec4",outKey:"uvec4"})}}class Dr extends gA{constructor({value:A}){super({value:A,outType:"vec2",outKey:"vec2"})}}class Mr extends gA{constructor({value:A}){super({value:A,outType:"vec3",outKey:"vec3"})}}class vr extends gA{constructor({value:A}){super({value:A,outType:"vec4",outKey:"vec4"})}}class br extends gA{constructor({value:A}){super({value:A,outType:"mat2",outKey:"mat2"})}}class Fr extends gA{constructor({value:A}){super({value:A,outType:"mat3",outKey:"mat3"})}}class Nr extends gA{constructor({value:A}){super({value:A,outType:"mat4",outKey:"mat4"})}}class Tr extends v{constructor({value:A}){super({a:A,outKey:"int",outTypeFunc:()=>"int"}),this.statements=({inputs:e,outputs:s})=>[`${s.int} = floatBitsToInt(${e.a});`]}}class kr extends v{constructor({value:A}){super({a:A,outKey:"uint",outTypeFunc:()=>"uint"}),this.statements=({inputs:e,outputs:s})=>[`${s.uint} = floatBitsToUint(${e.a});`]}}class Ur extends v{constructor({value:A}){super({a:A,outKey:"float",outTypeFunc:()=>"float"}),this.statements=({inputs:e,outputs:s})=>[`${s.float} = intBitsToFloat(${e.a});`]}}class Gr extends v{constructor({value:A}){super({a:A,outKey:"float",outTypeFunc:()=>"float"}),this.statements=({inputs:e,outputs:s})=>[`${s.float} = uintBitsToFloat(${e.a});`]}}class Rr extends v{constructor({value:A}){super({a:A,outKey:"uint",outTypeFunc:()=>"uint"}),this.statements=({inputs:e,outputs:s})=>[`${s.uint} = packSnorm2x16(${e.a});`]}}class Yr extends v{constructor({value:A}){super({a:A,outKey:"vec2",outTypeFunc:()=>"vec2"}),this.statements=({inputs:e,outputs:s})=>[`${s.vec2} = unpackSnorm2x16(${e.a});`]}}class Jr extends v{constructor({value:A}){super({a:A,outKey:"uint",outTypeFunc:()=>"uint"}),this.statements=({inputs:e,outputs:s})=>[`${s.uint} = packUnorm2x16(${e.a});`]}}class _r extends v{constructor({value:A}){super({a:A,outKey:"vec2",outTypeFunc:()=>"vec2"}),this.statements=({inputs:e,outputs:s})=>[`${s.vec2} = unpackUnorm2x16(${e.a});`]}}class Lr extends v{constructor({value:A}){super({a:A,outKey:"uint",outTypeFunc:()=>"uint"}),this.statements=({inputs:e,outputs:s})=>[`${s.uint} = packHalf2x16(${e.a});`]}}class zr extends v{constructor({value:A}){super({a:A,outKey:"vec2",outTypeFunc:()=>"vec2"}),this.statements=({inputs:e,outputs:s})=>[`${s.vec2} = unpackHalf2x16(${e.a});`]}}class Hr extends v{constructor({value:A}){super({a:A,outKey:"rgba8",outTypeFunc:()=>"vec4"}),this.statements=({inputs:e,outputs:s})=>[`uvec4 uRgba = uvec4(${e.a} & 0xffu, (${e.a} >> 8u) & 0xffu, (${e.a} >> 16u) & 0xffu, (${e.a} >> 24u) & 0xffu);`,`${s.rgba8} = vec4(uRgba) / 255.0;`]}}const Du=t=>new Pr({a:t}),Mu=(t,A)=>new Vr({a:t,b:A}),qr=(t,A)=>new Or({a:t,b:A}),vu=(t,A)=>new Xr({a:t,b:A}),Kr=t=>new Zr({a:t}),bu=(t,A,e)=>new Aa({a:t,b:A,c:e}),Fu=(t,A)=>new ta({incident:t,normal:A}),Nu=(t,A,e)=>new ea({incident:t,normal:A,eta:e}),pt=t=>new oa({vector:t}),PA=({vector:t,vectorType:A,x:e,y:s,z:n,w:i,r,g:a,b:o,a:g})=>new ca({vector:t,vectorType:A,x:e,y:s,z:n,w:i,r,g:a,b:o,a:g}),Tu=t=>new jr({a:t}),$r=(t,A)=>new Wr({a:t,b:A}),ku=(t,A)=>new ga({vector:t,select:A}),Uu=(t,A)=>new sa({a:t,b:A}),Gu=(t,A)=>new na({a:t,b:A}),Ru=t=>new ia({a:t}),Yu=t=>new ra({a:t}),Ju=t=>new aa({a:t});class Pr extends v{constructor({a:A}){super({a:A,outTypeFunc:e=>"float",outKey:"length"}),this.statements=({inputs:e,outputs:s})=>[`${s.length} = length(${e.a});`]}}class Vr extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"distance",outTypeFunc:(s,n)=>"float"}),this.statements=({inputs:s,outputs:n})=>[`${n.distance} = distance(${s.a}, ${s.b});`]}}class Or extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"dot",outTypeFunc:(s,n)=>"float"}),this.statements=({inputs:s,outputs:n})=>[`${n.dot} = dot(${s.a}, ${s.b});`]}}class Xr extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"cross",outTypeFunc:(s,n)=>"vec3"}),this.statements=({inputs:s,outputs:n})=>[`${n.cross} = cross(${s.a}, ${s.b});`]}}class Zr extends v{constructor({a:A}){super({a:A,outTypeFunc:e=>e,outKey:"normalize"}),this.statements=({inputs:e,outputs:s})=>[`${s.normalize} = normalize(${e.a});`]}}function _u(t){if(t==="vec3")return"vec2";if(t==="vec4")return"vec3";throw new Error("Invalid type")}class jr extends v{constructor({a:A}){super({a:A,outTypeFunc:e=>_u(e),outKey:"projected"}),this.statements=({inputs:e,outputs:s})=>{if(this.inTypes.a==="vec3")return[`${s.projected} = ${e.a}.xy / ${e.a}.z;`];if(this.inTypes.a==="vec4")return[`${s.projected} = ${e.a}.xyz / ${e.a}.w;`];throw new Error("Invalid type")}}}function Lu(t){if(t==="float")return"vec2";if(t==="vec2")return"vec3";if(t==="vec3")return"vec4";throw new Error("Invalid type")}class Wr extends tA{constructor({a:A,b:e}){const s=$(A),n=Lu(s);super({a:A,b:e,outKey:"extend",outTypeFunc:()=>n}),this.statements=({inputs:i,outputs:r})=>[`${r.extend} = ${n}(${i.a}, ${i.b});`]}}class Aa extends mt{constructor({a:A,b:e,c:s}){super({a:A,b:e,c:s,outKey:"forward",outTypeFunc:(n,i,r)=>n}),this.statements=({inputs:n,outputs:i})=>[`${i.forward} = faceforward(${n.a}, ${n.b}, ${n.c});`]}}class ta extends tA{constructor({incident:A,normal:e}){super({a:A,b:e,outKey:"reflection",outTypeFunc:(s,n)=>s}),this.statements=({inputs:s,outputs:n})=>[`${n.reflection} = reflect(${s.a}, ${s.b});`]}}class ea extends mt{constructor({incident:A,normal:e,eta:s}){super({a:A,b:e,c:s,outKey:"refraction",outTypeFunc:(n,i,r)=>n}),this.statements=({inputs:n,outputs:i})=>[`${i.refraction} = refract(${n.a}, ${n.b}, ${n.c});`]}}class sa extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"product",outTypeFunc:(s,n)=>s}),this.statements=({inputs:s,outputs:n})=>[`${n.product} = matrixCompMult(${A}, ${e});`]}}function zu(t,A){if(t==="vec2"){if(A==="vec2")return"mat2";if(A==="vec3")return"mat3x2";if(A==="vec4")return"mat4x2"}if(t==="vec3"){if(A==="vec2")return"mat2x3";if(A==="vec3")return"mat3";if(A==="vec4")return"mat4x3"}if(t==="vec4"){if(A==="vec2")return"mat2x4";if(A==="vec3")return"mat3x4";if(A==="vec4")return"mat4"}throw new Error(`Invalid outer type: ${t}, ${A}`)}class na extends tA{constructor({a:A,b:e}){super({a:A,b:e,outKey:"outer",outTypeFunc:zu}),this.statements=({inputs:s,outputs:n})=>[`${n.outer} = outerProduct(${s.a}, ${s.b});`]}}function Hu(t){if(t==="mat2")return"mat2";if(t==="mat3")return"mat3";if(t==="mat4")return"mat4";if(t==="mat2x2")return"mat2x2";if(t==="mat2x3")return"mat3x2";if(t==="mat2x4")return"mat4x2";if(t==="mat3x2")return"mat2x3";if(t==="mat3x3")return"mat3x3";if(t==="mat3x4")return"mat4x3";if(t==="mat4x2")return"mat2x4";if(t==="mat4x3")return"mat3x4";if(t==="mat4x4")return"mat4x4";throw new Error(`Invalid transpose type: ${t}`)}class ia extends v{constructor({a:A}){super({a:A,outKey:"transpose",outTypeFunc:Hu}),this.statements=({inputs:e,outputs:s})=>[`${s.transpose} = transpose(${e.a});`]}}class ra extends v{constructor({a:A}){super({a:A,outKey:"det",outTypeFunc:e=>"float"}),this.statements=({inputs:e,outputs:s})=>[`${s.det} = determinant(${e.a});`]}}class aa extends v{constructor({a:A}){super({a:A,outKey:"inverse",outTypeFunc:e=>e}),this.statements=({inputs:e,outputs:s})=>[`${s.inverse} = inverse(${A});`]}}function qu(t){const A=e=>e;switch(t){case"vec2":return A({x:"float",y:"float",r:"float",g:"float"});case"vec3":return A({x:"float",y:"float",z:"float",r:"float",g:"float",b:"float"});case"vec4":return A({x:"float",y:"float",z:"float",w:"float",r:"float",g:"float",b:"float",a:"float"});case"ivec2":return A({x:"int",y:"int",r:"int",g:"int"});case"ivec3":return A({x:"int",y:"int",z:"int",r:"int",g:"int",b:"int"});case"ivec4":return A({x:"int",y:"int",z:"int",w:"int",r:"int",g:"int",b:"int",a:"int"});case"uvec2":return A({x:"uint",y:"uint",r:"uint",g:"uint"});case"uvec3":return A({x:"uint",y:"uint",z:"uint",r:"uint",g:"uint",b:"uint"});case"uvec4":return A({x:"uint",y:"uint",z:"uint",w:"uint",r:"uint",g:"uint",b:"uint",a:"uint"});default:throw new Error(`Invalid vector type: ${t}`)}}class oa extends P{constructor({vector:A}){const s={vector:$(A)},n=qu(s.vector);super({inTypes:s,outTypes:n,inputs:{vector:A}}),this.statements=({inputs:i,outputs:r})=>{const{x:a,y:o,z:g,w:l,r:c,g:u,b:h,a:E}=r,{vector:C}=i;return[a?`${a} = ${C}.x;`:null,o?`${o} = ${C}.y;`:null,g?`${g} = ${C}.z;`:null,l?`${l} = ${C}.w;`:null,c?`${c} = ${C}.r;`:null,u?`${u} = ${C}.g;`:null,h?`${h} = ${C}.b;`:null,E?`${E} = ${C}.a;`:null].filter(Boolean)}}}class ca extends P{constructor({vector:A,vectorType:e,x:s,y:n,z:i,w:r,r:a,g:o,b:g,a:l}){if(!A&&!e)throw new Error("Either vector or vectorType must be provided");const c=e??$(A),u=zs(c),h=Hs(c),E={vector:c,x:u,y:u,r:u,g:u},C={vector:A,x:s,y:n,r:a,g:o};h>=3&&(Object.assign(E,{z:u,b:u}),Object.assign(C,{z:i,b:g})),h>=4&&(Object.assign(E,{w:u,a:u}),Object.assign(C,{w:r,a:l})),super({inTypes:E,outTypes:{vector:c},inputs:C}),this.statements=({inputs:B,outputs:Q})=>{const{vector:f}=Q,{vector:p,x:d,y,z:D,w:x,r:m,g:w,b:T,a:M}=B,S=[`${f}.x = ${d??m??(p?`${p}.x`:Lt(u))};`,`${f}.y = ${y??w??(p?`${p}.y`:Lt(u))};`];return h>=3&&S.push(`${f}.z = ${D??T??(p?`${p}.z`:Lt(u))};`),h>=4&&S.push(`${f}.w = ${x??M??(p?`${p}.w`:Lt(u))};`),S}}dynoOut(){return new K(this,"vector")}}function Ku(t,A){let e=null;if(ee(t)?e=A.length===1?"float":A.length===2?"vec2":A.length===3?"vec3":A.length===4?"vec4":null:QA(t)?e=A.length===1?"int":A.length===2?"ivec2":A.length===3?"ivec3":A.length===4?"ivec4":null:pA(t)&&(e=A.length===1?"uint":A.length===2?"uvec2":A.length===3?"uvec3":A.length===4?"uvec4":null),e==null)throw new Error(`Invalid swizzle: ${A}`);return e}class ga extends v{constructor({vector:A,select:e}){super({a:A,outKey:"swizzle",outTypeFunc:s=>Ku(s,e)}),this.statements=({inputs:s,outputs:n})=>[`${n.swizzle} = ${s.a}.${e};`]}}const $u=(t,A,e)=>new Ea({index:t,from:A,to:e}),Pu=t=>new Rt({value:t}),Vu=t=>new GA({state:t}),Ou=t=>new RA({state:t}),la=t=>new Qa({value:t}),ua=t=>new pa({value:t}),Ia=t=>new fa({value:t}),ha=t=>new da({value:t}),Xu=t=>new ya({value:t}),Zu=t=>new ma({value:t}),Ca=t=>new wa({value:t}),Pe=t=>new xa({value:t}),Ba=(t,A,e)=>new Sa({z:t,zNear:A,zFar:e}).outputs.depth;class Ea extends P{constructor({from:A,to:e,index:s}){super({inTypes:{from:"int",to:"int",index:"int"},outTypes:{index:"int"},inputs:{from:A,to:e,index:s},statements:({inputs:n,outputs:i})=>[`${i.index} = ${n.index} - ${n.from} + ${n.to};`]})}dynoOut(){return new K(this,"index")}}class GA extends P{constructor({state:A}){const e=$(A);super({inTypes:{state:e},outTypes:{state:"uint"},inputs:{state:A},globals:()=>[CA(`
          uint pcg_next(uint state) {
            return state * 747796405u + 2891336453u;
          }
        `)],statements:({inputs:s,outputs:n})=>{const i=e==="uint"?`${s.state}`:e==="int"?`uint(${s.state})`:`floatBitsToUint(${s.state})`;return[`${n.state} = pcg_next(${i});`]}})}dynoOut(){return new K(this,"state")}}class RA extends P{constructor({state:A}){super({inTypes:{state:"uint"},outTypes:{hash:"uint"},inputs:{state:A},globals:()=>[CA(`
          uint pcg_hash(uint state) {
            uint hash = ((state >> ((state >> 28u) + 4u)) ^ state) * 277803737u;
            return (hash >> 22u) ^ hash;
          }
        `)],statements:({inputs:e,outputs:s})=>[`${s.hash} = pcg_hash(${e.state});`]})}dynoOut(){return new K(this,"hash")}}class Rt extends P{constructor({value:A}){const e=$(A),s=qs(e);super({inTypes:{value:e},outTypes:{state:"uint"},inputs:{value:A},globals:()=>[CA(`
          uint pcg_mix(uint value) {
            return value;
          }
          uint pcg_mix(uvec2 value) {
            return value.x + 0x9e3779b9u * value.y;
          }
          uint pcg_mix(uvec3 value) {
            return value.x + 0x9e3779b9u * value.y + 0x85ebca6bu * value.z;
          }
          uint pcg_mix(uvec4 value) {
            return value.x + 0x9e3779b9u * value.y + 0x85ebca6bu * value.z + 0xc2b2ae35u * value.w;
          }
        `)],statements:({inputs:n,outputs:i})=>{const r=pA(e)?`${n.value}`:QA(e)?`${s}(${n.value})`:`floatBitsToUint(${n.value})`;return[`${s} bits = ${r};`,`${i.state} = pcg_mix(bits);`]}})}dynoOut(){return new K(this,"state")}}class Qa extends VA{constructor({value:A}){super({inTypes:{value:$(A)},outTypes:{hash:"uint"},inputs:{value:A},construct:({value:e})=>{if(!e)throw new Error("value is required");let s=new Rt({value:e}).outputs.state;return s=new GA({state:s}).outputs.state,new RA({state:s}).outputs}})}dynoOut(){return new K(this,"hash")}}class pa extends VA{constructor({value:A}){super({inTypes:{value:$(A)},outTypes:{hash:"uvec2"},inputs:{value:A},construct:({value:e})=>{if(!e)throw new Error("value is required");let s=new Rt({value:e}).outputs.state;s=new GA({state:s}).outputs.state;const n=new RA({state:s}).outputs.hash;s=new GA({state:s}).outputs.state;const i=new RA({state:s}).outputs.hash;return{hash:PA({vectorType:"uvec2",x:n,y:i})}}})}dynoOut(){return new K(this,"hash")}}class fa extends VA{constructor({value:A}){super({inTypes:{value:$(A)},outTypes:{hash:"uvec3"},inputs:{value:A},construct:({value:e})=>{if(!e)throw new Error("value is required");let s=new Rt({value:e}).outputs.state;s=new GA({state:s}).outputs.state;const n=new RA({state:s}).outputs.hash;s=new GA({state:s}).outputs.state;const i=new RA({state:s}).outputs.hash;s=new GA({state:s}).outputs.state;const r=new RA({state:s}).outputs.hash;return{hash:PA({vectorType:"uvec3",x:n,y:i,z:r})}}})}dynoOut(){return new K(this,"hash")}}class da extends VA{constructor({value:A}){super({inTypes:{value:$(A)},outTypes:{hash:"uvec4"},inputs:{value:A},construct:({value:e})=>{if(!e)throw new Error("value is required");let s=new Rt({value:e}).outputs.state;s=new GA({state:s}).outputs.state;const n=new RA({state:s}).outputs.hash;s=new GA({state:s}).outputs.state;const i=new RA({state:s}).outputs.hash;s=new GA({state:s}).outputs.state;const r=new RA({state:s}).outputs.hash;s=new GA({state:s}).outputs.state;const a=new RA({state:s}).outputs.hash;return{hash:PA({vectorType:"uvec4",x:n,y:i,z:r,w:a})}}})}dynoOut(){return new K(this,"hash")}}class ya extends VA{constructor({value:A}){super({inTypes:{value:$(A)},outTypes:{hash:"float"},inputs:{value:A},construct:({value:e})=>{if(!e)throw new Error("value is required");const s=la(e);return{hash:rA(or(s),J("float",1/2**32))}}})}dynoOut(){return new K(this,"hash")}}class ma extends VA{constructor({value:A}){super({inTypes:{value:$(A)},outTypes:{hash:"vec2"},inputs:{value:A},construct:({value:e})=>{if(!e)throw new Error("value is required");const s=ua(e);return{hash:rA(cr(s),J("float",1/2**32))}}})}dynoOut(){return new K(this,"hash")}}class wa extends VA{constructor({value:A}){super({inTypes:{value:$(A)},outTypes:{hash:"vec3"},inputs:{value:A},construct:({value:e})=>{if(!e)throw new Error("value is required");const s=Ia(e);return{hash:rA(Qt(s),J("float",1/2**32))}}})}dynoOut(){return new K(this,"hash")}}class xa extends VA{constructor({value:A}){super({inTypes:{value:$(A)},outTypes:{hash:"vec4"},inputs:{value:A},construct:({value:e})=>{if(!e)throw new Error("value is required");const s=ha(e);return{hash:rA(gr(s),J("float",1/2**32))}}})}dynoOut(){return new K(this,"hash")}}class Sa extends P{constructor({z:A,zNear:e,zFar:s}){super({inTypes:{z:"float",zNear:"float",zFar:"float"},outTypes:{depth:"float"},inputs:{z:A,zNear:e,zFar:s},statements:({inputs:n,outputs:i})=>[`float clamped = clamp(${n.z}, ${n.zNear}, ${n.zFar});`,`${i.depth} = (log2(clamped + 1.0) - log2(${n.zNear} + 1.0)) / (log2(${n.zFar} + 1.0) - log2(${n.zNear} + 1.0));`]})}dynoOut(){return new K(this,"depth")}}const Da=(t,{scale:A,scales:e,rotate:s,translate:n})=>new va({position:t,scale:A,scales:e,rotate:s,translate:n}).outputs.position,Ma=(t,{scale:A,scales:e,rotate:s})=>new ba({dir:t,scale:A,scales:e,rotate:s}).outputs.dir,ju=(t,{rotate:A})=>new Fa({quaternion:t,rotate:A}).outputs.quaternion;class va extends P{constructor({position:A,scale:e,scales:s,rotate:n,translate:i}){super({inTypes:{position:"vec3",scale:"float",scales:"vec3",rotate:"vec4",translate:"vec3"},outTypes:{position:"vec3"},inputs:{position:A,scale:e,scales:s,rotate:n,translate:i},statements:({inputs:r,outputs:a})=>{const{position:o}=a;if(!o)return[];const{scale:g,scales:l,rotate:c,translate:u}=r;return[`${o} = ${r.position??"vec3(0.0, 0.0, 0.0)"};`,g?`${o} *= ${g};`:null,l?`${o} *= ${l};`:null,c?`${o} = quatVec(${c}, ${o});`:null,u?`${o} += ${u};`:null].filter(Boolean)}})}}class ba extends P{constructor({dir:A,scale:e,scales:s,rotate:n}){super({inTypes:{dir:"vec3",scale:"float",scales:"vec3",rotate:"vec4"},outTypes:{dir:"vec3"},inputs:{dir:A,scale:e,scales:s,rotate:n},statements:({inputs:i,outputs:r})=>{const{dir:a}=r;if(!a)return[];const{scale:o,scales:g,rotate:l}=i;return[`${a} = ${i.dir??"vec3(0.0, 0.0, 0.0)"};`,o?`${a} *= ${o};`:null,g?`${a} *= ${g};`:null,l?`${a} = quatVec(${l}, ${a});`:null].filter(Boolean)}})}}class Fa extends P{constructor({quaternion:A,rotate:e}){super({inTypes:{quaternion:"vec4",rotate:"vec4"},outTypes:{quaternion:"vec4"},inputs:{quaternion:A,rotate:e},statements:({inputs:s,outputs:n})=>{const{quaternion:i}=n;return i?[`${i} = ${s.quaternion??"vec4(0.0, 0.0, 0.0, 1.0)"};`,e?`${i} = quatQuat(${s.rotate}, ${i});`:null].filter(Boolean):[]}})}}const Wu=()=>{throw new Error("Not implemented")},AI=()=>{throw new Error("Not implemented")},tI=()=>{throw new Error("Not implemented")},eI=()=>{throw new Error("Not implemented")},sI=()=>{throw new Error("Not implemented")},nI=()=>{throw new Error("Not implemented")},iI=(t,A)=>new Na({texture:t,lod:A}),rI=(t,A,e)=>new Ta({texture:t,coord:A,bias:e}),aI=(t,A,e)=>new ka({texture:t,coord:A,lod:e});class Na extends P{constructor({texture:A,lod:e}){const s=$(A);super({inTypes:{texture:s,lod:"int"},outTypes:{size:Ua(s)},inputs:{texture:A,lod:e},statements:({inputs:n,outputs:i})=>[`${i.size} = textureSize(${n.texture}, ${n.lod??"0"});`]})}dynoOut(){return new K(this,"size")}}class Ta extends P{constructor({texture:A,coord:e,bias:s}){const n=$(A);super({inTypes:{texture:n,coord:oI(n),bias:"float"},outTypes:{sample:Ga(n)},inputs:{texture:A,coord:e,bias:s},statements:({inputs:i,outputs:r})=>[`${r.sample} = texture(${i.texture}, ${i.coord}${i.bias?`, ${i.bias}`:""});`]})}dynoOut(){return new K(this,"sample")}}class ka extends P{constructor({texture:A,coord:e,lod:s}){const n=$(A);super({inTypes:{texture:n,coord:Ua(n),lod:"int"},outTypes:{texel:Ga(n)},inputs:{texture:A,coord:e,lod:s},statements:({inputs:i,outputs:r})=>[`${r.texel} = texelFetch(${i.texture}, ${i.coord}, ${i.lod??"0"});`]})}dynoOut(){return new K(this,"texel")}}function Ua(t){switch(t){case"sampler2D":case"usampler2D":case"isampler2D":case"samplerCube":case"usamplerCube":case"isamplerCube":case"sampler2DShadow":case"samplerCubeShadow":return"ivec2";case"sampler3D":case"usampler3D":case"isampler3D":case"sampler2DArray":case"usampler2DArray":case"isampler2DArray":case"sampler2DArrayShadow":return"ivec3";default:throw new Error(`Invalid texture type: ${t}`)}}function oI(t){switch(t){case"sampler2D":case"usampler2D":case"isampler2D":return"vec2";case"sampler3D":case"usampler3D":case"isampler3D":case"samplerCube":case"usamplerCube":case"isamplerCube":case"sampler2DArray":case"usampler2DArray":case"isampler2DArray":case"sampler2DShadow":return"vec3";case"samplerCubeShadow":case"sampler2DArrayShadow":return"vec4";default:throw new Error(`Invalid texture type: ${t}`)}}function Ga(t){switch(t){case"sampler2D":case"sampler2DArray":case"sampler3D":case"samplerCube":case"sampler2DShadow":return"vec4";case"usampler2D":case"usampler2DArray":case"usampler3D":case"usamplerCube":return"uvec4";case"isampler2D":case"isampler2DArray":case"isampler3D":case"isamplerCube":return"ivec4";case"samplerCubeShadow":case"sampler2DArrayShadow":return"float";default:throw new Error(`Invalid texture type: ${t}`)}}const cI=t=>new Ra({degrees:t}),gI=t=>new Ya({radians:t}),Ve=t=>new Ja({radians:t}),lI=t=>new _a({radians:t}),uI=t=>new La({radians:t}),II=t=>new za({sin:t}),hI=t=>new Ha({cos:t}),CI=t=>new qa({tan:t}),BI=(t,A)=>new Ka({y:t,x:A}),EI=t=>new $a({x:t}),QI=t=>new Pa({x:t}),pI=t=>new Va({x:t}),fI=t=>new Oa({x:t}),dI=t=>new Xa({x:t}),yI=t=>new Za({x:t});class Ra extends v{constructor({degrees:A}){super({a:A,outTypeFunc:e=>e,outKey:"radians"}),this.statements=({inputs:e,outputs:s})=>[`${s.radians} = radians(${e.a});`]}}class Ya extends v{constructor({radians:A}){super({a:A,outTypeFunc:e=>e,outKey:"degrees"}),this.statements=({inputs:e,outputs:s})=>[`${s.degrees} = degrees(${e.a});`]}}class Ja extends v{constructor({radians:A}){super({a:A,outTypeFunc:e=>e,outKey:"sin"}),this.statements=({inputs:e,outputs:s})=>[`${s.sin} = sin(${e.a});`]}}class _a extends v{constructor({radians:A}){super({a:A,outTypeFunc:e=>e,outKey:"cos"}),this.statements=({inputs:e,outputs:s})=>[`${s.cos} = cos(${e.a});`]}}class La extends v{constructor({radians:A}){super({a:A,outTypeFunc:e=>e,outKey:"tan"}),this.statements=({inputs:e,outputs:s})=>[`${s.tan} = tan(${e.a});`]}}class za extends v{constructor({sin:A}){super({a:A,outTypeFunc:e=>e,outKey:"asin"}),this.statements=({inputs:e,outputs:s})=>[`${s.asin} = asin(${e.a});`]}}class Ha extends v{constructor({cos:A}){super({a:A,outTypeFunc:e=>e,outKey:"acos"}),this.statements=({inputs:e,outputs:s})=>[`${s.acos} = acos(${e.a});`]}}class qa extends v{constructor({tan:A}){super({a:A,outTypeFunc:e=>e,outKey:"atan"}),this.statements=({inputs:e,outputs:s})=>[`${s.atan} = atan(${e.a});`]}}class Ka extends tA{constructor({y:A,x:e}){super({a:A,b:e,outTypeFunc:(s,n)=>s,outKey:"atan2"}),this.statements=({inputs:s,outputs:n})=>[`${n.atan2} = atan2(${s.a}, ${s.b});`]}}class $a extends v{constructor({x:A}){super({a:A,outTypeFunc:e=>e,outKey:"sinh"}),this.statements=({inputs:e,outputs:s})=>[`${s.sinh} = sinh(${e.a});`]}}class Pa extends v{constructor({x:A}){super({a:A,outTypeFunc:e=>e,outKey:"cosh"}),this.statements=({inputs:e,outputs:s})=>[`${s.cosh} = cosh(${e.a});`]}}class Va extends v{constructor({x:A}){super({a:A,outTypeFunc:e=>e,outKey:"tanh"}),this.statements=({inputs:e,outputs:s})=>[`${s.tanh} = tanh(${e.a});`]}}class Oa extends v{constructor({x:A}){super({a:A,outTypeFunc:e=>e,outKey:"asinh"}),this.statements=({inputs:e,outputs:s})=>[`${s.asinh} = asinh(${e.a});`]}}class Xa extends v{constructor({x:A}){super({a:A,outTypeFunc:e=>e,outKey:"acosh"}),this.statements=({inputs:e,outputs:s})=>[`${s.acosh} = acosh(${e.a});`]}}class Za extends v{constructor({x:A}){super({a:A,outTypeFunc:e=>e,outKey:"atanh"}),this.statements=({inputs:e,outputs:s})=>[`${s.atanh} = atanh(${e.a});`]}}const mI=Object.freeze(Object.defineProperty({__proto__:null,Abs:mi,Acos:Ha,Acosh:Xa,Add:Ci,All:nr,And:Pi,Any:sr,Asin:za,Asinh:Oa,Atan:qa,Atan2:Ka,Atanh:Za,BVec2:Qr,BVec3:pr,BVec4:fr,BinaryOp:tA,Bool:hr,Ceil:Si,Clamp:_i,Combine:ca,CombineGsplat:An,CompMult:sa,CompXor:ar,Compilation:Ps,Cos:_a,Cosh:Pa,Cross:Xr,Degrees:Ya,Determinant:ra,Distance:Vr,Div:Qi,Dot:Or,Dyno:P,DynoBlock:VA,DynoBool:Ce,DynoBvec2:on,DynoBvec3:ln,DynoBvec4:hn,DynoConst:$s,DynoFloat:Et,DynoInt:Ot,DynoIsampler2D:bn,DynoIsampler2DArray:Nn,DynoIsampler3D:Un,DynoIsamplerCube:Yn,DynoIvec2:gn,DynoIvec3:In,DynoIvec4:Bn,DynoLiteral:bt,DynoMat2:En,DynoMat2x2:Qn,DynoMat2x3:pn,DynoMat2x4:fn,DynoMat3:dn,DynoMat3x2:yn,DynoMat3x3:mn,DynoMat3x4:wn,DynoMat4:xn,DynoMat4x2:Sn,DynoMat4x3:Dn,DynoMat4x4:Mn,DynoOutput:K,DynoProgram:is,DynoProgramTemplate:rs,DynoRemapIndex:Ea,DynoSampler2D:Fn,DynoSampler2DArray:Tn,DynoSampler2DArrayShadow:Ln,DynoSampler2DShadow:_n,DynoSampler3D:Gn,DynoSamplerCube:Jn,DynoSamplerCubeShadow:zn,DynoUint:an,DynoUniform:N,DynoUsampler2D:vn,DynoUsampler2DArray:Kt,DynoUsampler3D:kn,DynoUsamplerCube:Rn,DynoUvec2:cn,DynoUvec3:un,DynoUvec4:Cn,DynoValue:it,DynoVec2:qt,DynoVec3:Nt,DynoVec4:Gt,Equal:tr,Exp:Fi,Exp2:Ni,ExtendVec:Wr,FaceForward:Aa,Float:Er,FloatBitsToInt:Tr,FloatBitsToUint:kr,Floor:xi,Fract:vi,GreaterThan:Wi,GreaterThanEqual:Ar,Gsplat:AA,GsplatNormal:en,Hash:Qa,Hash2:pa,Hash3:fa,Hash4:da,HashFloat:ya,HashVec2:ma,HashVec3:wa,HashVec4:xa,IMod:pi,IVec2:dr,IVec3:yr,IVec4:mr,Int:Cr,IntBitsToFloat:Ur,Inverse:aa,InverseSqrt:Ri,IsInf:Ki,IsNan:qi,Length:Pr,LessThan:Zi,LessThanEqual:ji,Log:Ti,Log2:ki,Mat2:br,Mat3:Fr,Mat4:Nr,Max:Ji,Min:Yi,Mix:Li,Mod:fi,Modf:di,Mul:Ei,Neg:yi,Normalize:Zr,NormalizedDepth:Sa,Not:Xi,NotEqual:er,NumPackedSplats:Os,Or:Vi,Outer:na,OutputPackedSplat:rn,OutputRgba8:es,PackHalf2x16:Lr,PackSnorm2x16:Rr,PackUnorm2x16:Jr,PcgHash:RA,PcgMix:Rt,PcgNext:GA,Pow:bi,ProjectH:jr,Radians:Ra,ReadPackedSplat:Zs,ReadPackedSplatRange:js,ReflectVec:ta,RefractVec:ea,Round:Mi,Select:ir,Sign:wi,SimpleCast:gA,Sin:Ja,Sinh:$a,Smoothstep:Hi,Split:oa,SplitGsplat:Ws,Sqr:Ui,Sqrt:Gi,Step:zi,Sub:Bi,Swizzle:ga,TPackedSplats:ie,Tan:La,Tanh:Va,TexelFetch:ka,Texture:Ta,TextureSize:Na,TransformDir:ba,TransformGsplat:sn,TransformPosition:va,TransformQuaternion:Fa,Transpose:ia,TrinaryOp:mt,Trunc:Di,UVec2:wr,UVec3:xr,UVec4:Sr,Uint:Br,UintBitsToFloat:Gr,UintToRgba8:Hr,UnaryOp:v,UnpackHalf2x16:zr,UnpackSnorm2x16:Yr,UnpackUnorm2x16:_r,Vec2:Dr,Vec3:Mr,Vec4:vr,Xor:Oi,abs:xl,acos:hI,acosh:dI,add:EA,all:tu,and:Kl,any:Au,arrayIndex:sI,arrayLength:nI,asin:II,asinh:fI,atan:CI,atan2:BI,atanh:yI,bool:iu,bvec2:ou,bvec3:cu,bvec4:gu,ceil:Ml,clamp:_l,combine:PA,combineGsplat:rt,comment:eI,compMult:Uu,compXor:eu,cos:lI,cosh:QI,cross:vu,defineGsplat:NA,defineGsplatNormal:tn,definePackedSplats:we,degrees:gI,determinant:Yu,distance:Mu,div:le,dot:qr,dyno:ne,dynoBlock:FA,dynoBool:Mc,dynoBvec2:Fc,dynoBvec3:Uc,dynoBvec4:Yc,dynoConst:J,dynoDeclare:As,dynoFloat:qA,dynoFor:tI,dynoIf:Wu,dynoInt:bc,dynoIsampler2D:tg,dynoIsampler2DArray:ng,dynoIsampler3D:ag,dynoIsamplerCube:gg,dynoIvec2:Tc,dynoIvec3:Rc,dynoIvec4:_c,dynoLiteral:he,dynoMat2:zc,dynoMat2x2:Hc,dynoMat2x3:qc,dynoMat2x4:Kc,dynoMat3:$c,dynoMat3x2:Pc,dynoMat3x3:Vc,dynoMat3x4:Oc,dynoMat4:Xc,dynoMat4x2:Zc,dynoMat4x3:jc,dynoMat4x4:Wc,dynoSampler2D:eg,dynoSampler2DArray:ig,dynoSampler2DArrayShadow:Ig,dynoSampler2DShadow:ug,dynoSampler3D:og,dynoSamplerCube:lg,dynoSamplerCubeShadow:hg,dynoSwitch:AI,dynoUint:vc,dynoUsampler2D:Ag,dynoUsampler2DArray:sg,dynoUsampler3D:rg,dynoUsamplerCube:cg,dynoUvec2:Nc,dynoUvec3:Gc,dynoUvec4:Jc,dynoVec2:kc,dynoVec3:et,dynoVec4:Lc,equal:jl,exp:Nl,exp2:Tl,extendVec:$r,faceforward:bu,float:or,floatBitsToInt:lr,floatBitsToUint:ur,floor:Dl,fract:ue,greaterThan:Zl,greaterThanEqual:$i,gsplatNormal:He,hash:la,hash2:ua,hash3:Ia,hash4:ha,hashFloat:Xu,hashVec2:Zu,hashVec3:Ca,hashVec4:Pe,imod:Ke,int:ru,intBitsToFloat:fu,inverse:Ju,inversesqrt:Yl,isAllFloatType:ot,isBoolType:dt,isFloatType:ee,isInf:ql,isIntType:QA,isMat2:gt,isMat3:lt,isMat4:ut,isMatFloatType:Ls,isNan:Hl,isScalarType:yt,isUintType:pA,isVector2Type:kt,isVector3Type:Ut,isVector4Type:se,isVectorType:fc,ivec2:lu,ivec3:uu,ivec4:Iu,length:Du,lessThan:Ol,lessThanEqual:Xl,literalNegOne:wc,literalOne:mc,literalZero:Lt,log:kl,log2:Ul,mat2:Eu,mat3:Qu,mat4:pu,max:Ii,min:Jl,mix:hi,mod:ui,modf:wl,mul:rA,neg:os,normalize:Kr,normalizedDepth:Ba,not:Vl,notEqual:Wl,numPackedSplats:xc,numberAsFloat:H,numberAsInt:aA,numberAsUint:oA,or:$l,outer:Gu,outputPackedSplat:nn,outputRgba8:Sc,packHalf2x16:Ir,packSnorm2x16:yu,packUnorm2x16:wu,pcgHash:Ou,pcgMix:Pu,pcgNext:Vu,pow:Fl,projectH:Tu,radians:cI,readPackedSplat:Ft,readPackedSplatRange:Vs,reflectVec:Fu,refractVec:Nu,remapIndex:$u,round:bl,sameSizeIvec:yc,sameSizeUvec:qs,sameSizeVec:dc,select:cs,sign:Sl,sin:Ve,sinh:EI,smoothstep:zl,split:pt,splitGsplat:Bt,sqr:Gl,sqrt:Rl,step:Ll,sub:ft,swizzle:ku,tan:uI,tanh:pI,texelFetch:aI,texture:rI,textureSize:iI,transformDir:Ma,transformGsplat:ts,transformPos:Da,transformQuat:ju,transpose:Ru,trunc:vl,typeLiteral:Ks,uint:au,uintBitsToFloat:du,uintToRgba8:$e,uniform:Dc,unindent:CA,unindentLines:YA,unpackHalf2x16:Su,unpackSnorm2x16:mu,unpackUnorm2x16:xu,uvec2:hu,uvec3:Cu,uvec4:Bu,valType:$,vec2:cr,vec3:Qt,vec4:gr,vectorDim:Hs,vectorElementType:zs,xor:Pl},Symbol.toStringTag,{value:"Module"}));var wI=`precision highp float;\r
precision highp int;\r
precision highp sampler2D;\r
precision highp usampler2D;\r
precision highp isampler2D;\r
precision highp sampler2DArray;\r
precision highp usampler2DArray;\r
precision highp isampler2DArray;\r
precision highp sampler3D;\r
precision highp usampler3D;\r
precision highp isampler3D;

#include <splatDefines>

uniform uint targetLayer;\r
uniform int targetBase;\r
uniform int targetCount;

out uvec4 target;

{{ GLOBALS }}

void produceSplat(int index) {\r
    {{ STATEMENTS }}\r
}

void main() {\r
    int targetIndex = int(targetLayer << SPLAT_TEX_LAYER_BITS) + int(uint(gl_FragCoord.y) << SPLAT_TEX_WIDTH_BITS) + int(gl_FragCoord.x);\r
    int index = targetIndex - targetBase;

    if ((index >= 0) && (index < targetCount)) {\r
        produceSplat(index);\r
    } else {\r
        target = uvec4(0u, 0u, 0u, 0u);\r
    }\r
}`,xI=`precision highp float;\r
precision highp int;\r
precision highp sampler2D;\r
precision highp usampler2D;\r
precision highp isampler2D;\r
precision highp sampler2DArray;\r
precision highp usampler2DArray;\r
precision highp isampler2DArray;\r
precision highp sampler3D;\r
precision highp usampler3D;\r
precision highp isampler3D;

#include <splatDefines>

uniform uint targetLayer;\r
uniform int targetBase;\r
uniform int targetCount;

out vec4 target;

{{ GLOBALS }}

void computeReadback(int index) {\r
    {{ STATEMENTS }}\r
}

void main() {\r
    int targetIndex = int(targetLayer << SPLAT_TEX_LAYER_BITS) + int(uint(gl_FragCoord.y) << SPLAT_TEX_WIDTH_BITS) + int(gl_FragCoord.x);\r
    int index = targetIndex - targetBase;

    if ((index >= 0) && (index < targetCount)) {\r
        computeReadback(index);\r
    } else {\r
        target = vec4(0.0, 0.0, 0.0, 0.0);\r
    }\r
}`,SI=`const float LN_SCALE_MIN = -12.0;\r
const float LN_SCALE_MAX = 9.0;

const uint SPLAT_TEX_WIDTH_BITS = 11u;\r
const uint SPLAT_TEX_HEIGHT_BITS = 11u;\r
const uint SPLAT_TEX_DEPTH_BITS = 11u;\r
const uint SPLAT_TEX_LAYER_BITS = SPLAT_TEX_WIDTH_BITS + SPLAT_TEX_HEIGHT_BITS;

const uint SPLAT_TEX_WIDTH = 1u << SPLAT_TEX_WIDTH_BITS;\r
const uint SPLAT_TEX_HEIGHT = 1u << SPLAT_TEX_HEIGHT_BITS;\r
const uint SPLAT_TEX_DEPTH = 1u << SPLAT_TEX_DEPTH_BITS;

const uint SPLAT_TEX_WIDTH_MASK = SPLAT_TEX_WIDTH - 1u;\r
const uint SPLAT_TEX_HEIGHT_MASK = SPLAT_TEX_HEIGHT - 1u;\r
const uint SPLAT_TEX_DEPTH_MASK = SPLAT_TEX_DEPTH - 1u;

const uint F16_INF = 0x7c00u;\r
const float PI = 3.1415926535897932384626433832795;

const float INFINITY = 1.0 / 0.0;\r
const float NEG_INFINITY = -INFINITY;

float sqr(float x) {\r
    return x * x;\r
}

float pow4(float x) {\r
    float x2 = x * x;\r
    return x2 * x2;\r
}

float pow8(float x) {\r
    float x4 = pow4(x);\r
    return x4 * x4;\r
}

vec3 srgbToLinear(vec3 rgb) {\r
    return pow(rgb, vec3(2.2));\r
}

vec3 linearToSrgb(vec3 rgb) {\r
    return pow(rgb, vec3(1.0 / 2.2));\r
}

uint encodeQuatOctXy88R8(vec4 q) {\r
    
    if (q.w < 0.0) {\r
        q = -q;\r
    }\r
    
    float theta = 2.0 * acos(q.w);\r
    float halfTheta = theta * 0.5;\r
    float s = sin(halfTheta);\r
    
    vec3 axis = (abs(s) < 1e-6) ? vec3(1.0, 0.0, 0.0) : q.xyz / s;\r
    \r
    
    
    float sum = abs(axis.x) + abs(axis.y) + abs(axis.z);\r
    vec2 p = vec2(axis.x, axis.y) / sum;\r
    
    if (axis.z < 0.0) {\r
        float oldPx = p.x;\r
        p.x = (1.0 - abs(p.y)) * (p.x >= 0.0 ? 1.0 : -1.0);\r
        p.y = (1.0 - abs(oldPx)) * (p.y >= 0.0 ? 1.0 : -1.0);\r
    }\r
    
    float u_f = p.x * 0.5 + 0.5;\r
    float v_f = p.y * 0.5 + 0.5;\r
    
    uint quantU = uint(clamp(round(u_f * 255.0), 0.0, 255.0));\r
    uint quantV = uint(clamp(round(v_f * 255.0), 0.0, 255.0));\r
    \r
    
    
    uint angleInt = uint(clamp(round((theta / 3.14159265359) * 255.0), 0.0, 255.0));\r
    \r
    
    return (angleInt << 16u) | (quantV << 8u) | quantU;\r
}

vec4 decodeQuatOctXy88R8(uint encoded) {\r
    
    uint quantU = encoded & uint(0xFFu);               
    uint quantV = (encoded >> 8u) & uint(0xFFu);         
    uint angleInt = encoded >> 16u;                      

    
    float u_f = float(quantU) / 255.0;\r
    float v_f = float(quantV) / 255.0;\r
    vec2 f = vec2(u_f * 2.0 - 1.0, v_f * 2.0 - 1.0);

    vec3 axis = vec3(f.xy, 1.0 - abs(f.x) - abs(f.y));\r
    float t = max(-axis.z, 0.0);\r
    axis.x += (axis.x >= 0.0) ? -t : t;\r
    axis.y += (axis.y >= 0.0) ? -t : t;\r
    axis = normalize(axis);\r
    \r
    
    float theta = (float(angleInt) / 255.0) * 3.14159265359;\r
    float halfTheta = theta * 0.5;\r
    float s = sin(halfTheta);\r
    float w = cos(halfTheta);\r
    \r
    return vec4(axis * s, w);\r
}

    

    

    

    

    

    

    

    

    

    

uvec4 packSplatEncoding(\r
    vec3 center, vec3 scales, vec4 quaternion, vec4 rgba, vec4 rgbMinMaxLnScaleMinMax\r
) {\r
    float rgbMin = rgbMinMaxLnScaleMinMax.x;\r
    float rgbMax = rgbMinMaxLnScaleMinMax.y;\r
    vec3 encRgb = (rgba.rgb - vec3(rgbMin)) / (rgbMax - rgbMin);\r
    uvec4 uRgba = uvec4(round(clamp(vec4(encRgb, rgba.a) * 255.0, 0.0, 255.0)));

    uint uQuat = encodeQuatOctXy88R8(quaternion);\r
    
    
    uvec3 uQuat3 = uvec3(uQuat & 0xffu, (uQuat >> 8u) & 0xffu, (uQuat >> 16u) & 0xffu);

    
    float lnScaleMin = rgbMinMaxLnScaleMinMax.z;\r
    float lnScaleMax = rgbMinMaxLnScaleMinMax.w;\r
    float lnScaleScale = 254.0 / (lnScaleMax - lnScaleMin);\r
    uvec3 uScales = uvec3(\r
        (scales.x == 0.0) ? 0u : uint(round(clamp((log(scales.x) - lnScaleMin) * lnScaleScale, 0.0, 254.0))) + 1u,\r
        (scales.y == 0.0) ? 0u : uint(round(clamp((log(scales.y) - lnScaleMin) * lnScaleScale, 0.0, 254.0))) + 1u,\r
        (scales.z == 0.0) ? 0u : uint(round(clamp((log(scales.z) - lnScaleMin) * lnScaleScale, 0.0, 254.0))) + 1u\r
    );

    
    uint word0 = uRgba.r | (uRgba.g << 8u) | (uRgba.b << 16u) | (uRgba.a << 24u);\r
    uint word1 = packHalf2x16(center.xy);\r
    uint word2 = packHalf2x16(vec2(center.z, 0.0)) | (uQuat3.x << 16u) | (uQuat3.y << 24u);\r
    uint word3 = uScales.x | (uScales.y << 8u) | (uScales.z << 16u) | (uQuat3.z << 24u);\r
    return uvec4(word0, word1, word2, word3);\r
}

uvec4 packSplat(vec3 center, vec3 scales, vec4 quaternion, vec4 rgba) {\r
    return packSplatEncoding(center, scales, quaternion, rgba, vec4(0.0, 1.0, LN_SCALE_MIN, LN_SCALE_MAX));\r
}

void unpackSplatEncoding(uvec4 packed, out vec3 center, out vec3 scales, out vec4 quaternion, out vec4 rgba, vec4 rgbMinMaxLnScaleMinMax) {\r
    uint word0 = packed.x, word1 = packed.y, word2 = packed.z, word3 = packed.w;

    uvec4 uRgba = uvec4(word0 & 0xffu, (word0 >> 8u) & 0xffu, (word0 >> 16u) & 0xffu, (word0 >> 24u) & 0xffu);\r
    float rgbMin = rgbMinMaxLnScaleMinMax.x;\r
    float rgbMax = rgbMinMaxLnScaleMinMax.y;\r
    rgba = (vec4(uRgba) / 255.0);\r
    rgba.rgb = rgba.rgb * (rgbMax - rgbMin) + rgbMin;

    center = vec4(\r
        unpackHalf2x16(word1),\r
        unpackHalf2x16(word2 & 0xffffu)\r
    ).xyz;

    uvec3 uScales = uvec3(word3 & 0xffu, (word3 >> 8u) & 0xffu, (word3 >> 16u) & 0xffu);\r
    float lnScaleMin = rgbMinMaxLnScaleMinMax.z;\r
    float lnScaleMax = rgbMinMaxLnScaleMinMax.w;\r
    float lnScaleScale = (lnScaleMax - lnScaleMin) / 254.0;\r
    scales = vec3(\r
        (uScales.x == 0u) ? 0.0 : exp(lnScaleMin + float(uScales.x - 1u) * lnScaleScale),\r
        (uScales.y == 0u) ? 0.0 : exp(lnScaleMin + float(uScales.y - 1u) * lnScaleScale),\r
        (uScales.z == 0u) ? 0.0 : exp(lnScaleMin + float(uScales.z - 1u) * lnScaleScale)\r
    );\r

    uint uQuat = ((word2 >> 16u) & 0xFFFFu) | ((word3 >> 8u) & 0xFF0000u);\r
    quaternion = decodeQuatOctXy88R8(uQuat);\r
    
    
}

void unpackSplat(uvec4 packed, out vec3 center, out vec3 scales, out vec4 quaternion, out vec4 rgba) {\r
    unpackSplatEncoding(packed, center, scales, quaternion, rgba, vec4(0.0, 1.0, LN_SCALE_MIN, LN_SCALE_MAX));\r
}

vec3 quatVec(vec4 q, vec3 v) {\r
    
    vec3 t = 2.0 * cross(q.xyz, v);\r
    return v + q.w * t + cross(q.xyz, t);\r
}

vec4 quatQuat(vec4 q1, vec4 q2) {\r
    return vec4(\r
        q1.w * q2.x + q1.x * q2.w + q1.y * q2.z - q1.z * q2.y,\r
        q1.w * q2.y - q1.x * q2.z + q1.y * q2.w + q1.z * q2.x,\r
        q1.w * q2.z + q1.x * q2.y - q1.y * q2.x + q1.z * q2.w,\r
        q1.w * q2.w - q1.x * q2.x - q1.y * q2.y - q1.z * q2.z\r
    );\r
}

mat3 scaleQuaternionToMatrix(vec3 s, vec4 q) {\r
    
    return mat3(\r
        s.x * (1.0 - 2.0 * (q.y * q.y + q.z * q.z)),\r
        s.x * (2.0 * (q.x * q.y + q.w * q.z)),\r
        s.x * (2.0 * (q.x * q.z - q.w * q.y)),\r
        s.y * (2.0 * (q.x * q.y - q.w * q.z)),\r
        s.y * (1.0 - 2.0 * (q.x * q.x + q.z * q.z)),\r
        s.y * (2.0 * (q.y * q.z + q.w * q.x)),\r
        s.z * (2.0 * (q.x * q.z + q.w * q.y)),\r
        s.z * (2.0 * (q.y * q.z - q.w * q.x)),\r
        s.z * (1.0 - 2.0 * (q.x * q.x + q.y * q.y))\r
    );\r
}

vec4 slerp(vec4 q1, vec4 q2, float t) {\r
    
    float cosHalfTheta = dot(q1, q2);

    
    if (abs(cosHalfTheta) >= 0.999) {\r
        return q1;\r
    }\r
    \r
    
    
    if (cosHalfTheta < 0.0) {\r
        q2 = -q2;\r
        cosHalfTheta = -cosHalfTheta;\r
    }

    
    float halfTheta = acos(cosHalfTheta);\r
    float sinHalfTheta = sqrt(1.0 - cosHalfTheta * cosHalfTheta);

    
    float ratioA = sin((1.0 - t) * halfTheta) / sinHalfTheta;\r
    float ratioB = sin(t * halfTheta) / sinHalfTheta;

    
    return q1 * ratioA + q2 * ratioB;\r
}

ivec3 splatTexCoord(int index) {\r
    uint x = uint(index) & SPLAT_TEX_WIDTH_MASK;\r
    uint y = (uint(index) >> SPLAT_TEX_WIDTH_BITS) & SPLAT_TEX_HEIGHT_MASK;\r
    uint z = uint(index) >> SPLAT_TEX_LAYER_BITS;\r
    return ivec3(x, y, z);\r
}`,DI=`precision highp float;\r
precision highp int;

#include <splatDefines>\r
#include <logdepthbuf_pars_fragment>

uniform float near;\r
uniform float far;\r
uniform bool encodeLinear;\r
uniform float time;\r
uniform bool debugFlag;\r
uniform float maxStdDev;\r
uniform float minAlpha;\r
uniform bool stochastic;\r
uniform bool disableFalloff;\r
uniform float falloff;

uniform bool splatTexEnable;\r
uniform sampler3D splatTexture;\r
uniform mat2 splatTexMul;\r
uniform vec2 splatTexAdd;\r
uniform float splatTexNear;\r
uniform float splatTexFar;\r
uniform float splatTexMid;

out vec4 fragColor;

in vec4 vRgba;\r
in vec2 vSplatUv;\r
in vec3 vNdc;\r
flat in uint vSplatIndex;

void main() {\r
    vec4 rgba = vRgba;

    float z = dot(vSplatUv, vSplatUv);\r
    if (!splatTexEnable) {\r
        if (z > (maxStdDev * maxStdDev)) {\r
            discard;\r
        }\r
    } else {\r
        vec2 uv = splatTexMul * vSplatUv + splatTexAdd;\r
        float ndcZ = vNdc.z;\r
        float depth = (2.0 * near * far) / (far + near - ndcZ * (far - near));\r
        float clampedFar = max(splatTexFar, splatTexNear);\r
        float clampedDepth = clamp(depth, splatTexNear, clampedFar);\r
        float logDepth = log2(clampedDepth + 1.0);\r
        float logNear = log2(splatTexNear + 1.0);\r
        float logFar = log2(clampedFar + 1.0);

        float texZ;\r
        if (splatTexMid > 0.0) {\r
            float clampedMid = clamp(splatTexMid, splatTexNear, clampedFar);\r
            float logMid = log2(clampedMid + 1.0);\r
            texZ = (clampedDepth <= clampedMid) ?\r
                (0.5 * ((logDepth - logNear) / (logMid - logNear))) :\r
                (0.5 * ((logDepth - logMid) / (logFar - logMid)) + 0.5);\r
        } else {\r
            texZ = (logDepth - logNear) / (logFar - logNear);\r
        }

        vec4 modulate = texture(splatTexture, vec3(uv, 1.0 - texZ));\r
        rgba *= modulate;\r
    }

    rgba.a *= mix(1.0, exp(-0.5 * z), falloff);

    if (rgba.a < minAlpha) {\r
        discard;\r
    }\r
    if (encodeLinear) {\r
        rgba.rgb = srgbToLinear(rgba.rgb);\r
    }

    if (stochastic) {\r
        const bool STEADY = false;\r
        uint uTime = STEADY ? 0u : floatBitsToUint(time);\r
        uvec2 coord = uvec2(gl_FragCoord.xy);\r
        uint state = uTime + 0x9e3779b9u * coord.x + 0x85ebca6bu * coord.y + 0xc2b2ae35u * uint(vSplatIndex);\r
        state = state * 747796405u + 2891336453u;\r
        uint hash = ((state >> ((state >> 28u) + 4u)) ^ state) * 277803737u;\r
        hash = (hash >> 22u) ^ hash;\r
        float rand = float(hash) / 4294967296.0;\r
        if (rand < rgba.a) {\r
            fragColor = vec4(rgba.rgb, 1.0);\r
        } else {\r
            discard;\r
        }\r
    } else {\r
        #ifdef PREMULTIPLIED_ALPHA\r
            fragColor = vec4(rgba.rgb * rgba.a, rgba.a);\r
        #else\r
            fragColor = rgba;\r
        #endif\r
    }\r
    #include <logdepthbuf_fragment>\r
}`,MI=`precision highp float;\r
precision highp int;\r
precision highp usampler2DArray;

#include <splatDefines>\r
#include <logdepthbuf_pars_vertex>

attribute uint splatIndex;

out vec4 vRgba;\r
out vec2 vSplatUv;\r
out vec3 vNdc;\r
flat out uint vSplatIndex;

uniform vec2 renderSize;\r
uniform uint numSplats;\r
uniform vec4 renderToViewQuat;\r
uniform vec3 renderToViewPos;\r
uniform float maxStdDev;\r
uniform float minPixelRadius;\r
uniform float maxPixelRadius;\r
uniform float time;\r
uniform float deltaTime;\r
uniform bool debugFlag;\r
uniform float minAlpha;\r
uniform bool stochastic;\r
uniform bool enable2DGS;\r
uniform float blurAmount;\r
uniform float preBlurAmount;\r
uniform float focalDistance;\r
uniform float apertureAngle;\r
uniform float clipXY;\r
uniform float focalAdjustment;

uniform usampler2DArray packedSplats;\r
uniform vec4 rgbMinMaxLnScaleMinMax;

#ifdef USE_LOGDEPTHBUF\r
    bool isPerspectiveMatrix( mat4 m ) {\r
      return m[ 2 ][ 3 ] == - 1.0;\r
    }\r
#endif

void main() {\r
    
    gl_Position = vec4(0.0, 0.0, 2.0, 1.0);

    if (uint(gl_InstanceID) >= numSplats) {\r
        return;\r
    }

    ivec3 texCoord;\r
    if (stochastic) {\r
        texCoord = ivec3(\r
            uint(gl_InstanceID) & SPLAT_TEX_WIDTH_MASK,\r
            (uint(gl_InstanceID) >> SPLAT_TEX_WIDTH_BITS) & SPLAT_TEX_HEIGHT_MASK,\r
            (uint(gl_InstanceID) >> SPLAT_TEX_LAYER_BITS)\r
        );\r
    } else {\r
        if (splatIndex == 0xffffffffu) {\r
            
            return;\r
        }\r
        texCoord = ivec3(\r
            splatIndex & SPLAT_TEX_WIDTH_MASK,\r
            (splatIndex >> SPLAT_TEX_WIDTH_BITS) & SPLAT_TEX_HEIGHT_MASK,\r
            splatIndex >> SPLAT_TEX_LAYER_BITS\r
        );\r
    }\r
    uvec4 packed = texelFetch(packedSplats, texCoord, 0);

    vec3 center, scales;\r
    vec4 quaternion, rgba;\r
    unpackSplatEncoding(packed, center, scales, quaternion, rgba, rgbMinMaxLnScaleMinMax);

    if (rgba.a < minAlpha) {\r
        return;\r
    }\r
    bvec3 zeroScales = equal(scales, vec3(0.0));\r
    if (all(zeroScales)) {\r
        return;\r
    }

    
    vec3 viewCenter = quatVec(renderToViewQuat, center) + renderToViewPos;

    
    if (viewCenter.z >= 0.0) {\r
        return;\r
    }

    
    vec4 clipCenter = projectionMatrix * vec4(viewCenter, 1.0);

    
    if (abs(clipCenter.z) >= clipCenter.w) {\r
        return;\r
    }

    
    float clip = clipXY * clipCenter.w;\r
    if (abs(clipCenter.x) > clip || abs(clipCenter.y) > clip) {\r
        return;\r
    }

    
    vSplatIndex = splatIndex;

    
    vec4 viewQuaternion = quatQuat(renderToViewQuat, quaternion);

    if (enable2DGS && any(zeroScales)) {\r
        vRgba = rgba;\r
        vSplatUv = position.xy * maxStdDev;

        vec3 offset;\r
        if (zeroScales.z) {\r
            offset = vec3(vSplatUv.xy * scales.xy, 0.0);\r
        } else if (zeroScales.y) {\r
            offset = vec3(vSplatUv.x * scales.x, 0.0, vSplatUv.y * scales.z);\r
        } else {\r
            offset = vec3(0.0, vSplatUv.xy * scales.yz);\r
        }

        vec3 viewPos = viewCenter + quatVec(viewQuaternion, offset);\r
        gl_Position = projectionMatrix * vec4(viewPos, 1.0);\r
        vNdc = gl_Position.xyz / gl_Position.w;\r
        return;\r
    }

    
    vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

    
    mat3 RS = scaleQuaternionToMatrix(scales, viewQuaternion);\r
    mat3 cov3D = RS * transpose(RS);

    
    vec2 scaledRenderSize = renderSize * focalAdjustment;\r
    vec2 focal = 0.5 * scaledRenderSize * vec2(projectionMatrix[0][0], projectionMatrix[1][1]);

    mat3 J;\r
    if(isOrthographic) {\r
        J = mat3(\r
            focal.x, 0.0, 0.0,\r
            0.0, focal.y, 0.0,\r
            0.0, 0.0, 0.0\r
        );\r
    } else {\r
        float invZ = 1.0 / viewCenter.z;\r
        vec2 J1 = focal * invZ;\r
        vec2 J2 = -(J1 * viewCenter.xy) * invZ;\r
        J = mat3(\r
            J1.x, 0.0, J2.x,\r
            0.0, J1.y, J2.y,\r
            0.0, 0.0, 0.0\r
        );\r
    }

    
    
    
    
    
    
    
    mat3 cov2D = transpose(J) * cov3D * J;\r
    float a = cov2D[0][0];\r
    float d = cov2D[1][1];\r
    float b = cov2D[0][1];

    
    a += preBlurAmount;\r
    d += preBlurAmount;

    float fullBlurAmount = blurAmount;\r
    if ((focalDistance > 0.0) && (apertureAngle > 0.0)) {\r
        float focusRadius = maxPixelRadius;\r
        if (viewCenter.z < 0.0) {\r
            float focusBlur = abs((-viewCenter.z - focalDistance) / viewCenter.z);\r
            float apertureRadius = focal.x * tan(0.5 * apertureAngle);\r
            focusRadius = focusBlur * apertureRadius;\r
        }\r
        fullBlurAmount = clamp(sqr(focusRadius), blurAmount, sqr(maxPixelRadius));\r
    }

    
    float detOrig = a * d - b * b;\r
    a += fullBlurAmount;\r
    d += fullBlurAmount;\r
    float det = a * d - b * b;

    
    float blurAdjust = sqrt(max(0.0, detOrig / det));\r
    rgba.a *= blurAdjust;\r
    if (rgba.a < minAlpha) {\r
        return;\r
    }

    
    float eigenAvg = 0.5 * (a + d);\r
    float eigenDelta = sqrt(max(0.0, eigenAvg * eigenAvg - det));\r
    float eigen1 = eigenAvg + eigenDelta;\r
    float eigen2 = eigenAvg - eigenDelta;

    vec2 eigenVec1 = normalize(vec2((abs(b) < 0.001) ? 1.0 : b, eigen1 - a));\r
    vec2 eigenVec2 = vec2(eigenVec1.y, -eigenVec1.x);

    float scale1 = min(maxPixelRadius, maxStdDev * sqrt(eigen1));\r
    float scale2 = min(maxPixelRadius, maxStdDev * sqrt(eigen2));\r
    if (scale1 < minPixelRadius && scale2 < minPixelRadius) {\r
        return;\r
    }

    
    vec2 pixelOffset = position.x * eigenVec1 * scale1 + position.y * eigenVec2 * scale2;\r
    vec2 ndcOffset = (2.0 / scaledRenderSize) * pixelOffset;\r
    vec3 ndc = vec3(ndcCenter.xy + ndcOffset, ndcCenter.z);

    vRgba = rgba;\r
    vSplatUv = position.xy * maxStdDev;\r
    vNdc = ndc;\r
    gl_Position = vec4(ndc.xy * clipCenter.w, clipCenter.zw);\r
    #include <logdepthbuf_vertex>\r
}`;let Je=null;function gs(){return Je||(I.ShaderChunk.splatDefines=SI,Je={splatVertex:MI,splatFragment:DI,computeVec4Template:xI,computeUvec4Template:wI}),Je}const UA=class UA{constructor({renderer:A}={}){this.renderer=A,this.capacity=0,this.count=0}dispose(){this.target&&(this.target.dispose(),this.target=void 0)}ensureBuffer(A,e){const n=Math.ceil(Math.max(1,A)/O)*O*4;if(e.byteLength>=n)return e;const i=new ArrayBuffer(n);if(e instanceof ArrayBuffer)return i;const r=e.constructor;return new r(i)}ensureCapacity(A){const{width:e,height:s,depth:n,maxSplats:i}=xA(A);(!this.target||i>this.capacity)&&(this.dispose(),this.capacity=i,this.target=new I.WebGLArrayRenderTarget(e,s,n,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,magFilter:I.NearestFilter,minFilter:I.NearestFilter}),this.target.texture.format=I.RGBAFormat,this.target.texture.type=I.UnsignedByteType,this.target.texture.internalFormat="RGBA8",this.target.scissorTest=!0)}prepareProgramMaterial(A){let e=UA.readbackProgram.get(A);if(!e){const n=FA({index:"int"},{rgba8:"vec4"},({index:i})=>(A.inputs.index=i,{rgba8:new es({rgba8:A.outputs.rgba8})}));UA.programTemplate||(UA.programTemplate=new rs(gs().computeVec4Template)),e=new is({graph:n,inputs:{index:"index"},outputs:{rgba8:"target"},template:UA.programTemplate}),Object.assign(e.uniforms,{targetLayer:{value:0},targetBase:{value:0},targetCount:{value:0}}),UA.readbackProgram.set(A,e)}const s=e.prepareMaterial();return UA.fullScreenQuad.material=s,{program:e,material:s}}saveRenderState(A){return{xrEnabled:A.xr.enabled,autoClear:A.autoClear}}resetRenderState(A,e){A.setRenderTarget(null),A.xr.enabled=e.xrEnabled,A.autoClear=e.autoClear}process({count:A,material:e}){const s=this.renderer;if(!s)throw new Error("No renderer");if(!this.target)throw new Error("No target");const n=O*$A;e.uniforms.targetBase.value=0,e.uniforms.targetCount.value=A;let i=0;for(;i<A;){const r=Math.floor(i/n),a=r*n,o=Math.min($A,Math.ceil((A-a)/O));e.uniforms.targetLayer.value=r,this.target.scissor.set(0,0,O,o),s.setRenderTarget(this.target,r),s.xr.enabled=!1,s.autoClear=!1,UA.fullScreenQuad.render(s),i+=O*o}this.count=A}async read({readback:A}){const e=this.renderer;if(!e)throw new Error("No renderer");if(!this.target)throw new Error("No target");const s=Math.ceil(this.count/O)*O;if(A.byteLength<s*4)throw new Error(`Readback buffer too small: ${A.byteLength} < ${s*4}`);const n=new Uint8Array(A instanceof ArrayBuffer?A:A.buffer),i=O*$A;let r=0;const a=[];for(;r<this.count;){const o=Math.floor(r/i),g=o*i,l=Math.min($A,Math.ceil((this.count-g)/O));e.setRenderTarget(this.target,o);const c=O*l*4,u=n.subarray(g*4,g*4+c),h=e==null?void 0:e.readRenderTargetPixelsAsync(this.target,0,0,O,l,u);a.push(h),r+=O*l}return Promise.all(a).then(()=>A)}render({reader:A,count:e,renderer:s}){if(this.renderer=s||this.renderer,!this.renderer)throw new Error("No renderer");this.ensureCapacity(e);const{program:n,material:i}=this.prepareProgramMaterial(A);n.update();const r=this.saveRenderState(this.renderer);this.process({count:e,material:i}),this.resetRenderState(this.renderer,r)}async readback({readback:A}){if(!this.renderer)throw new Error("No renderer");const e=this.saveRenderState(this.renderer),s=this.read({readback:A});return this.resetRenderState(this.renderer,e),s}async renderReadback({reader:A,count:e,renderer:s,readback:n}){if(this.renderer=s||this.renderer,!this.renderer)throw new Error("No renderer");this.ensureCapacity(e);const{program:i,material:r}=this.prepareProgramMaterial(A);i.update();const a=this.saveRenderState(this.renderer);this.process({count:e,material:r});const o=this.read({readback:n});return this.resetRenderState(this.renderer,a),o}getTexture(){var A;return(A=this.target)==null?void 0:A.texture}};UA.programTemplate=null,UA.readbackProgram=new Map,UA.fullScreenQuad=new Ds(new I.RawShaderMaterial({visible:!1}));let Xt=UA;const IA=class IA{constructor(A={}){this.capacity=0,this.count=0,this.array=null,this.readback=null,this.source=null,this.needsUpdate=!0,this.dyno=new N({key:"rgbaArray",type:ja,globals:()=>[Wa],value:{texture:IA.getEmpty(),count:0},update:e=>{var s;return e.texture=((s=this.readback)==null?void 0:s.getTexture())??this.source??IA.getEmpty(),e.count=this.count,e}}),A.array?(this.array=A.array,this.capacity=Math.floor(this.array.length/4),this.capacity=Math.floor(this.capacity/O)*O,this.count=Math.min(this.capacity,A.count??Number.POSITIVE_INFINITY)):(this.capacity=A.capacity??0,this.count=0)}dispose(){this.readback&&(this.readback.dispose(),this.readback=null),this.source&&(this.source.dispose(),this.source=null)}ensureCapacity(A){var e;if(!this.array||A>(((e=this.array)==null?void 0:e.length)??0)/4){this.capacity=xA(A).maxSplats;const s=new Uint8Array(this.capacity*4);this.array&&s.set(this.array),this.array=s}return this.array}getTexture(){var e;let A=(e=this.readback)==null?void 0:e.getTexture();return(this.source||this.array)&&(A=this.maybeUpdateSource()),A??IA.getEmpty()}maybeUpdateSource(){if(!this.array)throw new Error("No array");if(this.needsUpdate||!this.source){if(this.needsUpdate=!1,this.source){const{width:A,height:e,depth:s}=this.source.image;this.capacity!==A*e*s&&(this.source.dispose(),this.source=null)}if(this.source)this.array.buffer!==this.source.image.data.buffer&&(this.source.image.data=new Uint8Array(this.array.buffer));else{const{width:A,height:e,depth:s}=xA(this.capacity);this.source=new I.DataArrayTexture(this.array,A,e,s),this.source.format=I.RGBAFormat,this.source.type=I.UnsignedByteType,this.source.internalFormat="RGBA8",this.source.needsUpdate=!0}this.source.needsUpdate=!0}return this.source}render({reader:A,count:e,renderer:s}){this.readback||(this.readback=new Xt({renderer:s})),this.readback.render({reader:A,count:e,renderer:s}),this.capacity=this.readback.capacity,this.count=this.readback.count}fromPackedSplats({packedSplats:A,base:e,count:s,renderer:n}){const{dynoSplats:i,dynoBase:r,dynoCount:a,reader:o}=IA.makeDynos();return i.packedSplats=A,r.value=e,a.value=s,this.render({reader:o,count:s,renderer:n}),this}async read(){if(!this.readback)throw new Error("No readback");return(!this.array||this.array.length<this.count*4)&&(this.array=new Uint8Array(this.capacity*4)),(await this.readback.readback({readback:this.array})).subarray(0,this.count*4)}static getEmpty(){if(!IA.emptySource){const A=new Uint8Array(4);IA.emptySource=new I.DataArrayTexture(A,1,1,1),IA.emptySource.format=I.RGBAFormat,IA.emptySource.type=I.UnsignedByteType,IA.emptySource.internalFormat="RGBA8",IA.emptySource.needsUpdate=!0}return IA.emptySource}static makeDynos(){if(!IA.dynos){const A=new Cs,e=new Ot({value:0}),s=new Ot({value:0}),n=FA({index:"int"},{rgba8:"vec4"},({index:i})=>{if(!i)throw new Error("index is undefined");i=EA(i,e);const r=Vs(A,i,e,s);return{rgba8:Bt(r).outputs.rgba}});IA.dynos={dynoSplats:A,dynoBase:e,dynoCount:s,reader:n}}return IA.dynos}};IA.emptySource=null,IA.dynos=null;let pe=IA;const ja={type:"RgbaArray"},Wa=CA(`
  struct RgbaArray {
    sampler2DArray texture;
    int count;
  };
`);function Ao(t,A){return new P({inTypes:{rgba:ja,index:"int"},outTypes:{rgba:"vec4"},inputs:{rgba:t,index:A},globals:()=>[Wa],statements:({inputs:s,outputs:n})=>YA(`
        if ((index >= 0) && (index < ${s.rgba}.count)) {
          ${n.rgba} = texelFetch(${s.rgba}.texture, splatTexCoord(index), 0);
        } else {
          ${n.rgba} = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `)}).outputs.rgba}var to=(t=>(t.ALL="all",t.PLANE="plane",t.SPHERE="sphere",t.BOX="box",t.ELLIPSOID="ellipsoid",t.CYLINDER="cylinder",t.CAPSULE="capsule",t.INFINITE_CONE="infinite_cone",t))(to||{});function vI(t){switch(t){case"all":return 0;case"plane":return 1;case"sphere":return 2;case"box":return 3;case"ellipsoid":return 4;case"cylinder":return 5;case"capsule":return 6;case"infinite_cone":return 7;default:throw new Error(`Unknown SDF type: ${t}`)}}var eo=(t=>(t.MULTIPLY="multiply",t.SET_RGB="set_rgb",t.ADD_RGBA="add_rgba",t))(eo||{});function bI(t){switch(t){case"multiply":return 0;case"set_rgb":return 1;case"add_rgba":return 2;default:throw new Error(`Unknown blend mode: ${t}`)}}class so extends I.Object3D{constructor(A={}){super();const{type:e,invert:s,opacity:n,color:i,displace:r,radius:a}=A;this.type=e??"sphere",this.invert=s??!1,this.opacity=n??1,this.color=i??new I.Color(1,1,1),this.displace=r??new I.Vector3(0,0,0),this.radius=a??0}}const me=class me extends I.Object3D{constructor(A={}){const{name:e,rgbaBlendMode:s="multiply",sdfSmooth:n=0,softEdge:i=0,invert:r=!1,sdfs:a=null}=A;super(),this.rgbaBlendMode=s,this.sdfSmooth=n,this.softEdge=i,this.invert=r,this.sdfs=a,this.ordering=me.nextOrdering++,this.name=e??`Edit ${this.ordering}`}addSdf(A){this.sdfs==null&&(this.sdfs=[]),this.sdfs.includes(A)||this.sdfs.push(A)}removeSdf(A){this.sdfs!=null&&(this.sdfs=this.sdfs.filter(e=>e!==A))}};me.nextOrdering=1;let Zt=me;class no{constructor({maxSdfs:A,maxEdits:e}){this.maxSdfs=Math.max(16,A??0),this.numSdfs=0,this.sdfData=new Uint32Array(this.maxSdfs*8*4),this.sdfFloatData=new Float32Array(this.sdfData.buffer),this.sdfTexture=this.newSdfTexture(this.sdfData,this.maxSdfs),this.dynoSdfArray=new N({key:"sdfArray",type:io,globals:()=>[ro],value:{numSdfs:0,sdfTexture:this.sdfTexture},update:s=>(s.numSdfs=this.numSdfs,s.sdfTexture=this.sdfTexture,s)}),this.maxEdits=Math.max(16,e??0),this.numEdits=0,this.editData=new Uint32Array(this.maxEdits*4),this.editFloatData=new Float32Array(this.editData.buffer),this.dynoNumEdits=new Ot({value:0}),this.dynoEdits=this.newEdits(this.editData,this.maxEdits)}newSdfTexture(A,e){const s=new I.DataTexture(A,8,e,I.RGBAIntegerFormat,I.UnsignedIntType);return s.internalFormat="RGBA32UI",s.needsUpdate=!0,s}newEdits(A,e){return new N({key:"edits",type:"uvec4",count:e,globals:()=>[ao],value:A})}ensureCapacity({maxSdfs:A,maxEdits:e}){let s=!1;return A>this.sdfTexture.image.height&&(this.sdfTexture.dispose(),this.maxSdfs=Math.max(this.maxSdfs*2,A),this.sdfData=new Uint32Array(this.maxSdfs*8*4),this.sdfFloatData=new Float32Array(this.sdfData.buffer),this.sdfTexture=this.newSdfTexture(this.sdfData,this.maxSdfs)),e>(this.dynoEdits.count??0)&&(this.maxEdits=Math.max(this.maxEdits*2,e),this.editData=new Uint32Array(this.maxEdits*4),this.editFloatData=new Float32Array(this.editData.buffer),this.dynoEdits=this.newEdits(this.editData,this.maxEdits),s=!0),s}updateEditData(A,e){const s=this.editData[A]!==e;return this.editData[A]=e,s}updateEditFloatData(A,e){wt[0]=e;const s=this.editFloatData[A]!==wt[0];return s&&(this.editFloatData[A]=wt[0]),s}encodeEdit(A,{sdfFirst:e,sdfCount:s,invert:n,rgbaBlendMode:i,softEdge:r,sdfSmooth:a}){const o=A*4;let g=!1;return g=this.updateEditData(o+0,i|(n?256:0))||g,g=this.updateEditData(o+1,e|s<<16)||g,g=this.updateEditFloatData(o+2,r)||g,g=this.updateEditFloatData(o+3,a)||g,g}updateSdfData(A,e){const s=this.sdfData[A]!==e;return this.sdfData[A]=e,s}updateSdfFloatData(A,e){wt[0]=e;const s=this.sdfFloatData[A]!==wt[0];return s&&(this.sdfFloatData[A]=wt[0]),s}encodeSdf(A,{sdfType:e,invert:s,center:n,quaternion:i,scale:r,sizes:a},o){const g=A*32,l=e|(s?256:0);let c=!1;c=this.updateSdfFloatData(g+0,(n==null?void 0:n.x)??0)||c,c=this.updateSdfFloatData(g+1,(n==null?void 0:n.y)??0)||c,c=this.updateSdfFloatData(g+2,(n==null?void 0:n.z)??0)||c,c=this.updateSdfData(g+3,l)||c,c=this.updateSdfFloatData(g+4,(i==null?void 0:i.x)??0)||c,c=this.updateSdfFloatData(g+5,(i==null?void 0:i.y)??0)||c,c=this.updateSdfFloatData(g+6,(i==null?void 0:i.z)??0)||c,c=this.updateSdfFloatData(g+7,(i==null?void 0:i.w)??0)||c,c=this.updateSdfFloatData(g+8,(r==null?void 0:r.x)??0)||c,c=this.updateSdfFloatData(g+9,(r==null?void 0:r.y)??0)||c,c=this.updateSdfFloatData(g+10,(r==null?void 0:r.z)??0)||c,c=this.updateSdfData(g+11,0)||c,c=this.updateSdfFloatData(g+12,(a==null?void 0:a.x)??0)||c,c=this.updateSdfFloatData(g+13,(a==null?void 0:a.y)??0)||c,c=this.updateSdfFloatData(g+14,(a==null?void 0:a.z)??0)||c,c=this.updateSdfFloatData(g+15,(a==null?void 0:a.w)??0)||c;const u=Math.min(4,o.length);for(let h=0;h<u;++h){const E=g+16+h*4;c=this.updateSdfFloatData(E+0,o[h].x)||c,c=this.updateSdfFloatData(E+1,o[h].y)||c,c=this.updateSdfFloatData(E+2,o[h].z)||c,c=this.updateSdfFloatData(E+3,o[h].w)||c}return c}update(A){const e=A.reduce((c,{sdfs:u})=>c+u.length,0),s=this.ensureCapacity({maxEdits:A.length,maxSdfs:e}),n=[new I.Vector4,new I.Vector4],i=new I.Vector3,r=new I.Quaternion,a=new I.Vector3,o=new I.Vector4;let g=0,l=s;A.length!==this.dynoNumEdits.value&&(this.dynoNumEdits.value=A.length,this.numEdits=A.length,l=!0);for(const[c,{edit:u,sdfs:h}]of A.entries()){l=this.encodeEdit(c,{sdfFirst:g,sdfCount:h.length,invert:u.invert,rgbaBlendMode:bI(u.rgbaBlendMode),softEdge:u.softEdge,sdfSmooth:u.sdfSmooth})||l;let E=!1;for(const C of h)o.set(C.scale.x,C.scale.y,C.scale.z,C.radius),C.scale.setScalar(1),C.updateMatrixWorld(),C.matrixWorld.clone().invert().decompose(i,r,a),C.scale.set(o.x,o.y,o.z),C.updateMatrixWorld(),n[0].set(C.color.r,C.color.g,C.color.b,C.opacity),n[1].set(C.displace.x,C.displace.y,C.displace.z,1),E=this.encodeSdf(g,{sdfType:vI(C.type),invert:C.invert,center:i,quaternion:r,scale:a,sizes:o},n)||E,g+=1;this.numSdfs=g,E&&(this.sdfTexture.needsUpdate=!0),l||(l=E)}return{updated:l,dynoUpdated:s}}modify(A){return FI(A,this.dynoSdfArray,this.dynoNumEdits,this.dynoEdits)}}const io={type:"SdfArray"},ro=CA(`
  struct SdfArray {
    int numSdfs;
    usampler2D sdfTexture;
  };

  void unpackSdfArray(
    usampler2D sdfTexture, int sdfIndex, out uint flags,
    out vec3 center, out vec4 quaternion, out vec3 scale, out vec4 sizes,
    int numValues, out vec4 values[4]
  ) {
    uvec4 temp = texelFetch(sdfTexture, ivec2(0, sdfIndex), 0);
    flags = temp.w;
    center = vec3(uintBitsToFloat(temp.x), uintBitsToFloat(temp.y), uintBitsToFloat(temp.z));

    temp = texelFetch(sdfTexture, ivec2(1, sdfIndex), 0);
    quaternion = vec4(uintBitsToFloat(temp.x), uintBitsToFloat(temp.y), uintBitsToFloat(temp.z), uintBitsToFloat(temp.w));

    temp = texelFetch(sdfTexture, ivec2(2, sdfIndex), 0);
    scale = vec3(uintBitsToFloat(temp.x), uintBitsToFloat(temp.y), uintBitsToFloat(temp.z));

    temp = texelFetch(sdfTexture, ivec2(3, sdfIndex), 0);
    sizes = vec4(uintBitsToFloat(temp.x), uintBitsToFloat(temp.y), uintBitsToFloat(temp.z), uintBitsToFloat(temp.w));

    for (int i = 0; i < numValues; ++i) {
      temp = texelFetch(sdfTexture, ivec2(4 + i, sdfIndex), 0);
      values[i] = vec4(uintBitsToFloat(temp.x), uintBitsToFloat(temp.y), uintBitsToFloat(temp.z), uintBitsToFloat(temp.w));
    }
  }

  const uint SDF_FLAG_TYPE = 0xFFu;
  const uint SDF_FLAG_INVERT = 1u << 8u;

  const uint SDF_TYPE_ALL = 0u;
  const uint SDF_TYPE_PLANE = 1u;
  const uint SDF_TYPE_SPHERE = 2u;
  const uint SDF_TYPE_BOX = 3u;
  const uint SDF_TYPE_ELLIPSOID = 4u;
  const uint SDF_TYPE_CYLINDER = 5u;
  const uint SDF_TYPE_CAPSULE = 6u;
  const uint SDF_TYPE_INFINITE_CONE = 7u;

  float evaluateSdfArray(
    usampler2D sdfTexture, int numSdfs, int sdfFirst, int sdfCount, vec3 pos,
    float smoothK, int numValues, out vec4 outValues[4]
  ) {
    float distanceAccum = (smoothK == 0.0) ? 1.0 / 0.0 : 0.0;
    float maxExp = -1.0 / 0.0;
    for (int i = 0; i < numValues; ++i) {
        outValues[i] = vec4(0.0);
    }

    uint flags;
    vec3 center, scale;
    vec4 quaternion, sizes;
    vec4 values[4];

    int sdfLast = min(sdfFirst + sdfCount, numSdfs);
    for (int index = sdfFirst; index < sdfLast; ++index) {
      unpackSdfArray(sdfTexture, index, flags, center, quaternion, scale, sizes, numValues, values);
      uint sdfType = flags & SDF_FLAG_TYPE;
      vec3 sdfPos = quatVec(quaternion, pos * scale) + center;

      float distance;
      switch (sdfType) {
        case SDF_TYPE_ALL:
          distance = -1.0 / 0.0;
          break;
        case SDF_TYPE_PLANE: {
          distance = sdfPos.z;
          break;
        }
        case SDF_TYPE_SPHERE: {
          distance = length(sdfPos) - sizes.w;
          break;
        }
        case SDF_TYPE_BOX: {
          vec3 q = abs(sdfPos) - sizes.xyz + sizes.w;
          distance = length(max(q, 0.0)) + min(max(q.x, max(q.y, q.z)), 0.0) - sizes.w;
          break;
        }
        case SDF_TYPE_ELLIPSOID: {
          vec3 sizes = sizes.xyz;
          float k0 = length(sdfPos / sizes);
          float k1 = length(sdfPos / dot(sizes, sizes));
          distance = k0 * (k0 - 1.0) / k1;
          break;
        }
        case SDF_TYPE_CYLINDER: {
          vec2 d = abs(vec2(length(sdfPos.xz), sdfPos.y)) - sizes.wy;
          distance = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
          break;
        }
        case SDF_TYPE_CAPSULE: {
          sdfPos.y -= clamp(sdfPos.y, -0.5 * sizes.y, 0.5 * sizes.y);
          distance = length(sdfPos) - sizes.w;
          break;
        }
        case SDF_TYPE_INFINITE_CONE: {
          float angle = 0.25 * PI * sizes.w;
          vec2 c = vec2(sin(angle), cos(angle));
          vec2 q = vec2(length(sdfPos.xy), -sdfPos.z);
          float d = length(q - c * max(dot(q, c), 0.0));
          distance = d * (((q.x * c.y - q.y * c.x) < 0.0) ? -1.0 : 1.0);
          break;
        }
      }

      if ((flags & SDF_FLAG_INVERT) != 0u) {
        distance = -distance;
      }

      if (smoothK == 0.0) {
        if (distance < distanceAccum) {
          distanceAccum = distance;
          for (int i = 0; i < numValues; ++i) {
            outValues[i] = values[i];
          }
        }
      } else {
        float scaledDistance = -distance / smoothK;
        if (scaledDistance > maxExp) {
          float scale = exp(maxExp - scaledDistance);
          distanceAccum *= scale;
          for (int i = 0; i < numValues; ++i) {
            outValues[i] *= scale;
          }
          maxExp = scaledDistance;
        }

        float weight = exp(scaledDistance - maxExp);
        distanceAccum += weight;
        for (int i = 0; i < numValues; ++i) {
          outValues[i] += weight * values[i];
        }
      }
    }

    if (smoothK == 0.0) {
      return distanceAccum;
    } else {
      // Very distant SDFs may result in 0 accumulation
      if (distanceAccum == 0.0) {
        return 1.0 / 0.0;
      }
      for (int i = 0; i < numValues; ++i) {
        outValues[i] /= distanceAccum;
      }
      return (-log(distanceAccum) - maxExp) * smoothK;
    }
  }

  float modulateSdfArray(
    usampler2D sdfTexture, int numSdfs, int sdfFirst, int sdfCount, vec3 pos,
    float smoothK, int numValues, out vec4 values[4],
    float softEdge, bool invert
  ) {
    float distance = evaluateSdfArray(sdfTexture, numSdfs, sdfFirst, sdfCount, pos, smoothK, numValues, values);
    if (invert) {
      distance = -distance;
    }

    return (softEdge == 0.0) ? ((distance < 0.0) ? 1.0 : 0.0)
      : clamp(-distance / softEdge + 0.5, 0.0, 1.0);
  }
`),ao=CA(`
  const uint EDIT_FLAG_BLEND = 0xFFu;
  const uint EDIT_BLEND_MULTIPLY = 0u;
  const uint EDIT_BLEND_SET_RGB = 1u;
  const uint EDIT_BLEND_ADD_RGBA = 2u;
  const uint EDIT_FLAG_INVERT = 0x100u;

  void decodeEdit(
    uvec4 packedEdit, out int sdfFirst, out int sdfCount,
    out bool invert, out uint rgbaBlendMode, out float softEdge, out float sdfSmooth
  ) {
    rgbaBlendMode = packedEdit.x & EDIT_FLAG_BLEND;
    invert = (packedEdit.x & EDIT_FLAG_INVERT) != 0u;

    sdfFirst = int(packedEdit.y & 0xFFFFu);
    sdfCount = int(packedEdit.y >> 16u);

    softEdge = uintBitsToFloat(packedEdit.z);
    sdfSmooth = uintBitsToFloat(packedEdit.w);
  }

  void applyRgbaDisplaceEdit(
    usampler2D sdfTexture, int numSdfs, int sdfFirst, int sdfCount, inout vec3 pos,
    float smoothK, float softEdge, bool invert, uint rgbaBlendMode, inout vec4 rgba
  ) {
    vec4 values[4];
    float modulate = modulateSdfArray(sdfTexture, numSdfs, sdfFirst, sdfCount, pos, smoothK, 2, values, softEdge, invert);
    // On Android, moving values[0] is necessary to work around a compiler bug.
    vec4 sdfRgba = values[0];
    vec4 sdfDisplaceScale = values[1];

    vec4 target;
    switch (rgbaBlendMode) {
      case EDIT_BLEND_MULTIPLY:
        target = rgba * sdfRgba;
        break;
      case EDIT_BLEND_SET_RGB:
        target = vec4(sdfRgba.rgb, rgba.a * sdfRgba.a);
        break;
      case EDIT_BLEND_ADD_RGBA:
        target = rgba + sdfRgba;
        break;
      default:
        // Debug output if blend mode not set
        target = vec4(fract(pos), 1.0);
    }
    rgba = mix(rgba, target, modulate);
    pos += sdfDisplaceScale.xyz * modulate;
  }

  void applyPackedRgbaDisplaceEdit(uvec4 packedEdit, usampler2D sdfTexture, int numSdfs, inout vec3 pos, inout vec4 rgba) {
    int sdfFirst, sdfCount;
    bool invert;
    uint rgbaBlendMode;
    float softEdge, sdfSmooth;
    decodeEdit(packedEdit, sdfFirst, sdfCount, invert, rgbaBlendMode, softEdge, sdfSmooth);
    applyRgbaDisplaceEdit(sdfTexture, numSdfs, sdfFirst, sdfCount, pos, sdfSmooth, softEdge, invert, rgbaBlendMode, rgba);
  }
`);function FI(t,A,e,s){return new P({inTypes:{gsplat:AA,sdfArray:io,numEdits:"int",rgbaDisplaceEdits:"uvec4"},outTypes:{gsplat:AA},globals:()=>[ro,ao],inputs:{gsplat:t,sdfArray:A,numEdits:e,rgbaDisplaceEdits:s},statements:({inputs:i,outputs:r})=>{const{sdfArray:a,numEdits:o,rgbaDisplaceEdits:g}=i,{gsplat:l}=r;return YA(`
        ${l} = ${i.gsplat};
        if (isGsplatActive(${l}.flags)) {
          for (int editIndex = 0; editIndex < ${o}; ++editIndex) {
            applyPackedRgbaDisplaceEdit(
              ${g}[editIndex], ${a}.sdfTexture, ${a}.numSdfs,
              ${l}.center, ${l}.rgba
            );
          }
        }
      `)}}).outputs.gsplat}const wt=new Float32Array(1);class oo{constructor(A){this.modifier=A,this.cache=new Map}apply(A){let e=this.cache.get(A);return e||(e=FA({index:"int"},{gsplat:AA},({index:s})=>{const{gsplat:n}=A.apply({index:s});return this.modifier.apply({gsplat:n})}),this.cache.set(A,e)),e}}class ht{constructor(){this.scale=new Et({value:Number.NEGATIVE_INFINITY}),this.rotate=new Gt({value:new I.Quaternion(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY)}),this.translate=new Nt({value:new I.Vector3(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY)})}apply(A){return Da(A,{scale:this.scale,rotate:this.rotate,translate:this.translate})}applyDir(A){return Ma(A,{rotate:this.rotate})}applyGsplat(A){return ts(A,{scale:this.scale,rotate:this.rotate,translate:this.translate})}updateFromMatrix(A){const e=new I.Vector3,s=new I.Quaternion,n=new I.Vector3;A.decompose(n,s,e);const i=(e.x+e.y+e.z)/3;let r=!1;return i!==this.scale.value&&(this.scale.value=i,r=!0),n.equals(this.translate.value)||(this.translate.value.copy(n),r=!0),s.equals(this.rotate.value)||(this.rotate.value.copy(s),r=!0),r}update(A){return A.updateMatrixWorld(),this.updateFromMatrix(A.matrixWorld)}}class Tt extends I.Object3D{constructor({numSplats:A,generator:e,construct:s,update:n}){if(super(),this.numSplats=A??0,this.generator=e,this.frameUpdate=n,this.version=0,s){const i=s(this);Object.assign(this,i)}}updateVersion(){this.version+=1}set needsUpdate(A){A&&this.updateVersion()}}const st=class st extends Tt{constructor(A={}){const e=new ht,s=new ht,n=new ht,i=new ht,r=new Gt({value:new I.Vector4(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY)}),a=new Et({value:0}),o=new Et({value:0}),g={transform:e,viewToWorld:s,worldToView:n,viewToObject:i,recolor:r,time:a,deltaTime:o};if(super({update:({time:l,deltaTime:c,viewToWorld:u,globalEdits:h})=>this.update({time:l,deltaTime:c,viewToWorld:u,globalEdits:h})}),this.isInitialized=!1,this.recolor=new I.Color(1,1,1),this.opacity=1,this.enableViewToObject=!1,this.enableViewToWorld=!1,this.enableWorldToView=!1,this.skinning=null,this.edits=null,this.rgbaDisplaceEdits=null,this.splatRgba=null,this.maxSh=3,this.packedSplats=A.packedSplats??new HA,this.packedSplats.splatEncoding=A.splatEncoding??{...De},this.numSplats=this.packedSplats.numSplats,this.editable=A.editable??!0,this.onFrame=A.onFrame,this.context=g,this.objectModifier=A.objectModifier,this.worldModifier=A.worldModifier,this.updateGenerator(),A.url||A.fileBytes||A.constructSplats||A.packedSplats&&!A.packedSplats.isInitialized)this.initialized=this.asyncInitialize(A).then(async()=>{if(this.updateGenerator(),this.isInitialized=!0,A.onLoad){const l=A.onLoad(this);l instanceof Promise&&await l}return this});else if(this.isInitialized=!0,this.initialized=Promise.resolve(this),A.onLoad){const l=A.onLoad(this);l instanceof Promise&&(this.initialized=l.then(()=>this))}this.add(_I())}async asyncInitialize(A){const{url:e,fileBytes:s,fileType:n,fileName:i,maxSplats:r,constructSplats:a,splatEncoding:o}=A;if(e||s||a){const g={url:e,fileBytes:s,fileType:n,fileName:i,maxSplats:r,construct:a,splatEncoding:o};this.packedSplats.reinitialize(g)}this.packedSplats&&(await this.packedSplats.initialized,this.numSplats=this.packedSplats.numSplats,this.updateGenerator())}static async staticInitialize(){await Rs(),st.isStaticInitialized=!0}pushSplat(A,e,s,n,i){this.packedSplats.pushSplat(A,e,s,n,i)}forEachSplat(A){this.packedSplats.forEachSplat(A)}dispose(){this.packedSplats.dispose()}getBoundingBox(A=!0){if(!this.initialized)throw new Error("Cannot get bounding box before SplatMesh is initialized");const e=new I.Vector3(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),s=new I.Vector3(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),n=new I.Vector3,i=[-1,1];return this.packedSplats.forEachSplat((a,o,g,l,c,u)=>{if(A)e.min(o),s.max(o);else for(const h of i)for(const E of i)for(const C of i)n.set(h*g.x,E*g.y,C*g.z),n.applyQuaternion(l),n.add(o),e.min(n),s.max(n)}),new I.Box3(e,s)}constructGenerator(A){const{transform:e,viewToObject:s,recolor:n}=A,i=FA({index:"int"},{gsplat:AA},({index:r})=>{if(!r)throw new Error("index is undefined");let a=Ft(this.packedSplats.dyno,r);if(this.maxSh>=1){const{sh1Texture:g,sh2Texture:l,sh3Texture:c}=this.ensureShTextures();if(g){let u=function(p,d){const{x:y,y:D}=pt(d).outputs,x=rA(EA(y,D),J("float",.5)),m=rA(ft(D,y),J("float",.5));return EA(x,rA(p,m))};const h=s.translate,{center:E}=Bt(a).outputs,C=Kr(ft(E,h)),B=UI(a,g,C);let Q=u(B,this.packedSplats.dynoSh1MinMax);if(this.maxSh>=2&&l){const p=GI(a,l,C);Q=EA(Q,u(p,this.packedSplats.dynoSh2MinMax))}if(this.maxSh>=3&&c){const p=RI(a,c,C);Q=EA(Q,u(p,this.packedSplats.dynoSh3MinMax))}let{rgba:f}=Bt(a).outputs;f=EA(f,$r(Q,J("float",0))),a=rt({gsplat:a,rgba:f})}}if(this.splatRgba){const g=Ao(this.splatRgba.dyno,r);a=rt({gsplat:a,rgba:g})}this.skinning&&(a=this.skinning.modify(a)),this.objectModifier&&(a=this.objectModifier.apply({gsplat:a}).gsplat),a=e.applyGsplat(a);const o=rA(n,Bt(a).outputs.rgba);return a=rt({gsplat:a,rgba:o}),this.rgbaDisplaceEdits&&(a=this.rgbaDisplaceEdits.modify(a)),this.worldModifier&&(a=this.worldModifier.apply({gsplat:a}).gsplat),{gsplat:a}});this.generator=i}updateGenerator(){this.constructGenerator(this.context)}update({time:A,viewToWorld:e,deltaTime:s,globalEdits:n}){var B;this.numSplats=this.packedSplats.numSplats,this.context.time.value=A,this.context.deltaTime.value=s,st.dynoTime.value=A;const{transform:i,viewToObject:r,recolor:a}=this.context;let o=i.update(this);this.context.viewToWorld.updateFromMatrix(e)&&this.enableViewToWorld&&(o=!0);const g=e.clone().invert();this.context.worldToView.updateFromMatrix(g)&&this.enableWorldToView&&(o=!0);const u=new I.Matrix4().compose(i.translate.value,i.rotate.value,new I.Vector3().setScalar(i.scale.value)).invert().multiply(e);r.updateFromMatrix(u)&&(this.enableViewToObject||this.packedSplats.extra.sh1)&&(o=!0);const h=new I.Vector4(this.recolor.r,this.recolor.g,this.recolor.b,this.opacity);h.equals(a.value)||(a.value.copy(h),o=!0);const E=this.editable?(this.edits??[]).concat(n):[];this.editable&&!this.edits&&this.traverseVisible(Q=>{Q instanceof Zt&&E.push(Q)}),E.sort((Q,f)=>Q.ordering-f.ordering);const C=E.map(Q=>{if(Q.sdfs!=null)return{edit:Q,sdfs:Q.sdfs};const f=[];return Q.traverseVisible(p=>{p instanceof so&&f.push(p)}),{edit:Q,sdfs:f}});if(C.length>0&&!this.rgbaDisplaceEdits){const Q=C.length,f=C.reduce((p,d)=>p+d.sdfs.length,0);this.rgbaDisplaceEdits=new no({maxEdits:Q,maxSdfs:f}),this.updateGenerator()}if(this.rgbaDisplaceEdits){const Q=this.rgbaDisplaceEdits.update(C);o||(o=Q.updated),Q.dynoUpdated&&this.updateGenerator()}o&&this.updateVersion(),(B=this.onFrame)==null||B.call(this,{mesh:this,time:A,deltaTime:s})}raycast(A,e){var h,E;if(!this.packedSplats.packedArray||!this.packedSplats.numSplats)return;const{near:s,far:n,ray:i}=A,r=this.matrixWorld.clone().invert(),a=new I.Matrix3().setFromMatrix4(r),o=i.origin.clone().applyMatrix4(r),g=i.direction.clone().applyMatrix3(a),l=new I.Vector3;r.decompose(new I.Vector3,new I.Quaternion,l),(l.x*l.y*l.z)**(1/3);const u=ac(o.x,o.y,o.z,g.x,g.y,g.z,s,n,this.packedSplats.numSplats,this.packedSplats.packedArray,!0,((h=this.packedSplats.splatEncoding)==null?void 0:h.lnScaleMin)??TA,((E=this.packedSplats.splatEncoding)==null?void 0:E.lnScaleMax)??kA);for(const C of u){const B=i.direction.clone().multiplyScalar(C).add(i.origin);e.push({distance:C,point:B,object:this})}}ensureShTextures(){if(!this.packedSplats.extra.sh1)return{};let A=this.packedSplats.extra.sh1Texture;if(!A){let n=this.packedSplats.extra.sh1;const{width:i,height:r,depth:a,maxSplats:o}=xA(n.length/2);if(n.length<o*2){const l=new Uint32Array(o*2);l.set(n),this.packedSplats.extra.sh1=l,n=l}const g=new I.DataArrayTexture(n,i,r,a);g.format=I.RGIntegerFormat,g.type=I.UnsignedIntType,g.internalFormat="RG32UI",g.needsUpdate=!0,A=new Kt({value:g,key:"sh1"}),this.packedSplats.extra.sh1Texture=A}if(!this.packedSplats.extra.sh2)return{sh1Texture:A};let e=this.packedSplats.extra.sh2Texture;if(!e){let n=this.packedSplats.extra.sh2;const{width:i,height:r,depth:a,maxSplats:o}=xA(n.length/4);if(n.length<o*4){const l=new Uint32Array(o*4);l.set(n),this.packedSplats.extra.sh2=l,n=l}const g=new I.DataArrayTexture(n,i,r,a);g.format=I.RGBAIntegerFormat,g.type=I.UnsignedIntType,g.internalFormat="RGBA32UI",g.needsUpdate=!0,e=new Kt({value:g,key:"sh2"}),this.packedSplats.extra.sh2Texture=e}if(!this.packedSplats.extra.sh3)return{sh1Texture:A,sh2Texture:e};let s=this.packedSplats.extra.sh3Texture;if(!s){let n=this.packedSplats.extra.sh3;const{width:i,height:r,depth:a,maxSplats:o}=xA(n.length/4);if(n.length<o*4){const l=new Uint32Array(o*4);l.set(n),this.packedSplats.extra.sh3=l,n=l}const g=new I.DataArrayTexture(n,i,r,a);g.format=I.RGBAIntegerFormat,g.type=I.UnsignedIntType,g.internalFormat="RGBA32UI",g.needsUpdate=!0,s=new Kt({value:g,key:"sh3"}),this.packedSplats.extra.sh3Texture=s}return{sh1Texture:A,sh2Texture:e,sh3Texture:s}}};st.staticInitialized=st.staticInitialize(),st.isStaticInitialized=!1,st.dynoTime=new Et({value:0});let ct=st;const NI=CA(`
  vec3 evaluateSH1(Gsplat gsplat, usampler2DArray sh1, vec3 viewDir) {
    // Extract sint7 values packed into 2 x uint32
    uvec2 packed = texelFetch(sh1, splatTexCoord(gsplat.index), 0).rg;
    vec3 sh1_0 = vec3(ivec3(
      int(packed.x << 25u) >> 25,
      int(packed.x << 18u) >> 25,
      int(packed.x << 11u) >> 25
    )) / 63.0;
    vec3 sh1_1 = vec3(ivec3(
      int(packed.x << 4u) >> 25,
      int((packed.x >> 3u) | (packed.y << 29u)) >> 25,
      int(packed.y << 22u) >> 25
    )) / 63.0;
    vec3 sh1_2 = vec3(ivec3(
      int(packed.y << 15u) >> 25,
      int(packed.y << 8u) >> 25,
      int(packed.y << 1u) >> 25
    )) / 63.0;

    return sh1_0 * (-0.4886025 * viewDir.y)
      + sh1_1 * (0.4886025 * viewDir.z)
      + sh1_2 * (-0.4886025 * viewDir.x);
  }
`),TI=CA(`
  vec3 evaluateSH2(Gsplat gsplat, usampler2DArray sh2, vec3 viewDir) {
    // Extract sint8 values packed into 4 x uint32
    uvec4 packed = texelFetch(sh2, splatTexCoord(gsplat.index), 0);
    vec3 sh2_0 = vec3(ivec3(
      int(packed.x << 24u) >> 24,
      int(packed.x << 16u) >> 24,
      int(packed.x << 8u) >> 24
    )) / 127.0;
    vec3 sh2_1 = vec3(ivec3(
      int(packed.x) >> 24,
      int(packed.y << 24u) >> 24,
      int(packed.y << 16u) >> 24
    )) / 127.0;
    vec3 sh2_2 = vec3(ivec3(
      int(packed.y << 8u) >> 24,
      int(packed.y) >> 24,
      int(packed.z << 24u) >> 24
    )) / 127.0;
    vec3 sh2_3 = vec3(ivec3(
      int(packed.z << 16u) >> 24,
      int(packed.z << 8u) >> 24,
      int(packed.z) >> 24
    )) / 127.0;
    vec3 sh2_4 = vec3(ivec3(
      int(packed.w << 24u) >> 24,
      int(packed.w << 16u) >> 24,
      int(packed.w << 8u) >> 24
    )) / 127.0;

    return sh2_0 * (1.0925484 * viewDir.x * viewDir.y)
      + sh2_1 * (-1.0925484 * viewDir.y * viewDir.z)
      + sh2_2 * (0.3153915 * (2.0 * viewDir.z * viewDir.z - viewDir.x * viewDir.x - viewDir.y * viewDir.y))
      + sh2_3 * (-1.0925484 * viewDir.x * viewDir.z)
      + sh2_4 * (0.5462742 * (viewDir.x * viewDir.x - viewDir.y * viewDir.y));
  }
`),kI=CA(`
  vec3 evaluateSH3(Gsplat gsplat, usampler2DArray sh3, vec3 viewDir) {
    // Extract sint6 values packed into 4 x uint32
    uvec4 packed = texelFetch(sh3, splatTexCoord(gsplat.index), 0);
    vec3 sh3_0 = vec3(ivec3(
      int(packed.x << 26u) >> 26,
      int(packed.x << 20u) >> 26,
      int(packed.x << 14u) >> 26
    )) / 31.0;
    vec3 sh3_1 = vec3(ivec3(
      int(packed.x << 8u) >> 26,
      int(packed.x << 2u) >> 26,
      int((packed.x >> 4u) | (packed.y << 28u)) >> 26
    )) / 31.0;
    vec3 sh3_2 = vec3(ivec3(
      int(packed.y << 22u) >> 26,
      int(packed.y << 16u) >> 26,
      int(packed.y << 10u) >> 26
    )) / 31.0;
    vec3 sh3_3 = vec3(ivec3(
      int(packed.y << 4u) >> 26,
      int((packed.y >> 2u) | (packed.z << 30u)) >> 26,
      int(packed.z << 24u) >> 26
    )) / 31.0;
    vec3 sh3_4 = vec3(ivec3(
      int(packed.z << 18u) >> 26,
      int(packed.z << 12u) >> 26,
      int(packed.z << 6u) >> 26
    )) / 31.0;
    vec3 sh3_5 = vec3(ivec3(
      int(packed.z) >> 26,
      int(packed.w << 26u) >> 26,
      int(packed.w << 20u) >> 26
    )) / 31.0;
    vec3 sh3_6 = vec3(ivec3(
      int(packed.w << 14u) >> 26,
      int(packed.w << 8u) >> 26,
      int(packed.w << 2u) >> 26
    )) / 31.0;

    float xx = viewDir.x * viewDir.x;
    float yy = viewDir.y * viewDir.y;
    float zz = viewDir.z * viewDir.z;
    float xy = viewDir.x * viewDir.y;
    float yz = viewDir.y * viewDir.z;
    float zx = viewDir.z * viewDir.x;

    return sh3_0 * (-0.5900436 * viewDir.y * (3.0 * xx - yy))
      + sh3_1 * (2.8906114 * xy * viewDir.z) +
      + sh3_2 * (-0.4570458 * viewDir.y * (4.0 * zz - xx - yy))
      + sh3_3 * (0.3731763 * viewDir.z * (2.0 * zz - 3.0 * xx - 3.0 * yy))
      + sh3_4 * (-0.4570458 * viewDir.x * (4.0 * zz - xx - yy))
      + sh3_5 * (1.4453057 * viewDir.z * (xx - yy))
      + sh3_6 * (-0.5900436 * viewDir.x * (xx - 3.0 * yy));
  }
`);function UI(t,A,e){return ne({inTypes:{gsplat:AA,sh1:"usampler2DArray",viewDir:"vec3"},outTypes:{rgb:"vec3"},inputs:{gsplat:t,sh1:A,viewDir:e},globals:()=>[NA,NI],statements:({inputs:s,outputs:n})=>YA(`
        if (isGsplatActive(${s.gsplat}.flags)) {
          ${n.rgb} = evaluateSH1(${s.gsplat}, ${s.sh1}, ${s.viewDir});
        } else {
          ${n.rgb} = vec3(0.0);
        }
      `)}).outputs.rgb}function GI(t,A,e){return ne({inTypes:{gsplat:AA,sh2:"usampler2DArray",viewDir:"vec3"},outTypes:{rgb:"vec3"},inputs:{gsplat:t,sh2:A,viewDir:e},globals:()=>[NA,TI],statements:({inputs:s,outputs:n})=>YA(`
        if (isGsplatActive(${s.gsplat}.flags)) {
          ${n.rgb} = evaluateSH2(${s.gsplat}, ${s.sh2}, ${s.viewDir});
        } else {
          ${n.rgb} = vec3(0.0);
        }
      `)}).outputs.rgb}function RI(t,A,e){return ne({inTypes:{gsplat:AA,sh3:"usampler2DArray",viewDir:"vec3"},outTypes:{rgb:"vec3"},inputs:{gsplat:t,sh3:A,viewDir:e},globals:()=>[NA,kI],statements:({inputs:s,outputs:n})=>YA(`
        if (isGsplatActive(${s.gsplat}.flags)) {
          ${n.rgb} = evaluateSH3(${s.gsplat}, ${s.sh3}, ${s.viewDir});
        } else {
          ${n.rgb} = vec3(0.0);
        }
      `)}).outputs.rgb}const YI=new I.BufferGeometry,JI=new I.ShaderMaterial;function _I(){const t=new I.Mesh(YI,JI);return t.frustumCulled=!1,t.onBeforeRender=function(A,e){if(!e.isScene){this.removeFromParent();return}let s=!1;e.traverse(n=>{n instanceof Ae&&(s=!0)}),s||e.add(new Ae({renderer:A})),this.removeFromParent()},t}const fs=["char","uchar","short","ushort","int","uint","float","double"],Mt=class Mt{constructor({fileBytes:A}){this.header="",this.littleEndian=!0,this.elements={},this.comments=[],this.data=null,this.numSplats=0,this.fileBytes=A instanceof ArrayBuffer?new Uint8Array(A):A}async parseHeader(){const e=new ReadableStream({start:r=>{r.enqueue(this.fileBytes.slice(0,65536)),r.close()}}).pipeThrough(new TextDecoderStream).getReader();this.header="";const s=`end_header
`;for(;;){const{value:r,done:a}=await e.read();if(a)throw new Error("Failed to read header");this.header+=r;const o=this.header.indexOf(s);if(o>=0){this.header=this.header.slice(0,o+s.length);break}}const n=new TextEncoder().encode(this.header).length;this.data=new DataView(this.fileBytes.buffer,n),this.elements={};let i=null;this.comments=[],this.header.trim().split(`
`).forEach((r,a)=>{const o=r.trim();if(a===0){if(o!=="ply")throw new Error("Invalid PLY header");return}if(o.length===0)return;const g=o.split(" ");switch(g[0]){case"format":if(g[1]==="binary_little_endian")this.littleEndian=!0;else if(g[1]==="binary_big_endian")this.littleEndian=!1;else throw new Error(`Unsupported PLY format: ${g[1]}`);if(g[2]!=="1.0")throw new Error(`Unsupported PLY version: ${g[2]}`);break;case"end_header":break;case"comment":this.comments.push(o.slice(8));break;case"element":{const l=g[1];i={name:l,count:Number.parseInt(g[2]),properties:{}},this.elements[l]=i;break}case"property":if(i==null)throw new Error("Property must be inside an element");g[1]==="list"?i.properties[g[4]]={isList:!0,type:g[3],countType:g[2]}:i.properties[g[2]]={isList:!1,type:g[1]};break}}),this.elements.vertex&&(this.numSplats=this.elements.vertex.count)}parseData(A){let e=0;const s=this.data;if(s==null)throw new Error("No data to parse");for(const n in this.elements){const i=this.elements[n],{count:r,properties:a}=i,o=HI(a),g=qI(a,this.littleEndian),l=A(i)??(()=>{});for(let c=0;c<r;c++)e=g(s,e,o),l(c,o)}}parseSplats(A,e){if(this.elements.vertex==null)throw new Error("No vertex element found");let s=!1;const n=[];let i=0,r=[],a=[],o=[],g,l,c;function u(){const Q=zI[i];r=new Array(3).fill(null).flatMap((f,p)=>[0,1,2].map((d,y)=>p+y*Q/3)),a=new Array(5).fill(null).flatMap((f,p)=>[0,1,2].map((d,y)=>3+p+y*Q/3)),o=new Array(7).fill(null).flatMap((f,p)=>[0,1,2].map((d,y)=>8+p+y*Q/3)),g=i>=1?new Float32Array(3*3):void 0,l=i>=2?new Float32Array(5*3):void 0,c=i>=3?new Float32Array(7*3):void 0}function h(Q,f){if(!g)throw new Error("Missing sh1");const p=f.f_rest;for(let d=0;d<r.length;d++)g[d]=p[r[d]]*8/255-4;if(l)for(let d=0;d<a.length;d++)l[d]=p[a[d]]*8/255-4;if(c)for(let d=0;d<o.length;d++)c[d]=p[o[d]]*8/255-4;e==null||e(Q,g,l,c)}function E(Q){const{min_x:f,min_y:p,min_z:d,max_x:y,max_y:D,max_z:x,min_scale_x:m,min_scale_y:w,min_scale_z:T,max_scale_x:M,max_scale_y:S,max_scale_z:U}=Q.properties;if(!f||!p||!d||!y||!D||!x||!m||!w||!T||!M||!S||!U)throw new Error("Missing PLY chunk properties");return s=!0,(F,b)=>{const{min_x:k,min_y:R,min_z:X,max_x:_,max_y:eA,max_z:q,min_scale_x:Z,min_scale_y:L,min_scale_z:j,max_scale_x:V,max_scale_y:W,max_scale_z:G,min_r:dA,min_g:lA,min_b:yA,max_r:mA,max_g:SA,max_b:BA}=b;n.push({min_x:k,min_y:R,min_z:X,max_x:_,max_y:eA,max_z:q,min_scale_x:Z,min_scale_y:L,min_scale_z:j,max_scale_x:V,max_scale_y:W,max_scale_z:G,min_r:dA,min_g:lA,min_b:yA,max_r:mA,max_g:SA,max_b:BA})}}function C(Q){if(e&&Q.name==="sh")return i=Oe(Q.properties),u(),h;if(Q.name!=="vertex")return null;const{packed_position:f,packed_rotation:p,packed_scale:d,packed_color:y}=Q.properties;if(!f||!p||!d||!y)throw new Error("Missing PLY properties: packed_position, packed_rotation, packed_scale, packed_color");const D=Math.sqrt(2);return(x,m)=>{const w=n[x>>>8];if(w==null)throw new Error("Missing PLY chunk");const{min_x:T,min_y:M,min_z:S,max_x:U,max_y:F,max_z:b,min_scale_x:k,min_scale_y:R,min_scale_z:X,max_scale_x:_,max_scale_y:eA,max_scale_z:q,min_r:Z,min_g:L,min_b:j,max_r:V,max_g:W,max_b:G}=w,{packed_position:dA,packed_rotation:lA,packed_scale:yA,packed_color:mA}=m,SA=(dA>>>21&2047)/2047*(U-T)+T,BA=(dA>>>11&1023)/1023*(F-M)+M,JA=(dA&2047)/2047*(b-S)+S,DA=((lA>>>20&1023)/1023-.5)*D,jA=((lA>>>10&1023)/1023-.5)*D,WA=((lA&1023)/1023-.5)*D,Y=Math.sqrt(Math.max(0,1-DA*DA-jA*jA-WA*WA)),MA=lA>>>30,uA=MA===0?DA:MA===1?Y:jA,Yt=MA<=1?jA:MA===2?Y:WA,ae=MA<=2?WA:Y,vA=MA===0?Y:DA,z=Math.exp((yA>>>21&2047)/2047*(_-k)+k),OA=Math.exp((yA>>>11&1023)/1023*(eA-R)+R),ve=Math.exp((yA&2047)/2047*(q-X)+X),be=(mA>>>24&255)/255*((V??1)-(Z??0))+(Z??0),Fe=(mA>>>16&255)/255*((W??1)-(L??0))+(L??0),Ne=(mA>>>8&255)/255*((G??1)-(j??0))+(j??0),Te=(mA&255)/255;A(x,SA,BA,JA,z,OA,ve,uA,Yt,ae,vA,Te,be,Fe,Ne)}}const B=Q=>{if(Q.name==="chunk")return E(Q);if(s)return C(Q);if(Q.name!=="vertex")return null;const{x:f,y:p,z:d,scale_0:y,scale_1:D,scale_2:x,rot_0:m,rot_1:w,rot_2:T,rot_3:M,opacity:S,f_dc_0:U,f_dc_1:F,f_dc_2:b,red:k,green:R,blue:X,alpha:_}=Q.properties;if(!f||!p||!d)throw new Error("Missing PLY properties: x, y, z");const eA=y&&D&&x,q=m&&w&&T&&M,Z=_!=null?ge[_.type]:1,L=k!=null?ge[k.type]:1,j=R!=null?ge[R.type]:1,V=X!=null?ge[X.type]:1;return i=Oe(Q.properties),u(),(W,G)=>{const dA=eA?Math.exp(G.scale_0):Mt.defaultPointScale,lA=eA?Math.exp(G.scale_1):Mt.defaultPointScale,yA=eA?Math.exp(G.scale_2):Mt.defaultPointScale,mA=q?G.rot_1:0,SA=q?G.rot_2:0,BA=q?G.rot_3:0,JA=q?G.rot_0:1,DA=S!=null?1/(1+Math.exp(-G.opacity)):_!=null?G.alpha/Z:1,jA=U!=null?G.f_dc_0*ce+.5:k!=null?G.red/L:1,WA=F!=null?G.f_dc_1*ce+.5:R!=null?G.green/j:1,Y=b!=null?G.f_dc_2*ce+.5:X!=null?G.blue/V:1;if(A(W,G.x,G.y,G.z,dA,lA,yA,mA,SA,BA,JA,DA,jA,WA,Y),e&&g){const MA=G.f_rest;if(g)for(let uA=0;uA<r.length;uA++)g[uA]=MA[r[uA]];if(l)for(let uA=0;uA<a.length;uA++)l[uA]=MA[a[uA]];if(c)for(let uA=0;uA<o.length;uA++)c[uA]=MA[o[uA]];e(W,g,l,c)}}};this.parseData(B)}injectRgba(A){let e=0;const s=this.data;if(s==null)throw new Error("No parsed data");if(A.length!==this.numSplats*4)throw new Error("Invalid RGBA array length");for(const n in this.elements){const i=this.elements[n],{count:r,properties:a}=i,o=[];let g=0;const l=n==="vertex";if(l){for(const c of["opacity","f_dc_0","f_dc_1","f_dc_2"])if(!a[c]||a[c].type!=="float")throw new Error(`Can't injectRgba due to property: ${c}`)}for(const[c,u]of Object.entries(a))if(u.isList)o.push(()=>{const h=St[u.countType](s,e,this.littleEndian);e+=zA[u.countType],e+=h*zA[u.type]});else{if(l)if(c==="f_dc_0"||c==="f_dc_1"||c==="f_dc_2"){const h=Number.parseInt(c.slice(5));o.push(()=>{const E=(A[g+h]/255-.5)/ce;ds[u.type](s,e,this.littleEndian,E)})}else c==="opacity"&&o.push(()=>{const h=Math.max(-100,Math.min(100,-Math.log(1/(A[g+3]/255)-1)));ds[u.type](s,e,this.littleEndian,h)});o.push(()=>{e+=zA[u.type]})}for(let c=0;c<r;c++){for(const u of o)u();l&&(g+=4)}}}};Mt.defaultPointScale=.001;let jt=Mt;const ce=.28209479177387814,St={char:(t,A,e)=>t.getInt8(A),uchar:(t,A,e)=>t.getUint8(A),short:(t,A,e)=>t.getInt16(A,e),ushort:(t,A,e)=>t.getUint16(A,e),int:(t,A,e)=>t.getInt32(A,e),uint:(t,A,e)=>t.getUint32(A,e),float:(t,A,e)=>t.getFloat32(A,e),double:(t,A,e)=>t.getFloat64(A,e)},ds={char:(t,A,e,s)=>{t.setInt8(A,s)},uchar:(t,A,e,s)=>{t.setUint8(A,s)},short:(t,A,e,s)=>{t.setInt16(A,s,e)},ushort:(t,A,e,s)=>{t.setUint16(A,s,e)},int:(t,A,e,s)=>{t.setInt32(A,s,e)},uint:(t,A,e,s)=>{t.setUint32(A,s,e)},float:(t,A,e,s)=>{t.setFloat32(A,s,e)},double:(t,A,e,s)=>{t.setFloat64(A,s,e)}},zA={char:1,uchar:1,short:2,ushort:2,int:4,uint:4,float:4,double:8},ge={char:127,uchar:255,short:32767,ushort:65535,int:2147483647,uint:4294967295,float:1,double:1},LI={0:0,9:1,24:2,45:3},zI={0:0,1:9,2:24,3:45},ls=/^f_rest_([0-9]{1,2})$/;function HI(t){const A={};for(const[e,s]of Object.entries(t))ls.test(e)?A.f_rest=new Array(Oe(t)):A[e]=s.isList?[]:0;return A}function qI(t,A){return PI(t)?VI(t,A):OI(t,A)}const KI=(()=>{try{new Function("return 42;")}catch{return!1}return!0})(),$I=/^[a-zA-Z0-9_]+$/;function PI(t){if(!KI)return!1;for(const[A,e]of Object.entries(t))if(!$I.test(A)||e.isList&&!fs.includes(e.countType)||!fs.includes(e.type))return!1;return!0}function VI(t,A){const e=["let list;"];for(const[n,i]of Object.entries(t)){const r=n.match(ls);if(r){const a=+r[1];e.push(`
        item.f_rest[${a}] = PARSE_FIELD['${i.type}'](data, offset, ${A});
        offset += ${zA[i.type]};
      `)}else i.isList?e.push(`
        list = item['${n}'];
        list.length = PARSE_FIELD['${i.countType}'](data, offset, ${A});
        offset += ${zA[i.countType]};
        for (let i = 0; i < list.length; i++) {
          list[i] = PARSE_FIELD['${i.type}'](data, offset, ${A});
          offset += ${zA[i.type]};
        }
      `):e.push(`
        item['${n}'] = PARSE_FIELD['${i.type}'](data, offset, ${A});
        offset += ${zA[i.type]};
      `)}e.push("return offset;");const s=new Function("data","offset","item","PARSE_FIELD",e.join(`
`));return(n,i,r)=>s(n,i,r,St)}function OI(t,A){const e=[];for(const[s,n]of Object.entries(t)){const i=s.match(ls);if(i){const r=+i[1];e.push((a,o,g)=>(g.f_rest[r]=St[n.type](a,o,A),o+zA[n.type]))}else n.isList?e.push((r,a,o)=>{const g=o[s];g.length=St[n.countType](r,a,A);let l=a+zA[n.countType];for(let c=0;c<g.length;c++)g[c]=St[n.type](r,l,A),l+=zA[n.type];return l}):e.push((r,a,o)=>(o[s]=St[n.type](r,a,A),a+zA[n.type]))}return(s,n,i)=>{let r=n;for(let a=0;a<e.length;a++)r=e[a](s,r,i);return r}}function Oe(t){let A=0;for(;t[`f_rest_${A}`];)A+=1;const e=LI[A];if(e==null)throw new Error(`Unsupported number of SH coefficients: ${A}`);return e}const co='(function(){"use strict";let xA;const re=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&re.decode();let jA=null;function is(){return(jA===null||jA.byteLength===0)&&(jA=new Uint8Array(xA.memory.buffer)),jA}function ns(s,A){return s=s>>>0,re.decode(is().subarray(s,s+A))}function rs(s,A,t){return xA.sort_splats(s,A,t)>>>0}function gs(s,A,t){return xA.sort32_splats(s,A,t)>>>0}async function os(s,A){if(typeof Response=="function"&&s instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(s,A)}catch(e){if(s.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n",e);else throw e}const t=await s.arrayBuffer();return await WebAssembly.instantiate(t,A)}else{const t=await WebAssembly.instantiate(s,A);return t instanceof WebAssembly.Instance?{instance:t,module:s}:t}}function as(){const s={};return s.wbg={},s.wbg.__wbg_buffer_609cc3eee51ed158=function(A){return A.buffer},s.wbg.__wbg_length_3b4f022188ae8db6=function(A){return A.length},s.wbg.__wbg_length_6ca527665d89694d=function(A){return A.length},s.wbg.__wbg_length_8cfd2c6409af88ad=function(A){return A.length},s.wbg.__wbg_new_9fee97a409b32b68=function(A){return new Uint16Array(A)},s.wbg.__wbg_new_e3b321dcfef89fc7=function(A){return new Uint32Array(A)},s.wbg.__wbg_newwithbyteoffsetandlength_e6b7e69acd4c7354=function(A,t,e){return new Float32Array(A,t>>>0,e>>>0)},s.wbg.__wbg_newwithbyteoffsetandlength_f1dead44d1fc7212=function(A,t,e){return new Uint32Array(A,t>>>0,e>>>0)},s.wbg.__wbg_newwithlength_5a5efe313cfd59f1=function(A){return new Float32Array(A>>>0)},s.wbg.__wbg_set_10bad9bee0e9c58b=function(A,t,e){A.set(t,e>>>0)},s.wbg.__wbg_set_d23661d19148b229=function(A,t,e){A.set(t,e>>>0)},s.wbg.__wbg_set_f4f1f0daa30696fc=function(A,t,e){A.set(t,e>>>0)},s.wbg.__wbg_subarray_3aaeec89bb2544f0=function(A,t,e){return A.subarray(t>>>0,e>>>0)},s.wbg.__wbg_subarray_769e1e0f81bb259b=function(A,t,e){return A.subarray(t>>>0,e>>>0)},s.wbg.__wbindgen_init_externref_table=function(){const A=xA.__wbindgen_export_0,t=A.grow(4);A.set(0,void 0),A.set(t+0,void 0),A.set(t+1,null),A.set(t+2,!0),A.set(t+3,!1)},s.wbg.__wbindgen_memory=function(){return xA.memory},s.wbg.__wbindgen_throw=function(A,t){throw new Error(ns(A,t))},s}function Is(s,A){return xA=s.exports,ge.__wbindgen_wasm_module=A,jA=null,xA.__wbindgen_start(),xA}async function ge(s){if(xA!==void 0)return xA;typeof s<"u"&&(Object.getPrototypeOf(s)===Object.prototype?{module_or_path:s}=s:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof s>"u"&&(s=new URL("data:application/wasm;base64,AGFzbQEAAAABzAEeYAJ/fwF/YAJ/fwBgA39/fwF/YAN/f38AYAF/AX9gAX8AYANvf38Bb2AFf39/f38Bf2AFf39/f38AYAFvAW9gA29vfwBgAW8Bf2AAAGAAAX9gBH9/f38AYAR/f39/AX9gA39vbwF/YAF/AW9gAAFvYAF9AX1gBn9/f39/fwBgDX19fX19fX19f29/fX0Bb2AGf39/f39/AX9gBX9/fX9/AGAEf31/fwBgBX9/fH9/AGAEf3x/fwBgBX9/fn9/AGAEf35/fwBgAn19AX0C8gQRA3diZx1fX3diZ19idWZmZXJfNjA5Y2MzZWVlNTFlZDE1OAAJA3diZxpfX3diZ19uZXdfOWZlZTk3YTQwOWIzMmI2OAAJA3diZxpfX3diZ19zZXRfZjRmMWYwZGFhMzA2OTZmYwAKA3diZx1fX3diZ19sZW5ndGhfOGNmZDJjNjQwOWFmODhhZAALA3diZzFfX3diZ19uZXd3aXRoYnl0ZW9mZnNldGFuZGxlbmd0aF9mMWRlYWQ0NGQxZmM3MjEyAAYDd2JnGl9fd2JnX25ld19lM2IzMjFkY2ZlZjg5ZmM3AAkDd2JnGl9fd2JnX3NldF9kMjM2NjFkMTkxNDhiMjI5AAoDd2JnHV9fd2JnX2xlbmd0aF82Y2E1Mjc2NjVkODk2OTRkAAsDd2JnMV9fd2JnX25ld3dpdGhieXRlb2Zmc2V0YW5kbGVuZ3RoX2U2YjdlNjlhY2Q0YzczNTQABgN3YmcaX193Ymdfc2V0XzEwYmFkOWJlZTBlOWM1OGIACgN3YmcdX193YmdfbGVuZ3RoXzNiNGYwMjIxODhhZThkYjYACwN3YmcfX193Ymdfc3ViYXJyYXlfNzY5ZTFlMGY4MWJiMjU5YgAGA3diZx9fX3diZ19zdWJhcnJheV8zYWFlZWM4OWJiMjU0NGYwAAYDd2JnJF9fd2JnX25ld3dpdGhsZW5ndGhfNWE1ZWZlMzEzY2ZkNTlmMQARA3diZxBfX3diaW5kZ2VuX3Rocm93AAEDd2JnEV9fd2JpbmRnZW5fbWVtb3J5ABIDd2JnH19fd2JpbmRnZW5faW5pdF9leHRlcm5yZWZfdGFibGUADANeXQQAAQcFAgMCEwEBAAABAQAADQABAwgIAwEBBQ0BFA4DAAMBAwIMDAIBAQcDABUBFggXBxkb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wAA2AgBBsJnAAEGomcAANgIAQbyZwABBsJnAADYCAEG4mcAAQbCZwAA2AgBBxJnAAEG4mcAANgIAQcCZwABBuJnAADYCAEHMmcAAQcCZwAA2AgBByJnAAEHAmcAANgIAQdSZwABByJnAADYCAEHcmcAAQdCZwAA2AgBB0JnAAEHImcAANgIAQeSZwABB2JnAADYCAEHYmcAAQdCZwAA2AgBB7JnAAEHgmcAANgIAQeCZwABB2JnAADYCAEH0mcAAQeiZwAA2AgBB6JnAAEHgmcAANgIAQfyZwABB8JnAADYCAEHwmcAAQeiZwAA2AgBBhJrAAEH4mcAANgIAQfiZwABB8JnAADYCAEGMmsAAQYCawAA2AgBBgJrAAEH4mcAANgIAQZSawABBiJrAADYCAEGImsAAQYCawAA2AgBBnJrAAEGQmsAANgIAQZCawABBiJrAADYCAEGkmsAAQZiawAA2AgBBmJrAAEGQmsAANgIAQayawABBoJrAADYCAEGgmsAAQZiawAA2AgBBtJrAAEGomsAANgIAQaiawABBoJrAADYCAEG8msAAQbCawAA2AgBBsJrAAEGomsAANgIAQcSawABBuJrAADYCAEG4msAAQbCawAA2AgBBzJrAAEHAmsAANgIAQcCawABBuJrAADYCAEHkmsAAIAFBD2pBeHEiAEEIayICNgIAQciawABBwJrAADYCAEHcmsAAIARBKGsiAyABIABrakEIaiIANgIAIAIgAEEBcjYCBCABIANqQSg2AgRB8JrAAEGAgIABNgIADAgLIAIgA0kgASACTXINACAAKAIMIgNBAXENACADQQF2IAZGDQMLQfSawABB9JrAACgCACIAIAEgACABSRs2AgAgASAEaiEDQbiYwAAhAAJAAkADQCADIAAoAgAiB0cEQCAAKAIIIgANAQwCCwsgACgCDCIDQQFxDQAgA0EBdiAGRg0BC0G4mMAAIQADQAJAIAIgACgCACIDTwRAIAIgAyAAKAIEaiIHSQ0BCyAAKAIIIQAMAQsLQeSawAAgAUEPakF4cSIAQQhrIgM2AgBB3JrAACAEQShrIgkgASAAa2pBCGoiADYCACADIABBAXI2AgQgASAJakEoNgIEQfCawABBgICAATYCACACIAdBIGtBeHFBCGsiACAAIAJBEGpJGyIDQRs2AgRBuJjAACkCACEK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NgIYIABCBDcCICAAQRhqQZiKwAAQPwALIABBKGogAikDADcCACAAIAApAwg3AiAgACABNgIcIABBATYCGAJAIABBGGoiASgCAEUNACABKAIEIgJFDQAgASgCCCACQQJ0EGELIABBADYCKCAAQQE2AhwgAEG4isAANgIYIABCBDcCICABQcCKwAAQPwALhgIBA38jAEGAAWsiBCQAIAAoAgAhAAJ/AkAgASgCCCICQYCAgBBxRQRAIAJBgICAIHENASAAKAIAIAEQHQwCCyAAKAIAIQBBACECA0AgAiAEakH/AGogAEEPcSIDQTByIANB1wBqIANBCkkbOgAAIAJBAWshAiAAQQ9LIABBBHYhAA0ACyABQcuTwABBAiACIARqQYABakEAIAJrEBQMAQsgACgCACEAQQAhAgNAIAIgBGpB/wBqIABBD3EiA0EwciADQTdqIANBCkkbOgAAIAJBAWshAiAAQQ9LIABBBHYhAA0ACyABQcuTwABBAiACIARqQYABakEAIAJrEBQLIARBgAFqJAALqAICA38BfiMAQUBqIgIkACABKAIAQYCAgIB4RgRAIAEoAgwhAyACQSRqIgRBADYCACACQoCAgIAQNwIcIAJBMGogAygCACIDQQhqKQIANwMAIAJBOGogA0EQaikCADcDACACIAMpAgA3AyggAkEcakGwi8AAIAJBKGoQGBogAkEYaiAEKAIAIgM2AgAgAiACKQIcIgU3AxAgAUEIaiADNgIAIAEgBTcCAAsgASkCACEFIAFCgICAgBA3AgAgAkEIaiIDIAFBCGoiASgCADYCACABQQA2AgBBmZfAAC0AABogAiAFNwMAQQxBBBBZIgFFBEBBBEEMEGoACyABIAIpAwA3AgAgAUEIaiADKAIANgIAIABBqI7AADYCBCAAIAE2AgAgAkFAayQAC9QBAgR/AX4jAEEgayIDJAACQAJAIAEgASACaiICSwRAQQAhAQwBC0EAIQFBCCACIAAoAgAiBUEBdCIEIAIgBEsbIgIgAkEITRsiBK0iB0IgiFBFDQAgB6ciBkH/////B0sNACADIAUEfyADIAU2AhwgAyAAKAIENgIUQQEFQQALNgIYIANBCGpBASAGIANBFGoQLyADKAIIQQFHDQEgAygCECECIAMoAgwhAQsgASACQaCLwAAQTAALIAMoAgwhASAAIAQ2AgAgACABNgIEIANBIGokAAvuAQIEfwF+IwBBIGsiBSQAAkACQCABIAEgAmoiAksEQEEAIQEMAQtBACEBIAMgBGpBAWtBACADa3GtQQQgAiAAKAIAIgdBAXQiBiACIAZLGyICIAJBBE0bIgatfiIJQiCIUEUNACAJpyIIQYCAgIB4IANrSw0AQQAhAiAFIAcEfyAFIAQgB2w2AhwgBSAAKAIENgIUIAMFIAILNgIYIAVBCGogAyAIIAVBFGoQLyAFKAIIQQFHDQEgBSgCECECIAUoAgwhAQsgASACQdCAwAAQTAALIAUoAgwhASAAIAY2AgAgACABNgIEIAVBIGokAAuVAgECfyMAQSBrIgUkAEG0l8AAQbSXwAAoAgAiBkEBajYCAAJ/QQAgBkEASA0AGkEBQYCbwAAtAAANABpBgJvAAEEBOgAAQfyawABB/JrAACgCAEEBajYCAEECC0H/AXEiBkECRwRAIAZBAXEEQCAFQQhqIAAgASgCGBEBAAsACwJAQaiXwAAoAgAiBkEATgRAQaiXwAAgBkEBajYCAEGsl8AAKAIABEAgBSAAIAEoAhQRAQAgBSAEOgAdIAUgAzoAHCAFIAI2AhggBSAFKQMANwIQQayXwAAoAgAgBUEQakGwl8AAKAIAKAIUEQEAC0Gol8AAQaiXwAAoAgBBAWs2AgBBgJvAAEEAOgAAIANFDQEACwALAAu6AQECfyMAQSBrIgMkAAJAAn9BACABIAEgAmoiAksNABpBAEEIIAIgACgCACIBQQF0IgQgAiAESxsiAiACQQhNGyIEQQBIDQAaQQAhAiADIAEEfyADIAE2AhwgAyAAKAIENgIUQQEFIAILNgIYIANBCGpBASAEIANBFGoQLyADKAIIQQFHDQEgAygCECEAIAMoAgwLIABB3I/AABBMAAsgAygCDCEBIAAgBDYCACAAIAE2AgQgA0EgaiQAC7kBAQV/IwBBIGsiAiQAIAAoAgAiBEH/////AUsEQEEAQQAgARBMAAsCQEEEIARBAXQiBSAFQQRNGyIFQQJ0IgZB/P///wdNBH8gAiAEBH8gAiAEQQJ0NgIcIAIgACgCBDYCFEEEBSADCzYCGCACQQhqQQQgBiACQRRqEC8gAigCCEEBRw0BIAIoAhAhAyACKAIMBSADCyADIAEQTAALIAIoAgwhASAAIAU2AgAgACABNgIEIAJBIGokAAvBAQIDfwF+IwBBMGsiAiQAIAEoAgBBgICAgHhGBEAgASgCDCEDIAJBFGoiBEEANgIAIAJCgICAgBA3AgwgAkEgaiADKAIAIgNBCGopAgA3AwAgAkEoaiADQRBqKQIANwMAIAIgAykCADcDGCACQQxqQbCLwAAgAkEYahAYGiACQQhqIAQoAgAiAzYCACACIAIpAgwiBTcDACABQQhqIAM2AgAgASAFNwIACyAAQaiOwAA2AgQgACABNgIAIAJBMGokAAuvAQEGfwJAAkAgAEGEAUkNACAA0G8mARAiIgEoAgwhBSABKAIQIQIgAUIANwIMIAEoAgghAyABKAIEIQQgAUIENwIEIAEoAgAhBiABQQA2AgAgACACSQ0BIAAgAmsiACADTw0BIAQgAEECdGogBTYCACABIAI2AhAgASAANgIMIAEgAzYCCCABKAIEIAEgBDYCBCABKAIAIQAgASAGNgIAIABFDQAgAEECdBBhCw8LAAvOAwIMfwF+IwBBIGsiBCQAIARBGGoiCRAiIgVBEGoiBygCADYCACAEQRBqIgogBUEIaiIIKQIANwMAIAdBADYCACAIQgA3AgAgBSkCACEMIAVCgICAgMAANwIAIAQgDDcDCAJ/IwBBIGsiAyQAAkACQCAEQQhqIgAoAgwiASAAKAIIIgJGBEACQCAAKAIAIgIgAUYEQNBvQYABIAEgAUGAAU0bIgb8DwEiAkF/Rg0EAkAgACgCECILRQRAIAAgAjYCEAwBCyABIAtqIAJHDQULIAEgBmoiAkH/////AUsNBCADIAEEfyADIAFBAnQ2AhwgAyAAKAIENgIUQQQFQQALNgIYIANBCGpBBCACQQJ0IANBFGoQLyADKAIIQQFGDQQgAygCDCEGIAAgAjYCACAAIAY2AgQMAQsgASACTw0DCyAAIAFBAWoiAjYCCCAAKAIEIAFBAnRqIAI2AgAMAQsgASACTw0BCyAAIAAoAgQgAUECdGooAgA2AgwgACgCECADQSBqJAAgAWoMAQsACyAIIAopAwA3AgAgByAJKAIANgIAIAUoAgQhAyAFKAIAIQEgBSAEKQMINwIAIAEEQCADIAFBAnQQYQsgBEEgaiQAC7YBAQN/IAEoAgwhAgJAAkACQAJAAkACQCABKAIEDgIAAQILIAINAUEBIQNBACEBQQEhAgwDCyACRQ0BCyAAIAEQGw8LIAEoAgAiAigCBCIBQQBIDQEgAigCACEDIAFFBEBBASECQQAhAQwBC0GZl8AALQAAGkEBIQQgAUEBEFkiAkUNAQsgAQRAIAIgAyAB/AoAAAsgACABNgIIIAAgAjYCBCAAIAE2AgAPCyAEIAFB1ILAABBMAAuoAQEBfyMAQRBrIgYkAAJAIAEEQCAGQQRqIAEgAyAEIAUgAigCEBEIAAJAIAYoAgQiAiAGKAIMIgFNBEAgBigCCCEFDAELIAJBAnQhAiAGKAIIIQMgAUUEQEEEIQUgAyACEGEMAQsgAyACQQQgAUECdCICEFAiBUUNAgsgACABNgIEIAAgBTYCACAGQRBqJAAPC0HUiMAAQTIQZQALQQQgAkHEiMAAEEwAC40BAQF/IAJBAE4EQAJ/IAMoAgQEQAJAIAMoAggiBEUEQAwBCyADKAIAIAQgASACEFAMAgsLIAEgAkUNABpBmZfAAC0AABogAiABEFkLIgNFBEAgACACNgIIIAAgATYCBCAAQQE2AgAPCyAAIAI2AgggACADNgIEIABBADYCAA8LIABBADYCBCAAQQE2AgALlwECBH8BbyMAQSBrIgMkACAAKAIAIgYQbSEAIAMgAjYCBCADIAA2AgAgACACRgRAEFciBBBPIgUlASABIAIQBCEHECwiACAHJgEgBEGEAU8EQCAEECsLIAVBhAFPBEAgBRArCyAGIABBABBgIABBhAFPBEAgABArCyADQSBqJAAPCyADQQA2AgggAyADQQRqIANBCGoQPAALeQEBfyMAQSBrIgIkAAJ/IAAoAgBBgICAgHhHBEAgASAAKAIEIAAoAggQUgwBCyACQRBqIAAoAgwoAgAiAEEIaikCADcDACACQRhqIABBEGopAgA3AwAgAiAAKQIANwMIIAEoAgAgASgCBCACQQhqEBgLIAJBIGokAAtpAgF/AX4jAEEwayIDJAAgAyABNgIEIAMgADYCACADQQI2AgwgA0GEksAANgIIIANCAjcCFCADQoCAgIDQACIEIAOthDcDKCADIAQgA0EEaq2ENwMgIAMgA0EgajYCECADQQhqIAIQPwALaAAjAEEwayIAJABBmJfAAC0AAEUEQCAAQTBqJAAPCyAAQQI2AgwgAEHwjcAANgIIIABCATcCFCAAIAE2AiwgACAAQSxqrUKAgICA0ACENwMgIAAgAEEgajYCECAAQQhqQZiOwAAQPwALlAECA38BbyMAQSBrIgMkACADIAAoAgAQbSIENgIAIAMgAjYCBCACIARHBEAgA0EANgIIIAMgA0EEaiADQQhqEDwACxBXIgQQTyIFJQEQBSEGECwiAiAGJgEgBUGEAU8EQCAFECsLIAIgACgCACABQQJ2EGAgAkGEAU8EQCACECsLIARBhAFPBEAgBBArCyADQSBqJAALRwEBfyAAKAIAIAAoAggiA2sgAkkEQCAAIAMgAhAlIAAoAgghAwsgAgRAIAAoAgQgA2ogASAC/AoAAAsgACACIANqNgIIQQALTwEBfyMAQTBrIgAkACAAQQE2AgwgAEHEjcAANgIIIABCATcCFCAAIABBL2qtQoCAgICwAoQ3AyAgACAAQSBqNgIQIABBCGpB6IHAABA/AAtPAQF/IwBBMGsiACQAIABBATYCDCAAQciRwAA2AgggAEIBNwIUIAAgAEEvaq1CgICAgJAFhDcDICAAIABBIGo2AhAgAEEIakH4gcAAED8AC0cBAX8gACgCACAAKAIIIgNrIAJJBEAgACADIAIQKCAAKAIIIQMLIAIEQCAAKAIEIANqIAEgAvwKAAALIAAgAiADajYCCEEAC00BAn9BmZfAAC0AABogASgCBCECIAEoAgAhA0EIQQQQWSIBRQRAQQRBCBBqAAsgASACNgIEIAEgAzYCACAAQbiOwAA2AgQgACABNgIAC0EBAX8jAEEgayICJAAgAkEANgIQIAJBATYCBCACQgQ3AgggAkEuNgIcIAIgADYCGCACIAJBGGo2AgAgAiABED8ACzgAAkAgAkGAgMQARg0AIAAgAiABKAIQEQAARQ0AQQEPCyADRQRAQQAPCyAAIAMgBCABKAIMEQIAC9gCAQF/IwBBEGsiAyQAIAMgATYCDCADIAA2AggjAEHwAGsiACQAIABBlJLAADYCDCAAIANBCGo2AgggAEGUksAANgIUIAAgA0EMajYCECAAQeSVwAAoAgA2AhwgAEHYlcAAKAIANgIYAkAgAigCAARAIABBMGogAkEQaikCADcDACAAQShqIAJBCGopAgA3AwAgACACKQIANwMgIABBBDYCXCAAQZSTwAA2AlggAEIENwJkIAAgAEEQaq1CgICAgKAFhDcDUCAAIABBCGqtQoCAgICgBYQ3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ACAIJQEgCBArC/oBAgJ/AX4jAEEQayICJAAgAkEBOwEMIAIgATYCCCACIAA2AgQjAEEQayIBJAAgAkEEaiIAKQIAIQQgASAANgIMIAEgBDcCBCMAQRBrIgAkACABQQRqIgEoAgAiAigCDCEDAkACQAJAAkAgAigCBA4CAAECCyADDQFBASECQQAhAwwCCyADDQAgAigCACICKAIEIQMgAigCACECDAELIABBgICAgHg2AgAgACABNgIMIABB5I7AACABKAIEIAEoAggiAC0ACCAALQAJECcACyAAIAM2AgQgACACNgIAIABByI7AACABKAIEIAEoAggiAC0ACCAALQAJECcACyQAIABFBEBB1IjAAEEyEGUACyAAIAIgAyAEIAUgASgCEBEHAAsiACAARQRAQdSIwABBMhBlAAsgACACIAMgBCABKAIQEQ4ACyIAIABFBEBB1IjAAEEyEGUACyAAIAIgAyAEIAEoAhARGAALIgAgAEUEQEHUiMAAQTIQZQALIAAgAiADIAQgASgCEBEPAAsiACAARQRAQdSIwABBMhBlAAsgACACIAMgBCABKAIQERoACyIAIABFBEBB1IjAAEEyEGUACyAAIAIgAyAEIAEoAhARHAALJQEBfyAAKAIAIgFBgICAgHhyQYCAgIB4RwRAIAAoAgQgARBhCwsgACAARQRAQdSIwABBMhBlAAsgACACIAMgASgCEBEDAAseACAARQRAQdSIwABBMhBlAAsgACACIAEoAhARAAALrw8BEX8QLCIDIAEmARAsIgQgAiYBIwBBIGsiCyQAIAsgBDYCCCALIAM2AgQgCyAANgIAIAsgC0EEaiIAKAIAEGw2AgwgCyALQQhqNgIcIAsgCzYCGCALIAA2AhQgCyALQQxqNgIQIAtBEGohACMAQdAAayIGJAACQAJAAkACQAJAQQBBjIHAACgCABEEACIPBEAgDygCAA0BIAAoAgwhESAAKAIIIQggD0F/NgIAIAAoAgQgACgCACgCACIFIA9BBGoiDiIEKAIIIgNLBEAgBSADIgBrIgkgBCgCACAAa0sEQCAEIAAgCUECQQIQJiAEKAIIIQALIAQoAgQiByAAQQF0aiEKIAlBAk8EQCAFIANBf3NqQQF0IgwEQCAKQQAgDPwLAAsgACAFakEBdCADQQF0ayAHakECayEKIAAgCWpBAWsh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EAAcAAAARQAAAC0AAADUARAAHAAAAF4AAAAoAAAAc3BhcmstaW50ZXJuYWwtcnNcc3JjXHNvcnQucnMAAABIAhAAHQAAABsAAAAdAAAARXhwZWN0ZWQgIGFjdGl2ZSBzcGxhdHMgYnV0IGdvdCB4AhAACQAAAIECEAAXAAAASAIQAB0AAAAzAAAAHQAAAEgCEAAdAAAAMwAAABUAAABIAhAAHQAAACQAAAAUAAAASAIQAB0AAAB0AAAAGQAAAEgCEAAdAAAApwAAABMAAABIAhAAHQAAAJ8AAAATAAAASAIQAB0AAACiAAAAHQAAAEgCEAAdAAAAogAAABEAAABIAhAAHQAAAJAAAAAgAAAASAIQAB0AAACQAAAAFAAAAEgCEAAdAAAAfAAAABgAAABIAhAAHQAAAH0AAAAYAAAAQzpcVXNlcnNcS2FsaVwuY2FyZ29ccmVnaXN0cnlcc3JjXGluZGV4LmNyYXRlcy5pby0xOTQ5Y2Y4YzZiNWI1NTdmXGpzLXN5cy0wLjMuNzdcc3JjXGxpYi5ycwBoAxAAWwAAAPsYAAABAAAAQzpcVXNlcnNcS2FsaVwuY2FyZ29ccmVnaXN0cnlcc3JjXGluZGV4LmNyYXRlcy5pby0xOTQ5Y2Y4YzZiNWI1NTdmXHdhc20tYmluZGdlbi0wLjIuMTAwXHNyY1xjb252ZXJ0XHNsaWNlcy5ycwAAANQDEABtAAAAJAEAAA4AAABjbG9zdXJlIGludm9rZWQgcmVjdXJzaXZlbHkgb3IgYWZ0ZXIgYmVpbmcgZHJvcHBlZExhenkgaW5zdGFuY2UgaGFzIHByZXZpb3VzbHkgYmVlbiBwb2lzb25lZIYEEAAqAAAAQzpcVXNlcnNcS2FsaVwuY2FyZ29ccmVnaXN0cnlcc3JjXGluZGV4LmNyYXRlcy5pby0xOTQ5Y2Y4YzZiNWI1NTdmXG9uY2VfY2VsbC0xLjIxLjNcc3JjXGxpYi5ycwAAuAQQAF4AAAAIAwAAGQAAAHJlZW50cmFudCBpbml0AAAoBRAADgAAALgEEABeAAAAegIAAA0AAAAvcnVzdGMvNmIwMGJjMzg4MDE5ODYwMDEzMGUxY2Y2MmI4ZjhhOTM0OTQ0ODhjYy9saWJyYXJ5L2FsbG9jL3NyYy9yYXdfdmVjL21vZC5yc1AFEABQAAAALgIAABEAAAAVAAAADAAAAAQAAAAWAAAAFwAAABgAAAAvcnVzdC9kZXBzL2RsbWFsbG9jLTAuMi44L3NyYy9kbG1hbGxvYy5yc2Fzc2VydGlvbiBmYWlsZWQ6IHBzaXplID49IHNpemUgKyBtaW5fb3ZlcmhlYWQAyAUQACkAAACsBAAACQAAAGFzc2VydGlvbiBmYWlsZWQ6IHBzaXplIDw9IHNpemUgKyBtYXhfb3ZlcmhlYWQAAMgFEAApAAAAsgQAAA0AAABBY2Nlc3NFcnJvcmNhbm5vdCBhY2Nlc3MgYSBUaHJlYWQgTG9jYWwgU3RvcmFnZSB2YWx1ZSBkdXJpbmcgb3IgYWZ0ZXIgZGVzdHJ1Y3Rpb246IAB7BhAASAAAAG1lbW9yeSBhbGxvY2F0aW9uIG9mICBieXRlcyBmYWlsZWQAAMwGEAAVAAAA4QYQAA0AAABsaWJyYXJ5L3N0ZC9zcmMvYWxsb2MucnMABxAAGAAAAGQBAAAJAAAAFQAAAAwAAAAEAAAAGQAAAAAAAAAIAAAABAAAABoAAAAAAAAACAAAAAQAAAAbAAAAHAAAAB0AAAAeAAAAHwAAABAAAAAEAAAAIAAAACEAAAAiAAAAIwAAAEVycm9yAAAAJAAAAAwAAAAEAAAAJQAAACYAAAAnAAAAY2FwYWNpdHkgb3ZlcmZsb3cAAACgBxAAEQAAAGxpYnJhcnkvYWxsb2Mvc3JjL3Jhd192ZWMvbW9kLnJzvAcQACAAAAAuAgAAEQAAAGxpYnJhcnkvYWxsb2Mvc3JjL3N0cmluZy5ycwDsBxAAGwAAAOgBAAAXAEGgkMAAC9gFAQAAACgAAABhIGZvcm1hdHRpbmcgdHJhaXQgaW1wbGVtZW50YXRpb24gcmV0dXJuZWQgYW4gZXJyb3Igd2hlbiB0aGUgdW5kZXJseWluZyBzdHJlYW0gZGlkIG5vdGxpYnJhcnkvYWxsb2Mvc3JjL2ZtdC5ycwAAfggQABgAAACKAgAADgAAAEJvcnJvd011dEVycm9yYWxyZWFkeSBib3Jyb3dlZDogtggQABIAAABpbmRleCBvdXQgb2YgYm91bmRzOiB0aGUgbGVuIGlzICBidXQgdGhlIGluZGV4IGlzIAAA0AgQACAAAADwCBAAEgAAAAAAAAAEAAAABAAAAC0AAAA9PSE9bWF0Y2hlc2Fzc2VydGlvbiBgbGVmdCAgcmlnaHRgIGZhaWxlZAogIGxlZnQ6IAogcmlnaHQ6IAAvCRAAEAAAAD8JEAAXAAAAVgkQAAkAAAAgcmlnaHRgIGZhaWxlZDogCiAgbGVmdDogAAAALwkQABAAAAB4CRAAEAAAAIgJEAAJAAAAVgkQAAkAAAA6IAAAAQAAAAAAAAC0CRAAAgAAAH0gfTB4MDAwMTAyMDMwNDA1MDYwNzA4MDkxMDExMTIxMzE0MTUxNjE3MTgxOTIwMjEyMjIzMjQyNTI2MjcyODI5MzAzMTMyMzMzNDM1MzYzNzM4Mzk0MDQxNDI0MzQ0NDU0NjQ3NDg0OTUwNTE1MjUzNTQ1NTU2NTc1ODU5NjA2MTYyNjM2NDY1NjY2NzY4Njk3MDcxNzI3Mzc0NzU3Njc3Nzg3OTgwODE4MjgzODQ4NTg2ODc4ODg5OTA5MTkyOTM5NDk1OTY5Nzk4OTkgb3V0IG9mIHJhbmdlIGZvciBzbGljZSBvZiBsZW5ndGggcmFuZ2UgZW5kIGluZGV4IAC3ChAAEAAAAJUKEAAiAAAAJAkQACYJEAAoCRAAAgAAAAIAAAAHAAAAAAAAPwAAAL8AQZCWwAALARIAfAlwcm9kdWNlcnMCCGxhbmd1YWdlAQRSdXN0AAxwcm9jZXNzZWQtYnkDBXJ1c3RjHTEuODguMCAoNmIwMGJjMzg4IDIwMjUtMDYtMjMpBndhbHJ1cwYwLjIzLjMMd2FzbS1iaW5kZ2VuEzAuMi4xMDAgKDI0MDVlYzJiNCkAaw90YXJnZXRfZmVhdHVyZXMGKw9tdXRhYmxlLWdsb2JhbHMrE25vbnRyYXBwaW5nLWZwdG9pbnQrC2J1bGstbWVtb3J5KwhzaWduLWV4dCsPcmVmZXJlbmNlLXR5cGVzKwptdWx0aXZhbHVl",self.location.href));const A=as();(typeof s=="string"||typeof Request=="function"&&s instanceof Request||typeof URL=="function"&&s instanceof URL)&&(s=fetch(s));const{instance:t,module:e}=await os(await s,A);return Is(t,e)}var oe={},Cs=function(s,A,t,e,i){var n=new Worker(oe[A]||(oe[A]=URL.createObjectURL(new Blob([s+\';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})\'],{type:"text/javascript"}))));return n.onmessage=function(r){var g=r.data,o=g.$e$;if(o){var a=new Error(o[0]);a.code=o[1],a.stack=o[2],i(a,null)}else i(null,g)},n.postMessage(t,e),n},O=Uint8Array,bA=Uint16Array,ae=Int32Array,Mt=new O([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),dt=new O([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ie=new O([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ce=function(s,A){for(var t=new bA(31),e=0;e<31;++e)t[e]=A+=1<<s[e-1];for(var i=new ae(t[30]),e=1;e<30;++e)for(var n=t[e];n<t[e+1];++n)i[n]=n-t[e]<<5|e;return{b:t,r:i}},Be=Ce(Mt,2),Nt=Be.b,Bs=Be.r;Nt[28]=258,Bs[258]=28;for(var hs=Ce(dt,0),he=hs.b,ot=new bA(32768),X=0;X<32768;++X){var dA=(X&43690)>>1|(X&21845)<<1;dA=(dA&52428)>>2|(dA&13107)<<2,dA=(dA&61680)>>4|(dA&3855)<<4,ot[X]=((dA&65280)>>8|(dA&255)<<8)>>1}for(var TA=function(s,A,t){for(var e=s.length,i=0,n=new bA(A);i<e;++i)s[i]&&++n[s[i]-1];var r=new bA(A);for(i=1;i<A;++i)r[i]=r[i-1]+n[i-1]<<1;var g;if(t){g=new bA(1<<A);var o=15-A;for(i=0;i<e;++i)if(s[i])for(var a=i<<4|s[i],I=A-s[i],C=r[s[i]-1]++<<I,h=C|(1<<I)-1;C<=h;++C)g[ot[C]>>o]=a}else for(g=new bA(e),i=0;i<e;++i)s[i]&&(g[i]=ot[r[s[i]-1]++]>>15-s[i]);return g},$A=new O(288),X=0;X<144;++X)$A[X]=8;for(var X=144;X<256;++X)$A[X]=9;for(var X=256;X<280;++X)$A[X]=7;for(var X=280;X<288;++X)$A[X]=8;for(var Ee=new O(32),X=0;X<32;++X)Ee[X]=5;var Qe=TA($A,9,1),ce=TA(Ee,5,1),at=function(s){for(var A=s[0],t=1;t<s.length;++t)s[t]>A&&(A=s[t]);return A},hA=function(s,A,t){var e=A/8|0;return(s[e]|s[e+1]<<8)>>(A&7)&t},It=function(s,A){var t=A/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(A&7)},kt=function(s){return(s+7)/8|0},NA=function(s,A,t){return(A==null||A<0)&&(A=0),(t==null||t>s.length)&&(t=s.length),new O(s.subarray(A,t))},le=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],V=function(s,A,t){var e=new Error(A||le[s]);if(e.code=s,Error.captureStackTrace&&Error.captureStackTrace(e,V),!t)throw e;return e},Yt=function(s,A,t,e){var i=s.length,n=e?e.length:0;if(!i||A.f&&!A.l)return t||new O(0);var r=!t,g=r||A.i!=2,o=A.i;r&&(t=new O(i*3));var a=function(gA){var IA=t.length;if(gA>IA){var CA=new O(Math.max(IA*2,gA));CA.set(t),t=CA}},I=A.f||0,C=A.p||0,h=A.b||0,B=A.l,E=A.d,u=A.m,l=A.n,Q=i*8;do{if(!B){I=hA(s,C,1);var y=hA(s,C+1,3);if(C+=3,y)if(y==1)B=Qe,E=ce,u=9,l=5;else if(y==2){var d=hA(s,C,31)+257,z=hA(s,C+10,15)+4,m=d+hA(s,C+5,31)+1;C+=14;for(var w=new O(m),Y=new O(19),D=0;D<z;++D)Y[Ie[D]]=hA(s,C+D*3,7);C+=z*3;for(var x=at(Y),M=(1<<x)-1,F=TA(Y,x,1),D=0;D<m;){var S=F[hA(s,C,M)];C+=S&15;var c=S>>4;if(c<16)w[D++]=c;else{var G=0,T=0;for(c==16?(T=3+hA(s,C,3),C+=2,G=w[D-1]):c==17?(T=3+hA(s,C,7),C+=3):c==18&&(T=11+hA(s,C,127),C+=7);T--;)w[D++]=G}}var q=w.subarray(0,d),v=w.subarray(d);u=at(q),l=at(v),B=TA(q,u,1),E=TA(v,l,1)}else V(1);else{var c=kt(C)+4,f=s[c-4]|s[c-3]<<8,p=c+f;if(p>i){o&&V(0);break}g&&a(h+f),t.set(s.subarray(c,p),h),A.b=h+=f,A.p=C=p*8,A.f=I;continue}if(C>Q){o&&V(0);break}}g&&a(h+131072);for(var W=(1<<u)-1,Z=(1<<l)-1,P=C;;P=C){var G=B[It(s,C)&W],H=G>>4;if(C+=G&15,C>Q){o&&V(0);break}if(G||V(2),H<256)t[h++]=H;else if(H==256){P=C,B=null;break}else{var K=H-254;if(H>264){var D=H-257,R=Mt[D];K=hA(s,C,(1<<R)-1)+Nt[D],C+=R}var _=E[It(s,C)&Z],N=_>>4;_||V(3),C+=_&15;var v=he[N];if(N>3){var R=dt[N];v+=It(s,C)&(1<<R)-1,C+=R}if(C>Q){o&&V(0);break}g&&a(h+131072);var sA=h+K;if(h<v){var iA=n-v,aA=Math.min(v,sA);for(iA+h<0&&V(3);h<aA;++h)t[h]=e[iA+h]}for(;h<sA;++h)t[h]=t[h-v]}}A.l=B,A.p=P,A.b=h,A.f=I,B&&(I=1,A.m=u,A.d=E,A.n=l)}while(!I);return h!=t.length&&r?NA(t,0,h):t.subarray(0,h)},Es=new O(0),Qs=function(s,A){var t={};for(var e in s)t[e]=s[e];for(var e in A)t[e]=A[e];return t},ue=function(s,A,t){for(var e=s(),i=s.toString(),n=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\\s+/g,"").split(","),r=0;r<e.length;++r){var g=e[r],o=n[r];if(typeof g=="function"){A+=";"+o+"=";var a=g.toString();if(g.prototype)if(a.indexOf("[native code]")!=-1){var I=a.indexOf(" ",8)+1;A+=a.slice(I,a.indexOf("(",I))}else{A+=a;for(var C in g.prototype)A+=";"+o+".prototype."+C+"="+g.prototype[C].toString()}else A+=a}else t[o]=g}return A},Ct=[],cs=function(s){var A=[];for(var t in s)s[t].buffer&&A.push((s[t]=new s[t].constructor(s[t])).buffer);return A},ls=function(s,A,t,e){if(!Ct[t]){for(var i="",n={},r=s.length-1,g=0;g<r;++g)i=ue(s[g],i,n);Ct[t]={c:ue(s[r],i,n),e:n}}var o=Qs({},Ct[t].e);return Cs(Ct[t].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+A.toString()+"}",t,o,cs(o),e)},us=function(){return[O,bA,ae,Mt,dt,Ie,Nt,he,Qe,ce,ot,le,TA,at,hA,It,kt,NA,V,Yt,Bt,fe,ye]},fe=function(s){return postMessage(s,[s.buffer])},ye=function(s){return s&&{out:s.size&&new O(s.size),dictionary:s.dictionary}},fs=function(s,A,t,e,i,n){var r=ls(t,e,i,function(g,o){r.terminate(),n(g,o)});return r.postMessage([s,A],A.consume?[s.buffer]:[]),function(){r.terminate()}},uA=function(s,A){return s[A]|s[A+1]<<8},tA=function(s,A){return(s[A]|s[A+1]<<8|s[A+2]<<16|s[A+3]<<24)>>>0},Gt=function(s,A){return tA(s,A)+tA(s,A+4)*4294967296},ys=function(s){(s[0]!=31||s[1]!=139||s[2]!=8)&&V(6,"invalid gzip data");var A=s[3],t=10;A&4&&(t+=(s[10]|s[11]<<8)+2);for(var e=(A>>3&1)+(A>>4&1);e>0;e-=!s[t++]);return t+(A&2)},Ut=function(){function s(A,t){typeof A=="function"&&(t=A,A={}),this.ondata=t;var e=A&&A.dictionary&&A.dictionary.subarray(-32768);this.s={i:0,b:e?e.length:0},this.o=new O(32768),this.p=new O(0),e&&this.o.set(e)}return s.prototype.e=function(A){if(this.ondata||V(5),this.d&&V(4),!this.p.length)this.p=A;else if(A.length){var t=new O(this.p.length+A.length);t.set(this.p),t.set(A,this.p.length),this.p=t}},s.prototype.c=function(A){this.s.i=+(this.d=A||!1);var t=this.s.b,e=Yt(this.p,this.s,this.o);this.ondata(NA(e,t,this.s.b),this.d),this.o=NA(e,this.s.b-32768),this.s.b=this.o.length,this.p=NA(this.p,this.s.p/8|0),this.s.p&=7},s.prototype.push=function(A,t){this.e(A),this.c(t)},s}();function ws(s,A,t){return t||(t=A,A={}),typeof t!="function"&&V(7),fs(s,A,[us],function(e){return fe(Bt(e.data[0],ye(e.data[1])))},1,t)}function Bt(s,A){return Yt(s,{i:2},A&&A.out,A&&A.dictionary)}var ms=function(){function s(A,t){this.v=1,this.r=0,Ut.call(this,A,t)}return s.prototype.push=function(A,t){if(Ut.prototype.e.call(this,A),this.r+=A.length,this.v){var e=this.p.subarray(this.v-1),i=e.length>3?ys(e):4;if(i>e.length){if(!t)return}else this.v>1&&this.onmember&&this.onmember(this.r-e.length);this.p=e.subarray(i),this.v=0}Ut.prototype.c.call(this,t),this.s.f&&!this.s.l&&!t&&(this.v=kt(this.s.p)+9,this.s={i:0},this.o=new O(0),this.push(new O(0),t))},s}(),Jt=typeof TextDecoder<"u"&&new TextDecoder;try{Jt.decode(Es,{stream:!0})}catch{}var ps=function(s){for(var A="",t=0;;){var e=s[t++],i=(e>127)+(e>223)+(e>239);if(t+i>s.length)return{s:A,r:NA(s,t-1)};i?i==3?(e=((e&15)<<18|(s[t++]&63)<<12|(s[t++]&63)<<6|s[t++]&63)-65536,A+=String.fromCharCode(55296|e>>10,56320|e&1023)):i&1?A+=String.fromCharCode((e&31)<<6|s[t++]&63):A+=String.fromCharCode((e&15)<<12|(s[t++]&63)<<6|s[t++]&63):A+=String.fromCharCode(e)}};function xs(s,A){if(A){for(var t="",e=0;e<s.length;e+=16384)t+=String.fromCharCode.apply(null,s.subarray(e,e+16384));return t}else{if(Jt)return Jt.decode(s);var i=ps(s),n=i.s,t=i.r;return t.length&&V(8),n}}var we=function(s,A){return A+30+uA(s,A+26)+uA(s,A+28)},me=function(s,A,t){var e=uA(s,A+28),i=xs(s.subarray(A+46,A+46+e),!(uA(s,A+8)&2048)),n=A+46+e,r=tA(s,A+20),g=t&&r==4294967295?Ds(s,n):[r,tA(s,A+24),tA(s,A+42)],o=g[0],a=g[1],I=g[2];return[uA(s,A+10),o,a,i,n+uA(s,A+30)+uA(s,A+32),I]},Ds=function(s,A){for(;uA(s,A)!=1;A+=4+uA(s,A+2));return[Gt(s,A+12),Gt(s,A+4),Gt(s,A+20)]},pe=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(s){s()};function Ss(s,A,t){t||(t=A,A={}),typeof t!="function"&&V(7);var e=[],i=function(){for(var l=0;l<e.length;++l)e[l]()},n={},r=function(l,Q){pe(function(){t(l,Q)})};pe(function(){r=t});for(var g=s.length-22;tA(s,g)!=101010256;--g)if(!g||s.length-g>65558)return r(V(13,0,1),null),i;var o=uA(s,g+8);if(o){var a=o,I=tA(s,g+16),C=I==4294967295||a==65535;if(C){var h=tA(s,g-12);C=tA(s,h)==101075792,C&&(a=o=tA(s,h+32),I=tA(s,h+48))}for(var B=A&&A.filter,E=function(l){var Q=me(s,I,C),y=Q[0],c=Q[1],f=Q[2],p=Q[3],d=Q[4],z=Q[5],m=we(s,z);I=d;var w=function(D,x){D?(i(),r(D,null)):(x&&(n[p]=x),--o||r(null,n))};if(!B||B({name:p,size:c,originalSize:f,compression:y}))if(!y)w(null,NA(s,m,m+c));else if(y==8){var Y=s.subarray(m,m+c);if(f<524288||c>.8*f)try{w(null,Bt(Y,{out:new O(f)}))}catch(D){w(D,null)}else e.push(ws(Y,{size:f},w))}else w(V(14,"unknown compression type "+y,1),null);else w(null,null)},u=0;u<a;++u)E(u)}else r(null,{});return i}function Fs(s,A){for(var t={},e=s.length-22;tA(s,e)!=101010256;--e)(!e||s.length-e>65558)&&V(13);var i=uA(s,e+8);if(!i)return{};var n=tA(s,e+16),r=n==4294967295||i==65535;if(r){var g=tA(s,e-12);r=tA(s,g)==101075792,r&&(i=tA(s,g+32),n=tA(s,g+48))}for(var o=A&&A.filter,a=0;a<i;++a){var I=me(s,n,r),C=I[0],h=I[1],B=I[2],E=I[3],u=I[4],l=I[5],Q=we(s,l);n=u,(!o||o({name:E,size:h,originalSize:B,compression:C}))&&(C?C==8?t[E]=Bt(s.subarray(Q,Q+h),{out:new O(B)}):V(14,"unknown compression type "+C):t[E]=NA(s,Q,Q+h))}return t}/**\n * @license\n * Copyright 2010-2025 Three.js Authors\n * SPDX-License-Identifier: MIT\n */const xe="178",Ms="",fA="srgb",De="srgb-linear",Se="linear",_t="srgb";function oA(s,A,t){return Math.max(A,Math.min(t,s))}function ds(s,A){return(s%A+A)%A}function Rt(s,A,t){return(1-t)*s+t*A}class kA{constructor(A=0,t=0,e=0,i=1){this.isQuaternion=!0,this._x=A,this._y=t,this._z=e,this._w=i}static slerpFlat(A,t,e,i,n,r,g){let o=e[i+0],a=e[i+1],I=e[i+2],C=e[i+3];const h=n[r+0],B=n[r+1],E=n[r+2],u=n[r+3];if(g===0){A[t+0]=o,A[t+1]=a,A[t+2]=I,A[t+3]=C;return}if(g===1){A[t+0]=h,A[t+1]=B,A[t+2]=E,A[t+3]=u;return}if(C!==u||o!==h||a!==B||I!==E){let l=1-g;const Q=o*h+a*B+I*E+C*u,y=Q>=0?1:-1,c=1-Q*Q;if(c>Number.EPSILON){const p=Math.sqrt(c),d=Math.atan2(p,Q*y);l=Math.sin(l*d)/p,g=Math.sin(g*d)/p}const f=g*y;if(o=o*l+h*f,a=a*l+B*f,I=I*l+E*f,C=C*l+u*f,l===1-g){const p=1/Math.sqrt(o*o+a*a+I*I+C*C);o*=p,a*=p,I*=p,C*=p}}A[t]=o,A[t+1]=a,A[t+2]=I,A[t+3]=C}static multiplyQuaternionsFlat(A,t,e,i,n,r){const g=e[i],o=e[i+1],a=e[i+2],I=e[i+3],C=n[r],h=n[r+1],B=n[r+2],E=n[r+3];return A[t]=g*E+I*C+o*B-a*h,A[t+1]=o*E+I*h+a*C-g*B,A[t+2]=a*E+I*B+g*h-o*C,A[t+3]=I*E-g*C-o*h-a*B,A}get x(){return this._x}set x(A){this._x=A,this._onChangeCallback()}get y(){return this._y}set y(A){this._y=A,this._onChangeCallback()}get z(){return this._z}set z(A){this._z=A,this._onChangeCallback()}get w(){return this._w}set w(A){this._w=A,this._onChangeCallback()}set(A,t,e,i){return this._x=A,this._y=t,this._z=e,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(A){return this._x=A.x,this._y=A.y,this._z=A.z,this._w=A.w,this._onChangeCallback(),this}setFromEuler(A,t=!0){const e=A._x,i=A._y,n=A._z,r=A._order,g=Math.cos,o=Math.sin,a=g(e/2),I=g(i/2),C=g(n/2),h=o(e/2),B=o(i/2),E=o(n/2);switch(r){case"XYZ":this._x=h*I*C+a*B*E,this._y=a*B*C-h*I*E,this._z=a*I*E+h*B*C,this._w=a*I*C-h*B*E;break;case"YXZ":this._x=h*I*C+a*B*E,this._y=a*B*C-h*I*E,this._z=a*I*E-h*B*C,this._w=a*I*C+h*B*E;break;case"ZXY":this._x=h*I*C-a*B*E,this._y=a*B*C+h*I*E,this._z=a*I*E+h*B*C,this._w=a*I*C-h*B*E;break;case"ZYX":this._x=h*I*C-a*B*E,this._y=a*B*C+h*I*E,this._z=a*I*E-h*B*C,this._w=a*I*C+h*B*E;break;case"YZX":this._x=h*I*C+a*B*E,this._y=a*B*C+h*I*E,this._z=a*I*E-h*B*C,this._w=a*I*C-h*B*E;break;case"XZY":this._x=h*I*C-a*B*E,this._y=a*B*C-h*I*E,this._z=a*I*E+h*B*C,this._w=a*I*C+h*B*E;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+r)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(A,t){const e=t/2,i=Math.sin(e);return this._x=A.x*i,this._y=A.y*i,this._z=A.z*i,this._w=Math.cos(e),this._onChangeCallback(),this}setFromRotationMatrix(A){const t=A.elements,e=t[0],i=t[4],n=t[8],r=t[1],g=t[5],o=t[9],a=t[2],I=t[6],C=t[10],h=e+g+C;if(h>0){const B=.5/Math.sqrt(h+1);this._w=.25/B,this._x=(I-o)*B,this._y=(n-a)*B,this._z=(r-i)*B}else if(e>g&&e>C){const B=2*Math.sqrt(1+e-g-C);this._w=(I-o)/B,this._x=.25*B,this._y=(i+r)/B,this._z=(n+a)/B}else if(g>C){const B=2*Math.sqrt(1+g-e-C);this._w=(n-a)/B,this._x=(i+r)/B,this._y=.25*B,this._z=(o+I)/B}else{const B=2*Math.sqrt(1+C-e-g);this._w=(r-i)/B,this._x=(n+a)/B,this._y=(o+I)/B,this._z=.25*B}return this._onChangeCallback(),this}setFromUnitVectors(A,t){let e=A.dot(t)+1;return e<1e-8?(e=0,Math.abs(A.x)>Math.abs(A.z)?(this._x=-A.y,this._y=A.x,this._z=0,this._w=e):(this._x=0,this._y=-A.z,this._z=A.y,this._w=e)):(this._x=A.y*t.z-A.z*t.y,this._y=A.z*t.x-A.x*t.z,this._z=A.x*t.y-A.y*t.x,this._w=e),this.normalize()}angleTo(A){return 2*Math.acos(Math.abs(oA(this.dot(A),-1,1)))}rotateTowards(A,t){const e=this.angleTo(A);if(e===0)return this;const i=Math.min(1,t/e);return this.slerp(A,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(A){return this._x*A._x+this._y*A._y+this._z*A._z+this._w*A._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let A=this.length();return A===0?(this._x=0,this._y=0,this._z=0,this._w=1):(A=1/A,this._x=this._x*A,this._y=this._y*A,this._z=this._z*A,this._w=this._w*A),this._onChangeCallback(),this}multiply(A){return this.multiplyQuaternions(this,A)}premultiply(A){return this.multiplyQuaternions(A,this)}multiplyQuaternions(A,t){const e=A._x,i=A._y,n=A._z,r=A._w,g=t._x,o=t._y,a=t._z,I=t._w;return this._x=e*I+r*g+i*a-n*o,this._y=i*I+r*o+n*g-e*a,this._z=n*I+r*a+e*o-i*g,this._w=r*I-e*g-i*o-n*a,this._onChangeCallback(),this}slerp(A,t){if(t===0)return this;if(t===1)return this.copy(A);const e=this._x,i=this._y,n=this._z,r=this._w;let g=r*A._w+e*A._x+i*A._y+n*A._z;if(g<0?(this._w=-A._w,this._x=-A._x,this._y=-A._y,this._z=-A._z,g=-g):this.copy(A),g>=1)return this._w=r,this._x=e,this._y=i,this._z=n,this;const o=1-g*g;if(o<=Number.EPSILON){const B=1-t;return this._w=B*r+t*this._w,this._x=B*e+t*this._x,this._y=B*i+t*this._y,this._z=B*n+t*this._z,this.normalize(),this}const a=Math.sqrt(o),I=Math.atan2(a,g),C=Math.sin((1-t)*I)/a,h=Math.sin(t*I)/a;return this._w=r*C+this._w*h,this._x=e*C+this._x*h,this._y=i*C+this._y*h,this._z=n*C+this._z*h,this._onChangeCallback(),this}slerpQuaternions(A,t,e){return this.copy(A).slerp(t,e)}random(){const A=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),e=Math.random(),i=Math.sqrt(1-e),n=Math.sqrt(e);return this.set(i*Math.sin(A),i*Math.cos(A),n*Math.sin(t),n*Math.cos(t))}equals(A){return A._x===this._x&&A._y===this._y&&A._z===this._z&&A._w===this._w}fromArray(A,t=0){return this._x=A[t],this._y=A[t+1],this._z=A[t+2],this._w=A[t+3],this._onChangeCallback(),this}toArray(A=[],t=0){return A[t]=this._x,A[t+1]=this._y,A[t+2]=this._z,A[t+3]=this._w,A}fromBufferAttribute(A,t){return this._x=A.getX(t),this._y=A.getY(t),this._z=A.getZ(t),this._w=A.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(A){return this._onChangeCallback=A,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class k{constructor(A=0,t=0,e=0){k.prototype.isVector3=!0,this.x=A,this.y=t,this.z=e}set(A,t,e){return e===void 0&&(e=this.z),this.x=A,this.y=t,this.z=e,this}setScalar(A){return this.x=A,this.y=A,this.z=A,this}setX(A){return this.x=A,this}setY(A){return this.y=A,this}setZ(A){return this.z=A,this}setComponent(A,t){switch(A){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+A)}return this}getComponent(A){switch(A){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+A)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(A){return this.x=A.x,this.y=A.y,this.z=A.z,this}add(A){return this.x+=A.x,this.y+=A.y,this.z+=A.z,this}addScalar(A){return this.x+=A,this.y+=A,this.z+=A,this}addVectors(A,t){return this.x=A.x+t.x,this.y=A.y+t.y,this.z=A.z+t.z,this}addScaledVector(A,t){return this.x+=A.x*t,this.y+=A.y*t,this.z+=A.z*t,this}sub(A){return this.x-=A.x,this.y-=A.y,this.z-=A.z,this}subScalar(A){return this.x-=A,this.y-=A,this.z-=A,this}subVectors(A,t){return this.x=A.x-t.x,this.y=A.y-t.y,this.z=A.z-t.z,this}multiply(A){return this.x*=A.x,this.y*=A.y,this.z*=A.z,this}multiplyScalar(A){return this.x*=A,this.y*=A,this.z*=A,this}multiplyVectors(A,t){return this.x=A.x*t.x,this.y=A.y*t.y,this.z=A.z*t.z,this}applyEuler(A){return this.applyQuaternion(Fe.setFromEuler(A))}applyAxisAngle(A,t){return this.applyQuaternion(Fe.setFromAxisAngle(A,t))}applyMatrix3(A){const t=this.x,e=this.y,i=this.z,n=A.elements;return this.x=n[0]*t+n[3]*e+n[6]*i,this.y=n[1]*t+n[4]*e+n[7]*i,this.z=n[2]*t+n[5]*e+n[8]*i,this}applyNormalMatrix(A){return this.applyMatrix3(A).normalize()}applyMatrix4(A){const t=this.x,e=this.y,i=this.z,n=A.elements,r=1/(n[3]*t+n[7]*e+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*e+n[8]*i+n[12])*r,this.y=(n[1]*t+n[5]*e+n[9]*i+n[13])*r,this.z=(n[2]*t+n[6]*e+n[10]*i+n[14])*r,this}applyQuaternion(A){const t=this.x,e=this.y,i=this.z,n=A.x,r=A.y,g=A.z,o=A.w,a=2*(r*i-g*e),I=2*(g*t-n*i),C=2*(n*e-r*t);return this.x=t+o*a+r*C-g*I,this.y=e+o*I+g*a-n*C,this.z=i+o*C+n*I-r*a,this}project(A){return this.applyMatrix4(A.matrixWorldInverse).applyMatrix4(A.projectionMatrix)}unproject(A){return this.applyMatrix4(A.projectionMatrixInverse).applyMatrix4(A.matrixWorld)}transformDirection(A){const t=this.x,e=this.y,i=this.z,n=A.elements;return this.x=n[0]*t+n[4]*e+n[8]*i,this.y=n[1]*t+n[5]*e+n[9]*i,this.z=n[2]*t+n[6]*e+n[10]*i,this.normalize()}divide(A){return this.x/=A.x,this.y/=A.y,this.z/=A.z,this}divideScalar(A){return this.multiplyScalar(1/A)}min(A){return this.x=Math.min(this.x,A.x),this.y=Math.min(this.y,A.y),this.z=Math.min(this.z,A.z),this}max(A){return this.x=Math.max(this.x,A.x),this.y=Math.max(this.y,A.y),this.z=Math.max(this.z,A.z),this}clamp(A,t){return this.x=oA(this.x,A.x,t.x),this.y=oA(this.y,A.y,t.y),this.z=oA(this.z,A.z,t.z),this}clampScalar(A,t){return this.x=oA(this.x,A,t),this.y=oA(this.y,A,t),this.z=oA(this.z,A,t),this}clampLength(A,t){const e=this.length();return this.divideScalar(e||1).multiplyScalar(oA(e,A,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(A){return this.x*A.x+this.y*A.y+this.z*A.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(A){return this.normalize().multiplyScalar(A)}lerp(A,t){return this.x+=(A.x-this.x)*t,this.y+=(A.y-this.y)*t,this.z+=(A.z-this.z)*t,this}lerpVectors(A,t,e){return this.x=A.x+(t.x-A.x)*e,this.y=A.y+(t.y-A.y)*e,this.z=A.z+(t.z-A.z)*e,this}cross(A){return this.crossVectors(this,A)}crossVectors(A,t){const e=A.x,i=A.y,n=A.z,r=t.x,g=t.y,o=t.z;return this.x=i*o-n*g,this.y=n*r-e*o,this.z=e*g-i*r,this}projectOnVector(A){const t=A.lengthSq();if(t===0)return this.set(0,0,0);const e=A.dot(this)/t;return this.copy(A).multiplyScalar(e)}projectOnPlane(A){return bt.copy(this).projectOnVector(A),this.sub(bt)}reflect(A){return this.sub(bt.copy(A).multiplyScalar(2*this.dot(A)))}angleTo(A){const t=Math.sqrt(this.lengthSq()*A.lengthSq());if(t===0)return Math.PI/2;const e=this.dot(A)/t;return Math.acos(oA(e,-1,1))}distanceTo(A){return Math.sqrt(this.distanceToSquared(A))}distanceToSquared(A){const t=this.x-A.x,e=this.y-A.y,i=this.z-A.z;return t*t+e*e+i*i}manhattanDistanceTo(A){return Math.abs(this.x-A.x)+Math.abs(this.y-A.y)+Math.abs(this.z-A.z)}setFromSpherical(A){return this.setFromSphericalCoords(A.radius,A.phi,A.theta)}setFromSphericalCoords(A,t,e){const i=Math.sin(t)*A;return this.x=i*Math.sin(e),this.y=Math.cos(t)*A,this.z=i*Math.cos(e),this}setFromCylindrical(A){return this.setFromCylindricalCoords(A.radius,A.theta,A.y)}setFromCylindricalCoords(A,t,e){return this.x=A*Math.sin(t),this.y=e,this.z=A*Math.cos(t),this}setFromMatrixPosition(A){const t=A.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(A){const t=this.setFromMatrixColumn(A,0).length(),e=this.setFromMatrixColumn(A,1).length(),i=this.setFromMatrixColumn(A,2).length();return this.x=t,this.y=e,this.z=i,this}setFromMatrixColumn(A,t){return this.fromArray(A.elements,t*4)}setFromMatrix3Column(A,t){return this.fromArray(A.elements,t*3)}setFromEuler(A){return this.x=A._x,this.y=A._y,this.z=A._z,this}setFromColor(A){return this.x=A.r,this.y=A.g,this.z=A.b,this}equals(A){return A.x===this.x&&A.y===this.y&&A.z===this.z}fromArray(A,t=0){return this.x=A[t],this.y=A[t+1],this.z=A[t+2],this}toArray(A=[],t=0){return A[t]=this.x,A[t+1]=this.y,A[t+2]=this.z,A}fromBufferAttribute(A,t){return this.x=A.getX(t),this.y=A.getY(t),this.z=A.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const A=Math.random()*Math.PI*2,t=Math.random()*2-1,e=Math.sqrt(1-t*t);return this.x=e*Math.cos(A),this.y=t,this.z=e*Math.sin(A),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const bt=new k,Fe=new kA;class At{constructor(A,t,e,i,n,r,g,o,a){At.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],A!==void 0&&this.set(A,t,e,i,n,r,g,o,a)}set(A,t,e,i,n,r,g,o,a){const I=this.elements;return I[0]=A,I[1]=i,I[2]=g,I[3]=t,I[4]=n,I[5]=o,I[6]=e,I[7]=r,I[8]=a,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(A){const t=this.elements,e=A.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this}extractBasis(A,t,e){return A.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),e.setFromMatrix3Column(this,2),this}setFromMatrix4(A){const t=A.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(A){return this.multiplyMatrices(this,A)}premultiply(A){return this.multiplyMatrices(A,this)}multiplyMatrices(A,t){const e=A.elements,i=t.elements,n=this.elements,r=e[0],g=e[3],o=e[6],a=e[1],I=e[4],C=e[7],h=e[2],B=e[5],E=e[8],u=i[0],l=i[3],Q=i[6],y=i[1],c=i[4],f=i[7],p=i[2],d=i[5],z=i[8];return n[0]=r*u+g*y+o*p,n[3]=r*l+g*c+o*d,n[6]=r*Q+g*f+o*z,n[1]=a*u+I*y+C*p,n[4]=a*l+I*c+C*d,n[7]=a*Q+I*f+C*z,n[2]=h*u+B*y+E*p,n[5]=h*l+B*c+E*d,n[8]=h*Q+B*f+E*z,this}multiplyScalar(A){const t=this.elements;return t[0]*=A,t[3]*=A,t[6]*=A,t[1]*=A,t[4]*=A,t[7]*=A,t[2]*=A,t[5]*=A,t[8]*=A,this}determinant(){const A=this.elements,t=A[0],e=A[1],i=A[2],n=A[3],r=A[4],g=A[5],o=A[6],a=A[7],I=A[8];return t*r*I-t*g*a-e*n*I+e*g*o+i*n*a-i*r*o}invert(){const A=this.elements,t=A[0],e=A[1],i=A[2],n=A[3],r=A[4],g=A[5],o=A[6],a=A[7],I=A[8],C=I*r-g*a,h=g*o-I*n,B=a*n-r*o,E=t*C+e*h+i*B;if(E===0)return this.set(0,0,0,0,0,0,0,0,0);const u=1/E;return A[0]=C*u,A[1]=(i*a-I*e)*u,A[2]=(g*e-i*r)*u,A[3]=h*u,A[4]=(I*t-i*o)*u,A[5]=(i*n-g*t)*u,A[6]=B*u,A[7]=(e*o-a*t)*u,A[8]=(r*t-e*n)*u,this}transpose(){let A;const t=this.elements;return A=t[1],t[1]=t[3],t[3]=A,A=t[2],t[2]=t[6],t[6]=A,A=t[5],t[5]=t[7],t[7]=A,this}getNormalMatrix(A){return this.setFromMatrix4(A).invert().transpose()}transposeIntoArray(A){const t=this.elements;return A[0]=t[0],A[1]=t[3],A[2]=t[6],A[3]=t[1],A[4]=t[4],A[5]=t[7],A[6]=t[2],A[7]=t[5],A[8]=t[8],this}setUvTransform(A,t,e,i,n,r,g){const o=Math.cos(n),a=Math.sin(n);return this.set(e*o,e*a,-e*(o*r+a*g)+r+A,-i*a,i*o,-i*(-a*r+o*g)+g+t,0,0,1),this}scale(A,t){return this.premultiply(zt.makeScale(A,t)),this}rotate(A){return this.premultiply(zt.makeRotation(-A)),this}translate(A,t){return this.premultiply(zt.makeTranslation(A,t)),this}makeTranslation(A,t){return A.isVector2?this.set(1,0,A.x,0,1,A.y,0,0,1):this.set(1,0,A,0,1,t,0,0,1),this}makeRotation(A){const t=Math.cos(A),e=Math.sin(A);return this.set(t,-e,0,e,t,0,0,0,1),this}makeScale(A,t){return this.set(A,0,0,0,t,0,0,0,1),this}equals(A){const t=this.elements,e=A.elements;for(let i=0;i<9;i++)if(t[i]!==e[i])return!1;return!0}fromArray(A,t=0){for(let e=0;e<9;e++)this.elements[e]=A[e+t];return this}toArray(A=[],t=0){const e=this.elements;return A[t]=e[0],A[t+1]=e[1],A[t+2]=e[2],A[t+3]=e[3],A[t+4]=e[4],A[t+5]=e[5],A[t+6]=e[6],A[t+7]=e[7],A[t+8]=e[8],A}clone(){return new this.constructor().fromArray(this.elements)}}const zt=new At,Me={};function de(s){s in Me||(Me[s]=!0,console.warn(s))}const Ne=new At().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),ke=new At().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Ns(){const s={enabled:!0,workingColorSpace:De,spaces:{},convert:function(i,n,r){return this.enabled===!1||n===r||!n||!r||(this.spaces[n].transfer===_t&&(i.r=vA(i.r),i.g=vA(i.g),i.b=vA(i.b)),this.spaces[n].primaries!==this.spaces[r].primaries&&(i.applyMatrix3(this.spaces[n].toXYZ),i.applyMatrix3(this.spaces[r].fromXYZ)),this.spaces[r].transfer===_t&&(i.r=KA(i.r),i.g=KA(i.g),i.b=KA(i.b))),i},workingToColorSpace:function(i,n){return this.convert(i,this.workingColorSpace,n)},colorSpaceToWorking:function(i,n){return this.convert(i,n,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===Ms?Se:this.spaces[i].transfer},getLuminanceCoefficients:function(i,n=this.workingColorSpace){return i.fromArray(this.spaces[n].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,n,r){return i.copy(this.spaces[n].toXYZ).multiply(this.spaces[r].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(i,n){return de("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),s.workingToColorSpace(i,n)},toWorkingColorSpace:function(i,n){return de("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),s.colorSpaceToWorking(i,n)}},A=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],e=[.3127,.329];return s.define({[De]:{primaries:A,whitePoint:e,transfer:Se,toXYZ:Ne,fromXYZ:ke,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:fA},outputColorSpaceConfig:{drawingBufferColorSpace:fA}},[fA]:{primaries:A,whitePoint:e,transfer:_t,toXYZ:Ne,fromXYZ:ke,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:fA}}}),s}const yA=Ns();function vA(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function KA(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}class Ye{constructor(A=new k(1/0,1/0,1/0),t=new k(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=A,this.max=t}set(A,t){return this.min.copy(A),this.max.copy(t),this}setFromArray(A){this.makeEmpty();for(let t=0,e=A.length;t<e;t+=3)this.expandByPoint(wA.fromArray(A,t));return this}setFromBufferAttribute(A){this.makeEmpty();for(let t=0,e=A.count;t<e;t++)this.expandByPoint(wA.fromBufferAttribute(A,t));return this}setFromPoints(A){this.makeEmpty();for(let t=0,e=A.length;t<e;t++)this.expandByPoint(A[t]);return this}setFromCenterAndSize(A,t){const e=wA.copy(t).multiplyScalar(.5);return this.min.copy(A).sub(e),this.max.copy(A).add(e),this}setFromObject(A,t=!1){return this.makeEmpty(),this.expandByObject(A,t)}clone(){return new this.constructor().copy(this)}copy(A){return this.min.copy(A.min),this.max.copy(A.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(A){return this.isEmpty()?A.set(0,0,0):A.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(A){return this.isEmpty()?A.set(0,0,0):A.subVectors(this.max,this.min)}expandByPoint(A){return this.min.min(A),this.max.max(A),this}expandByVector(A){return this.min.sub(A),this.max.add(A),this}expandByScalar(A){return this.min.addScalar(-A),this.max.addScalar(A),this}expandByObject(A,t=!1){A.updateWorldMatrix(!1,!1);const e=A.geometry;if(e!==void 0){const n=e.getAttribute("position");if(t===!0&&n!==void 0&&A.isInstancedMesh!==!0)for(let r=0,g=n.count;r<g;r++)A.isMesh===!0?A.getVertexPosition(r,wA):wA.fromBufferAttribute(n,r),wA.applyMatrix4(A.matrixWorld),this.expandByPoint(wA);else A.boundingBox!==void 0?(A.boundingBox===null&&A.computeBoundingBox(),ht.copy(A.boundingBox)):(e.boundingBox===null&&e.computeBoundingBox(),ht.copy(e.boundingBox)),ht.applyMatrix4(A.matrixWorld),this.union(ht)}const i=A.children;for(let n=0,r=i.length;n<r;n++)this.expandByObject(i[n],t);return this}containsPoint(A){return A.x>=this.min.x&&A.x<=this.max.x&&A.y>=this.min.y&&A.y<=this.max.y&&A.z>=this.min.z&&A.z<=this.max.z}containsBox(A){return this.min.x<=A.min.x&&A.max.x<=this.max.x&&this.min.y<=A.min.y&&A.max.y<=this.max.y&&this.min.z<=A.min.z&&A.max.z<=this.max.z}getParameter(A,t){return t.set((A.x-this.min.x)/(this.max.x-this.min.x),(A.y-this.min.y)/(this.max.y-this.min.y),(A.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(A){return A.max.x>=this.min.x&&A.min.x<=this.max.x&&A.max.y>=this.min.y&&A.min.y<=this.max.y&&A.max.z>=this.min.z&&A.min.z<=this.max.z}intersectsSphere(A){return this.clampPoint(A.center,wA),wA.distanceToSquared(A.center)<=A.radius*A.radius}intersectsPlane(A){let t,e;return A.normal.x>0?(t=A.normal.x*this.min.x,e=A.normal.x*this.max.x):(t=A.normal.x*this.max.x,e=A.normal.x*this.min.x),A.normal.y>0?(t+=A.normal.y*this.min.y,e+=A.normal.y*this.max.y):(t+=A.normal.y*this.max.y,e+=A.normal.y*this.min.y),A.normal.z>0?(t+=A.normal.z*this.min.z,e+=A.normal.z*this.max.z):(t+=A.normal.z*this.max.z,e+=A.normal.z*this.min.z),t<=-A.constant&&e>=-A.constant}intersectsTriangle(A){if(this.isEmpty())return!1;this.getCenter(tt),Et.subVectors(this.max,tt),qA.subVectors(A.a,tt),ZA.subVectors(A.b,tt),XA.subVectors(A.c,tt),YA.subVectors(ZA,qA),GA.subVectors(XA,ZA),zA.subVectors(qA,XA);let t=[0,-YA.z,YA.y,0,-GA.z,GA.y,0,-zA.z,zA.y,YA.z,0,-YA.x,GA.z,0,-GA.x,zA.z,0,-zA.x,-YA.y,YA.x,0,-GA.y,GA.x,0,-zA.y,zA.x,0];return!Ht(t,qA,ZA,XA,Et)||(t=[1,0,0,0,1,0,0,0,1],!Ht(t,qA,ZA,XA,Et))?!1:(Qt.crossVectors(YA,GA),t=[Qt.x,Qt.y,Qt.z],Ht(t,qA,ZA,XA,Et))}clampPoint(A,t){return t.copy(A).clamp(this.min,this.max)}distanceToPoint(A){return this.clampPoint(A,wA).distanceTo(A)}getBoundingSphere(A){return this.isEmpty()?A.makeEmpty():(this.getCenter(A.center),A.radius=this.getSize(wA).length()*.5),A}intersect(A){return this.min.max(A.min),this.max.min(A.max),this.isEmpty()&&this.makeEmpty(),this}union(A){return this.min.min(A.min),this.max.max(A.max),this}applyMatrix4(A){return this.isEmpty()?this:(FA[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(A),FA[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(A),FA[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(A),FA[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(A),FA[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(A),FA[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(A),FA[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(A),FA[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(A),this.setFromPoints(FA),this)}translate(A){return this.min.add(A),this.max.add(A),this}equals(A){return A.min.equals(this.min)&&A.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(A){return this.min.fromArray(A.min),this.max.fromArray(A.max),this}}const FA=[new k,new k,new k,new k,new k,new k,new k,new k],wA=new k,ht=new Ye,qA=new k,ZA=new k,XA=new k,YA=new k,GA=new k,zA=new k,tt=new k,Et=new k,Qt=new k,HA=new k;function Ht(s,A,t,e,i){for(let n=0,r=s.length-3;n<=r;n+=3){HA.fromArray(s,n);const g=i.x*Math.abs(HA.x)+i.y*Math.abs(HA.y)+i.z*Math.abs(HA.z),o=A.dot(HA),a=t.dot(HA),I=e.dot(HA);if(Math.max(-Math.max(o,a,I),Math.min(o,a,I))>g)return!1}return!0}const Ge={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},UA={h:0,s:0,l:0},ct={h:0,s:0,l:0};function Lt(s,A,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(A-s)*6*t:t<1/2?A:t<2/3?s+(A-s)*6*(2/3-t):s}class Tt{constructor(A,t,e){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(A,t,e)}set(A,t,e){if(t===void 0&&e===void 0){const i=A;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(A,t,e);return this}setScalar(A){return this.r=A,this.g=A,this.b=A,this}setHex(A,t=fA){return A=Math.floor(A),this.r=(A>>16&255)/255,this.g=(A>>8&255)/255,this.b=(A&255)/255,yA.colorSpaceToWorking(this,t),this}setRGB(A,t,e,i=yA.workingColorSpace){return this.r=A,this.g=t,this.b=e,yA.colorSpaceToWorking(this,i),this}setHSL(A,t,e,i=yA.workingColorSpace){if(A=ds(A,1),t=oA(t,0,1),e=oA(e,0,1),t===0)this.r=this.g=this.b=e;else{const n=e<=.5?e*(1+t):e+t-e*t,r=2*e-n;this.r=Lt(r,n,A+1/3),this.g=Lt(r,n,A),this.b=Lt(r,n,A-1/3)}return yA.colorSpaceToWorking(this,i),this}setStyle(A,t=fA){function e(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+A+" will be ignored.")}let i;if(i=/^(\\w+)\\(([^\\)]*)\\)/.exec(A)){let n;const r=i[1],g=i[2];switch(r){case"rgb":case"rgba":if(n=/^\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec(g))return e(n[4]),this.setRGB(Math.min(255,parseInt(n[1],10))/255,Math.min(255,parseInt(n[2],10))/255,Math.min(255,parseInt(n[3],10))/255,t);if(n=/^\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec(g))return e(n[4]),this.setRGB(Math.min(100,parseInt(n[1],10))/100,Math.min(100,parseInt(n[2],10))/100,Math.min(100,parseInt(n[3],10))/100,t);break;case"hsl":case"hsla":if(n=/^\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\%\\s*,\\s*(\\d*\\.?\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec(g))return e(n[4]),this.setHSL(parseFloat(n[1])/360,parseFloat(n[2])/100,parseFloat(n[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+A)}}else if(i=/^\\#([A-Fa-f\\d]+)$/.exec(A)){const n=i[1],r=n.length;if(r===3)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,t);if(r===6)return this.setHex(parseInt(n,16),t);console.warn("THREE.Color: Invalid hex color "+A)}else if(A&&A.length>0)return this.setColorName(A,t);return this}setColorName(A,t=fA){const e=Ge[A.toLowerCase()];return e!==void 0?this.setHex(e,t):console.warn("THREE.Color: Unknown color "+A),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(A){return this.r=A.r,this.g=A.g,this.b=A.b,this}copySRGBToLinear(A){return this.r=vA(A.r),this.g=vA(A.g),this.b=vA(A.b),this}copyLinearToSRGB(A){return this.r=KA(A.r),this.g=KA(A.g),this.b=KA(A.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(A=fA){return yA.workingToColorSpace(eA.copy(this),A),Math.round(oA(eA.r*255,0,255))*65536+Math.round(oA(eA.g*255,0,255))*256+Math.round(oA(eA.b*255,0,255))}getHexString(A=fA){return("000000"+this.getHex(A).toString(16)).slice(-6)}getHSL(A,t=yA.workingColorSpace){yA.workingToColorSpace(eA.copy(this),t);const e=eA.r,i=eA.g,n=eA.b,r=Math.max(e,i,n),g=Math.min(e,i,n);let o,a;const I=(g+r)/2;if(g===r)o=0,a=0;else{const C=r-g;switch(a=I<=.5?C/(r+g):C/(2-r-g),r){case e:o=(i-n)/C+(i<n?6:0);break;case i:o=(n-e)/C+2;break;case n:o=(e-i)/C+4;break}o/=6}return A.h=o,A.s=a,A.l=I,A}getRGB(A,t=yA.workingColorSpace){return yA.workingToColorSpace(eA.copy(this),t),A.r=eA.r,A.g=eA.g,A.b=eA.b,A}getStyle(A=fA){yA.workingToColorSpace(eA.copy(this),A);const t=eA.r,e=eA.g,i=eA.b;return A!==fA?`color(${A} ${t.toFixed(3)} ${e.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(e*255)},${Math.round(i*255)})`}offsetHSL(A,t,e){return this.getHSL(UA),this.setHSL(UA.h+A,UA.s+t,UA.l+e)}add(A){return this.r+=A.r,this.g+=A.g,this.b+=A.b,this}addColors(A,t){return this.r=A.r+t.r,this.g=A.g+t.g,this.b=A.b+t.b,this}addScalar(A){return this.r+=A,this.g+=A,this.b+=A,this}sub(A){return this.r=Math.max(0,this.r-A.r),this.g=Math.max(0,this.g-A.g),this.b=Math.max(0,this.b-A.b),this}multiply(A){return this.r*=A.r,this.g*=A.g,this.b*=A.b,this}multiplyScalar(A){return this.r*=A,this.g*=A,this.b*=A,this}lerp(A,t){return this.r+=(A.r-this.r)*t,this.g+=(A.g-this.g)*t,this.b+=(A.b-this.b)*t,this}lerpColors(A,t,e){return this.r=A.r+(t.r-A.r)*e,this.g=A.g+(t.g-A.g)*e,this.b=A.b+(t.b-A.b)*e,this}lerpHSL(A,t){this.getHSL(UA),A.getHSL(ct);const e=Rt(UA.h,ct.h,t),i=Rt(UA.s,ct.s,t),n=Rt(UA.l,ct.l,t);return this.setHSL(e,i,n),this}setFromVector3(A){return this.r=A.x,this.g=A.y,this.b=A.z,this}applyMatrix3(A){const t=this.r,e=this.g,i=this.b,n=A.elements;return this.r=n[0]*t+n[3]*e+n[6]*i,this.g=n[1]*t+n[4]*e+n[7]*i,this.b=n[2]*t+n[5]*e+n[8]*i,this}equals(A){return A.r===this.r&&A.g===this.g&&A.b===this.b}fromArray(A,t=0){return this.r=A[t],this.g=A[t+1],this.b=A[t+2],this}toArray(A=[],t=0){return A[t]=this.r,A[t+1]=this.g,A[t+2]=this.b,A}fromBufferAttribute(A,t){return this.r=A.getX(t),this.g=A.getY(t),this.b=A.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const eA=new Tt;Tt.NAMES=Ge,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:xe}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=xe);const Ue=-12,Je=9,PA=Math.exp(-30),ks=11,Ys=11,_e=1<<ks,Re=1<<Ys,be=1;function Gs(s){var n;let A=!1;const t=s.split(`\n`).map(r=>{const g=r.trimEnd();return A?g:g.length>0?(A=!0,g):null}).filter(r=>r!=null);for(;t.length>0&&t[t.length-1].length===0;)t.pop();if(t.length===0)return[];const e=(n=t[0].match(/^\\s*/))==null?void 0:n[0];if(!e)return t;const i=new RegExp(`^${e}`);return t.map(r=>r.replace(i,""))}function Us(s){return Gs(s).join(`\n`)}const vt=new Float32Array(1),ze=new Uint32Array(vt.buffer),Kt="Float16Array"in globalThis,et=Kt?new globalThis.Float16Array(1):null,He=new Uint16Array(et==null?void 0:et.buffer);function Js(s){const A=Math.sqrt(s.reduce((t,e)=>t+e*e,0));return s.map(t=>t/A)}const WA=Kt?_s:Rs,$=Kt?bs:zs;function _s(s){return et[0]=s,He[0]}function Rs(s){vt[0]=s;const A=ze[0],t=A>>31&1,e=A>>23&255,i=A&8388607,n=t<<15;if(e===255)return i!==0?n|32767:n|31744;const r=e-127+15;if(r>=31)return n|31744;if(r<=0){if(r<-10)return n;const o=(i|8388608)>>1-r+13;return n|o}const g=i>>13;return n|r<<10|g}function bs(s){return He[0]=s,et[0]}function zs(s){const A=s>>15&1,t=s>>10&31,e=s&1023;let i;if(t===0)if(e===0)i=A<<31;else{let n=e,r=-14;for(;(n&1024)===0;)n<<=1,r--;n&=1023;const g=r+127,o=n<<13;i=A<<31|g<<23|o}else if(t===31)e===0?i=A<<31|2139095040:i=A<<31|2143289344;else{const n=t-15+127,r=e<<13;i=A<<31|n<<23|r}return ze[0]=i,vt[0]}function EA(s){return Math.max(0,Math.min(255,Math.round(s*255)))}function Hs(s){const A=[],t=new Set;function e(i){i&&typeof i=="object"&&!t.has(i)&&(t.add(i),i instanceof ArrayBuffer?A.push(i):ArrayBuffer.isView(i)?A.push(i.buffer):Array.isArray(i)?i.forEach(e):Object.values(i).forEach(e))}return e(s),A}function qt(s,A,t,e,i,n,r,g,o,a,I,C,h,B,E,u,l){const Q=(l==null?void 0:l.rgbMin)??0,c=((l==null?void 0:l.rgbMax)??1)-Q,f=EA((B-Q)/c),p=EA((E-Q)/c),d=EA((u-Q)/c),z=EA(h),m=Ze(ve.set(o,a,I,C)),w=m&255,Y=m>>>8&255,D=m>>>16&255,x=(l==null?void 0:l.lnScaleMin)??Ue,F=254/(((l==null?void 0:l.lnScaleMax)??Je)-x),S=n<PA?0:Math.min(255,Math.max(1,Math.round((Math.log(n)-x)*F)+1)),G=r<PA?0:Math.min(255,Math.max(1,Math.round((Math.log(r)-x)*F)+1)),T=g<PA?0:Math.min(255,Math.max(1,Math.round((Math.log(g)-x)*F)+1)),q=WA(t),v=WA(e),W=WA(i),Z=A*4;s[Z]=f|p<<8|d<<16|z<<24,s[Z+1]=q|v<<16,s[Z+2]=W|w<<16|Y<<24,s[Z+3]=S|G<<8|T<<16|D<<24}function Le(s,A,t,e,i){const n=WA(t),r=WA(e),g=WA(i),o=A*4;s[o+1]=n|r<<16,s[o+2]=g|s[o+2]&4294901760}function Te(s,A,t,e,i,n){const r=(n==null?void 0:n.lnScaleMin)??Ue,o=254/(((n==null?void 0:n.lnScaleMax)??Je)-r),a=t<PA?0:Math.min(255,Math.max(1,Math.round((Math.log(t)-r)*o)+1)),I=e<PA?0:Math.min(255,Math.max(1,Math.round((Math.log(e)-r)*o)+1)),C=i<PA?0:Math.min(255,Math.max(1,Math.round((Math.log(i)-r)*o)+1)),h=A*4;s[h+3]=a|I<<8|C<<16|s[h+3]&4278190080}const ve=new kA;function Ke(s,A,t,e,i,n){const r=Ze(ve.set(t,e,i,n)),g=r&255,o=r>>>8&255,a=r>>>16&255,I=A*4;s[I+2]=s[I+2]&65535|g<<16|o<<24,s[I+3]=s[I+3]&16777215|a<<24}function Ls(s,A,t,e,i,n,r){const g=(r==null?void 0:r.rgbMin)??0,a=((r==null?void 0:r.rgbMax)??1)-g,I=EA((t-g)/a),C=EA((e-g)/a),h=EA((i-g)/a),B=EA(n),E=A*4;s[E]=I|C<<8|h<<16|B<<24}function Ts(s,A,t,e,i,n){const r=(n==null?void 0:n.rgbMin)??0,o=((n==null?void 0:n.rgbMax)??1)-r,a=EA((t-r)/o),I=EA((e-r)/o),C=EA((i-r)/o),h=A*4;s[h]=a|I<<8|C<<16|s[h]&4278190080}function vs(s,A,t){const e=EA(t),i=A*4;s[i]=s[i]&16777215|e<<24}new k,new k,new Tt;function Ks(s){const A=_e,t=Math.max(be,Math.min(Re,Math.ceil(s/A))),e=Math.ceil(s/(A*t)),i=A*t*e;return{width:A,height:t,depth:e,maxSplats:i}}function lt(s){const A=_e,t=Math.max(be,Math.min(Re,Math.ceil(s/A))),e=Math.ceil(s/(A*t));return A*t*e}Us(`\n  precision highp float;\n\n  in vec3 position;\n\n  void main() {\n    gl_Position = vec4(position.xy, 0.0, 1.0);\n  }\n`);const qs=new kA,qe=new k;function Ze(s){const A=qs.copy(s).normalize();A.w<0&&A.set(-A.x,-A.y,-A.z,-A.w);const t=2*Math.acos(A.w),e=Math.sqrt(A.x*A.x+A.y*A.y+A.z*A.z),i=e<1e-6?qe.set(1,0,0):qe.set(A.x,A.y,A.z).divideScalar(e),n=Math.abs(i.x)+Math.abs(i.y)+Math.abs(i.z);let r=i.x/n,g=i.y/n;if(i.z<0){const B=r;r=(1-Math.abs(g))*(r>=0?1:-1),g=(1-Math.abs(B))*(g>=0?1:-1)}const o=r*.5+.5,a=g*.5+.5,I=Math.round(o*255),C=Math.round(a*255);return Math.round(t*(255/Math.PI))<<16|C<<8|I}function ut(s,A,t,e){const i=Math.max(-127,Math.min(127,s*127)),n=Math.max(-127,Math.min(127,A*127)),r=Math.max(-127,Math.min(127,t*127)),g=Math.max(-127,Math.min(127,e*127));return i&255|(n&255)<<8|(r&255)<<16|(g&255)<<24}function ft(s,A,t,e){const i=(e==null?void 0:e.sh1Min)??-1,n=(e==null?void 0:e.sh1Max)??1,r=.5*(i+n),g=126/(n-i),o=A*2;for(let a=0;a<9;++a){const I=(t[a]-r)*g,C=Math.round(Math.max(-63,Math.min(63,I)))&127,h=a*7,B=h+7,E=Math.floor(h/32),u=h-E*32,l=C<<u&4294967295;if(s[o+E]|=l,B>E*32+32){const Q=C>>>32-u&4294967295;s[o+E+1]|=Q}}}function yt(s,A,t,e){const i=(e==null?void 0:e.sh2Min)??-1,n=(e==null?void 0:e.sh2Max)??1,r=.5*(i+n),g=2/(n-i);s[A*4+0]=ut((t[0]-r)*g,(t[1]-r)*g,(t[2]-r)*g,(t[3]-r)*g),s[A*4+1]=ut((t[4]-r)*g,(t[5]-r)*g,(t[6]-r)*g,(t[7]-r)*g),s[A*4+2]=ut((t[8]-r)*g,(t[9]-r)*g,(t[10]-r)*g,(t[11]-r)*g),s[A*4+3]=ut((t[12]-r)*g,(t[13]-r)*g,(t[14]-r)*g,0)}function wt(s,A,t,e){const i=(e==null?void 0:e.sh3Min)??-1,n=(e==null?void 0:e.sh3Max)??1,r=.5*(i+n),g=62/(n-i),o=A*4;for(let a=0;a<21;++a){const I=(t[a]-r)*g,C=Math.round(Math.max(-31,Math.min(31,I)))&63,h=a*6,B=h+6,E=Math.floor(h/32),u=h-E*32,l=C<<u&4294967295;if(s[o+E]|=l,B>E*32+32){const Q=C>>>32-u&4294967295;s[o+E+1]|=Q}}}function Zs(s,A){const t=[];let e=0,i=null;const n=new ms((o,a)=>{if(t.push(o),e+=o.length,a||e>=A){const I=new Uint8Array(e);let C=0;for(const h of t)I.set(h,C),C+=h.length;i=I.slice(0,A)}}),r=1024;let g=0;for(;i==null&&g<s.length;){const o=s.slice(g,g+r);n.push(o,!1),g+=r}if(i==null&&(n.push(new Uint8Array,!0),i==null))throw new Error("Failed to decompress partial gzip");return i}class Xs{constructor({fileBytes:A,chunkBytes:t=64*1024}){this.fileBytes=A,this.chunkBytes=t,this.chunks=[],this.totalBytes=0;const e=new DecompressionStream("gzip"),i=new Blob([A]).stream().pipeThrough(e);this.reader=i.getReader()}async read(A){for(;this.totalBytes<A;){const{value:n,done:r}=await this.reader.read();if(r)break;this.chunks.push(n),this.totalBytes+=n.length}if(this.totalBytes<A)throw new Error(`Unexpected EOF: needed ${A}, got ${this.totalBytes}`);const t=new Uint8Array(this.totalBytes);let e=0;for(const n of this.chunks)t.set(n,e),e+=n.length;const i=t.subarray(0,A);return this.chunks=[t.subarray(A)],this.totalBytes-=A,i}}function Xe(s,A,t){const e=Math.floor(s.length/32);if(e*32!==s.length)throw new Error("Invalid .splat file size");A(e);const i=new Float32Array(s.buffer);for(let n=0;n<e;++n){const r=n*32,g=n*8,o=i[g+0],a=i[g+1],I=i[g+2],C=i[g+3],h=i[g+4],B=i[g+5],E=s[r+24]/255,u=s[r+25]/255,l=s[r+26]/255,Q=s[r+27]/255,y=(s[r+28]-128)/128,c=(s[r+29]-128)/128,f=(s[r+30]-128)/128,p=(s[r+31]-128)/128;t(n,o,a,I,C,h,B,c,f,p,y,Q,E,u,l)}}function Ps(s,A){let t=0,e=0,i=new Uint32Array(0);return Xe(s,n=>{t=n,e=lt(t),i=new Uint32Array(e*4)},(n,r,g,o,a,I,C,h,B,E,u,l,Q,y,c)=>{qt(i,n,r,g,o,a,I,C,h,B,E,u,l,Q,y,c,A)}),{packedArray:i,numSplats:t}}const mt={0:{bytesPerCenter:12,bytesPerScale:12,bytesPerRotation:16,bytesPerColor:4,bytesPerSphericalHarmonicsComponent:4,scaleOffsetBytes:12,rotationOffsetBytes:24,colorOffsetBytes:40,sphericalHarmonicsOffsetBytes:44,scaleRange:1},1:{bytesPerCenter:6,bytesPerScale:6,bytesPerRotation:8,bytesPerColor:4,bytesPerSphericalHarmonicsComponent:2,scaleOffsetBytes:6,rotationOffsetBytes:12,colorOffsetBytes:20,sphericalHarmonicsOffsetBytes:24,scaleRange:32767},2:{bytesPerCenter:6,bytesPerScale:6,bytesPerRotation:8,bytesPerColor:4,bytesPerSphericalHarmonicsComponent:1,scaleOffsetBytes:6,rotationOffsetBytes:12,colorOffsetBytes:20,sphericalHarmonicsOffsetBytes:24,scaleRange:32767}},Pe={0:0,1:9,2:24,3:45};function Ws(s,A,t,e){var u;let r=0;const g=new DataView(s.buffer,r,4096);r+=4096;const o=g.getUint8(0),a=g.getUint8(1);if(o!==0||a<1)throw new Error(`Unsupported .ksplat version: ${o}.${a}`);const I=g.getUint32(4,!0);g.getUint32(16,!0);const C=g.getUint16(20,!0);if(C<0||C>2)throw new Error(`Invalid .ksplat compression level: ${C}`);const h=g.getFloat32(36,!0)||-1.5,B=g.getFloat32(40,!0)||1.5;let E=4096+I*1024;for(let l=0;l<I;++l){let Q=function(rA,J){if(C===0)return U.getFloat32(rA+R+J*4,!0);if(C===1)return $(U.getUint16(rA+R+J*2,!0));const lA=U.getUint8(rA+R+J)/255;return h+lA*(B-h)};const y=new DataView(s.buffer,r,1024);r+=1024;const c=y.getUint32(0,!0),f=y.getUint32(4,!0),p=y.getUint32(8,!0),d=y.getUint32(12,!0),z=y.getFloat32(16,!0),m=y.getUint16(20,!0),w=(y.getUint32(24,!0)||((u=mt[C])==null?void 0:u.scaleRange))??1,Y=y.getUint32(32,!0),D=Y*p,x=y.getUint32(36,!0),M=x*4,F=m*d+M,S=y.getUint16(40,!0),G=Pe[S],{bytesPerCenter:T,bytesPerScale:q,bytesPerRotation:v,bytesPerColor:W,bytesPerSphericalHarmonicsComponent:Z,scaleOffsetBytes:P,rotationOffsetBytes:H,colorOffsetBytes:K,sphericalHarmonicsOffsetBytes:R}=mt[C],_=T+q+v+W+G*Z,N=_*f,sA=N+F,iA=[0,3,6,1,4,7,2,5,8],aA=[9,14,19,10,15,20,11,16,21,12,17,22,13,18,23],gA=[24,31,38,25,32,39,26,33,40,27,34,41,28,35,42,29,36,43,30,37,44],IA=S>=1?new Float32Array(3*3):void 0,CA=S>=2?new Float32Array(5*3):void 0,MA=S>=3?new Float32Array(7*3):void 0,BA=z/2/w,QA=E+M,cA=E+F,U=new DataView(s.buffer,cA,N),nA=new Float32Array(s.buffer,QA,d*3),j=new Uint32Array(s.buffer,E,x);let L=Y,_A=D;for(let rA=0;rA<c;++rA){const J=rA*_;let lA;if(rA<D)lA=Math.floor(rA/p);else{const SA=j[L-Y];rA>=_A+SA&&(L+=1,_A+=SA),lA=L}const AA=C===0?U.getFloat32(J+0,!0):(U.getUint16(J+0,!0)-w)*BA+nA[3*lA+0],b=C===0?U.getFloat32(J+4,!0):(U.getUint16(J+2,!0)-w)*BA+nA[3*lA+1],pA=C===0?U.getFloat32(J+8,!0):(U.getUint16(J+4,!0)-w)*BA+nA[3*lA+2],nt=C===0?U.getFloat32(J+P+0,!0):$(U.getUint16(J+P+0,!0)),rt=C===0?U.getFloat32(J+P+4,!0):$(U.getUint16(J+P+2,!0)),Vt=C===0?U.getFloat32(J+P+8,!0):$(U.getUint16(J+P+4,!0)),jt=C===0?U.getFloat32(J+H+0,!0):$(U.getUint16(J+H+0,!0)),$t=C===0?U.getFloat32(J+H+4,!0):$(U.getUint16(J+H+2,!0)),Ae=C===0?U.getFloat32(J+H+8,!0):$(U.getUint16(J+H+4,!0)),te=C===0?U.getFloat32(J+H+12,!0):$(U.getUint16(J+H+6,!0)),ee=U.getUint8(J+K+0)/255,se=U.getUint8(J+K+1)/255,ie=U.getUint8(J+K+2)/255,ne=U.getUint8(J+K+3)/255;if(t(rA,AA,b,pA,nt,rt,Vt,$t,Ae,te,jt,ne,ee,se,ie),S>=1&&IA){for(const[SA,LA]of iA.entries())IA[SA]=Q(J,LA);if(CA)for(const[SA,LA]of aA.entries())CA[SA]=Q(J,LA);if(MA)for(const[SA,LA]of gA.entries())MA[SA]=Q(J,LA);e==null||e(rA,IA,CA,MA)}}E+=sA}}function Os(s,A){var y;let i=0;const n=new DataView(s.buffer,i,4096);i+=4096;const r=n.getUint8(0),g=n.getUint8(1);if(r!==0||g<1)throw new Error(`Unsupported .ksplat version: ${r}.${g}`);const o=n.getUint32(4,!0),a=n.getUint32(16,!0),I=n.getUint16(20,!0);if(I<0||I>2)throw new Error(`Invalid .ksplat compression level: ${I}`);const C=n.getFloat32(36,!0)||-1.5,h=n.getFloat32(40,!0)||1.5,B=a,E=lt(B),u=new Uint32Array(E*4),l={};let Q=4096+o*1024;for(let c=0;c<o;++c){let f=function(AA,b){if(I===0)return L.getFloat32(AA+sA+b*4,!0);if(I===1)return $(L.getUint16(AA+sA+b*2,!0));const pA=L.getUint8(AA+sA+b)/255;return C+pA*(h-C)};const p=new DataView(s.buffer,i,1024);i+=1024;const d=p.getUint32(0,!0),z=p.getUint32(4,!0),m=p.getUint32(8,!0),w=p.getUint32(12,!0),Y=p.getFloat32(16,!0),D=p.getUint16(20,!0),x=(p.getUint32(24,!0)||((y=mt[I])==null?void 0:y.scaleRange))??1,M=p.getUint32(32,!0),F=M*m,S=p.getUint32(36,!0),G=S*4,T=D*w+G,q=p.getUint16(40,!0),v=Pe[q],{bytesPerCenter:W,bytesPerScale:Z,bytesPerRotation:P,bytesPerColor:H,bytesPerSphericalHarmonicsComponent:K,scaleOffsetBytes:R,rotationOffsetBytes:_,colorOffsetBytes:N,sphericalHarmonicsOffsetBytes:sA}=mt[I],iA=W+Z+P+H+v*K,aA=iA*z,gA=aA+T,IA=[0,3,6,1,4,7,2,5,8],CA=[9,14,19,10,15,20,11,16,21,12,17,22,13,18,23],MA=[24,31,38,25,32,39,26,33,40,27,34,41,28,35,42,29,36,43,30,37,44],BA=q>=1?new Float32Array(3*3):void 0,QA=q>=2?new Float32Array(5*3):void 0,cA=q>=3?new Float32Array(7*3):void 0,U=Y/2/x,nA=Q+G,j=Q+T,L=new DataView(s.buffer,j,aA),_A=new Float32Array(s.buffer,nA,w*3),rA=new Uint32Array(s.buffer,Q,S);let J=M,lA=F;for(let AA=0;AA<d;++AA){const b=AA*iA;let pA;if(AA<F)pA=Math.floor(AA/m);else{const RA=rA[J-M];AA>=lA+RA&&(J+=1,lA+=RA),pA=J}const nt=I===0?L.getFloat32(b+0,!0):(L.getUint16(b+0,!0)-x)*U+_A[3*pA+0],rt=I===0?L.getFloat32(b+4,!0):(L.getUint16(b+2,!0)-x)*U+_A[3*pA+1],Vt=I===0?L.getFloat32(b+8,!0):(L.getUint16(b+4,!0)-x)*U+_A[3*pA+2],jt=I===0?L.getFloat32(b+R+0,!0):$(L.getUint16(b+R+0,!0)),$t=I===0?L.getFloat32(b+R+4,!0):$(L.getUint16(b+R+2,!0)),Ae=I===0?L.getFloat32(b+R+8,!0):$(L.getUint16(b+R+4,!0)),te=I===0?L.getFloat32(b+_+0,!0):$(L.getUint16(b+_+0,!0)),ee=I===0?L.getFloat32(b+_+4,!0):$(L.getUint16(b+_+2,!0)),se=I===0?L.getFloat32(b+_+8,!0):$(L.getUint16(b+_+4,!0)),ie=I===0?L.getFloat32(b+_+12,!0):$(L.getUint16(b+_+6,!0)),ne=L.getUint8(b+N+0)/255,SA=L.getUint8(b+N+1)/255,LA=L.getUint8(b+N+2)/255,yi=L.getUint8(b+N+3)/255;if(qt(u,AA,nt,rt,Vt,jt,$t,Ae,ee,se,ie,te,yi,ne,SA,LA,A),q>=1){if(BA){l.sh1||(l.sh1=new Uint32Array(B*2));for(const[RA,gt]of IA.entries())BA[RA]=f(b,gt);ft(l.sh1,AA,BA,A)}if(QA){l.sh2||(l.sh2=new Uint32Array(B*4));for(const[RA,gt]of CA.entries())QA[RA]=f(b,gt);yt(l.sh2,AA,QA,A)}if(cA){l.sh3||(l.sh3=new Uint32Array(B*4));for(const[RA,gt]of MA.entries())cA[RA]=f(b,gt);wt(l.sh3,AA,cA,A)}}}Q+=gA}return{packedArray:u,numSplats:B,extra:l}}const We=["char","uchar","short","ushort","int","uint","float","double"],VA=class VA{constructor({fileBytes:A}){this.header="",this.littleEndian=!0,this.elements={},this.comments=[],this.data=null,this.numSplats=0,this.fileBytes=A instanceof ArrayBuffer?new Uint8Array(A):A}async parseHeader(){const t=new ReadableStream({start:r=>{r.enqueue(this.fileBytes.slice(0,65536)),r.close()}}).pipeThrough(new TextDecoderStream).getReader();this.header="";const e=`end_header\n`;for(;;){const{value:r,done:g}=await t.read();if(g)throw new Error("Failed to read header");this.header+=r;const o=this.header.indexOf(e);if(o>=0){this.header=this.header.slice(0,o+e.length);break}}const i=new TextEncoder().encode(this.header).length;this.data=new DataView(this.fileBytes.buffer,i),this.elements={};let n=null;this.comments=[],this.header.trim().split(`\n`).forEach((r,g)=>{const o=r.trim();if(g===0){if(o!=="ply")throw new Error("Invalid PLY header");return}if(o.length===0)return;const a=o.split(" ");switch(a[0]){case"format":if(a[1]==="binary_little_endian")this.littleEndian=!0;else if(a[1]==="binary_big_endian")this.littleEndian=!1;else throw new Error(`Unsupported PLY format: ${a[1]}`);if(a[2]!=="1.0")throw new Error(`Unsupported PLY version: ${a[2]}`);break;case"end_header":break;case"comment":this.comments.push(o.slice(8));break;case"element":{const I=a[1];n={name:I,count:Number.parseInt(a[2]),properties:{}},this.elements[I]=n;break}case"property":if(n==null)throw new Error("Property must be inside an element");a[1]==="list"?n.properties[a[4]]={isList:!0,type:a[3],countType:a[2]}:n.properties[a[2]]={isList:!1,type:a[1]};break}}),this.elements.vertex&&(this.numSplats=this.elements.vertex.count)}parseData(A){let t=0;const e=this.data;if(e==null)throw new Error("No data to parse");for(const i in this.elements){const n=this.elements[i],{count:r,properties:g}=n,o=$s(g),a=Ai(g,this.littleEndian),I=A(n)??(()=>{});for(let C=0;C<r;C++)t=a(e,t,o),I(C,o)}}parseSplats(A,t){if(this.elements.vertex==null)throw new Error("No vertex element found");let e=!1;const i=[];let n=0,r=[],g=[],o=[],a,I,C;function h(){const Q=js[n];r=new Array(3).fill(null).flatMap((y,c)=>[0,1,2].map((f,p)=>c+p*Q/3)),g=new Array(5).fill(null).flatMap((y,c)=>[0,1,2].map((f,p)=>3+c+p*Q/3)),o=new Array(7).fill(null).flatMap((y,c)=>[0,1,2].map((f,p)=>8+c+p*Q/3)),a=n>=1?new Float32Array(3*3):void 0,I=n>=2?new Float32Array(5*3):void 0,C=n>=3?new Float32Array(7*3):void 0}function B(Q,y){if(!a)throw new Error("Missing sh1");const c=y.f_rest;for(let f=0;f<r.length;f++)a[f]=c[r[f]]*8/255-4;if(I)for(let f=0;f<g.length;f++)I[f]=c[g[f]]*8/255-4;if(C)for(let f=0;f<o.length;f++)C[f]=c[o[f]]*8/255-4;t==null||t(Q,a,I,C)}function E(Q){const{min_x:y,min_y:c,min_z:f,max_x:p,max_y:d,max_z:z,min_scale_x:m,min_scale_y:w,min_scale_z:Y,max_scale_x:D,max_scale_y:x,max_scale_z:M}=Q.properties;if(!y||!c||!f||!p||!d||!z||!m||!w||!Y||!D||!x||!M)throw new Error("Missing PLY chunk properties");return e=!0,(F,S)=>{const{min_x:G,min_y:T,min_z:q,max_x:v,max_y:W,max_z:Z,min_scale_x:P,min_scale_y:H,min_scale_z:K,max_scale_x:R,max_scale_y:_,max_scale_z:N,min_r:sA,min_g:iA,min_b:aA,max_r:gA,max_g:IA,max_b:CA}=S;i.push({min_x:G,min_y:T,min_z:q,max_x:v,max_y:W,max_z:Z,min_scale_x:P,min_scale_y:H,min_scale_z:K,max_scale_x:R,max_scale_y:_,max_scale_z:N,min_r:sA,min_g:iA,min_b:aA,max_r:gA,max_g:IA,max_b:CA})}}function u(Q){if(t&&Q.name==="sh")return n=Xt(Q.properties),h(),B;if(Q.name!=="vertex")return null;const{packed_position:y,packed_rotation:c,packed_scale:f,packed_color:p}=Q.properties;if(!y||!c||!f||!p)throw new Error("Missing PLY properties: packed_position, packed_rotation, packed_scale, packed_color");const d=Math.sqrt(2);return(z,m)=>{const w=i[z>>>8];if(w==null)throw new Error("Missing PLY chunk");const{min_x:Y,min_y:D,min_z:x,max_x:M,max_y:F,max_z:S,min_scale_x:G,min_scale_y:T,min_scale_z:q,max_scale_x:v,max_scale_y:W,max_scale_z:Z,min_r:P,min_g:H,min_b:K,max_r:R,max_g:_,max_b:N}=w,{packed_position:sA,packed_rotation:iA,packed_scale:aA,packed_color:gA}=m,IA=(sA>>>21&2047)/2047*(M-Y)+Y,CA=(sA>>>11&1023)/1023*(F-D)+D,MA=(sA&2047)/2047*(S-x)+x,BA=((iA>>>20&1023)/1023-.5)*d,QA=((iA>>>10&1023)/1023-.5)*d,cA=((iA&1023)/1023-.5)*d,U=Math.sqrt(Math.max(0,1-BA*BA-QA*QA-cA*cA)),nA=iA>>>30,j=nA===0?BA:nA===1?U:QA,L=nA<=1?QA:nA===2?U:cA,_A=nA<=2?cA:U,rA=nA===0?U:BA,J=Math.exp((aA>>>21&2047)/2047*(v-G)+G),lA=Math.exp((aA>>>11&1023)/1023*(W-T)+T),AA=Math.exp((aA&2047)/2047*(Z-q)+q),b=(gA>>>24&255)/255*((R??1)-(P??0))+(P??0),pA=(gA>>>16&255)/255*((_??1)-(H??0))+(H??0),nt=(gA>>>8&255)/255*((N??1)-(K??0))+(K??0),rt=(gA&255)/255;A(z,IA,CA,MA,J,lA,AA,j,L,_A,rA,rt,b,pA,nt)}}const l=Q=>{if(Q.name==="chunk")return E(Q);if(e)return u(Q);if(Q.name!=="vertex")return null;const{x:y,y:c,z:f,scale_0:p,scale_1:d,scale_2:z,rot_0:m,rot_1:w,rot_2:Y,rot_3:D,opacity:x,f_dc_0:M,f_dc_1:F,f_dc_2:S,red:G,green:T,blue:q,alpha:v}=Q.properties;if(!y||!c||!f)throw new Error("Missing PLY properties: x, y, z");const W=p&&d&&z,Z=m&&w&&Y&&D,P=v!=null?Dt[v.type]:1,H=G!=null?Dt[G.type]:1,K=T!=null?Dt[T.type]:1,R=q!=null?Dt[q.type]:1;return n=Xt(Q.properties),h(),(_,N)=>{const sA=W?Math.exp(N.scale_0):VA.defaultPointScale,iA=W?Math.exp(N.scale_1):VA.defaultPointScale,aA=W?Math.exp(N.scale_2):VA.defaultPointScale,gA=Z?N.rot_1:0,IA=Z?N.rot_2:0,CA=Z?N.rot_3:0,MA=Z?N.rot_0:1,BA=x!=null?1/(1+Math.exp(-N.opacity)):v!=null?N.alpha/P:1,QA=M!=null?N.f_dc_0*xt+.5:G!=null?N.red/H:1,cA=F!=null?N.f_dc_1*xt+.5:T!=null?N.green/K:1,U=S!=null?N.f_dc_2*xt+.5:q!=null?N.blue/R:1;if(A(_,N.x,N.y,N.z,sA,iA,aA,gA,IA,CA,MA,BA,QA,cA,U),t&&a){const nA=N.f_rest;if(a)for(let j=0;j<r.length;j++)a[j]=nA[r[j]];if(I)for(let j=0;j<g.length;j++)I[j]=nA[g[j]];if(C)for(let j=0;j<o.length;j++)C[j]=nA[o[j]];t(_,a,I,C)}}};this.parseData(l)}injectRgba(A){let t=0;const e=this.data;if(e==null)throw new Error("No parsed data");if(A.length!==this.numSplats*4)throw new Error("Invalid RGBA array length");for(const i in this.elements){const n=this.elements[i],{count:r,properties:g}=n,o=[];let a=0;const I=i==="vertex";if(I){for(const C of["opacity","f_dc_0","f_dc_1","f_dc_2"])if(!g[C]||g[C].type!=="float")throw new Error(`Can\'t injectRgba due to property: ${C}`)}for(const[C,h]of Object.entries(g))if(h.isList)o.push(()=>{const B=OA[h.countType](e,t,this.littleEndian);t+=mA[h.countType],t+=B*mA[h.type]});else{if(I)if(C==="f_dc_0"||C==="f_dc_1"||C==="f_dc_2"){const B=Number.parseInt(C.slice(5));o.push(()=>{const E=(A[a+B]/255-.5)/xt;Oe[h.type](e,t,this.littleEndian,E)})}else C==="opacity"&&o.push(()=>{const B=Math.max(-100,Math.min(100,-Math.log(1/(A[a+3]/255)-1)));Oe[h.type](e,t,this.littleEndian,B)});o.push(()=>{t+=mA[h.type]})}for(let C=0;C<r;C++){for(const h of o)h();I&&(a+=4)}}}};VA.defaultPointScale=.001;let pt=VA;const xt=.28209479177387814,OA={char:(s,A,t)=>s.getInt8(A),uchar:(s,A,t)=>s.getUint8(A),short:(s,A,t)=>s.getInt16(A,t),ushort:(s,A,t)=>s.getUint16(A,t),int:(s,A,t)=>s.getInt32(A,t),uint:(s,A,t)=>s.getUint32(A,t),float:(s,A,t)=>s.getFloat32(A,t),double:(s,A,t)=>s.getFloat64(A,t)},Oe={char:(s,A,t,e)=>{s.setInt8(A,e)},uchar:(s,A,t,e)=>{s.setUint8(A,e)},short:(s,A,t,e)=>{s.setInt16(A,e,t)},ushort:(s,A,t,e)=>{s.setUint16(A,e,t)},int:(s,A,t,e)=>{s.setInt32(A,e,t)},uint:(s,A,t,e)=>{s.setUint32(A,e,t)},float:(s,A,t,e)=>{s.setFloat32(A,e,t)},double:(s,A,t,e)=>{s.setFloat64(A,e,t)}},mA={char:1,uchar:1,short:2,ushort:2,int:4,uint:4,float:4,double:8},Dt={char:127,uchar:255,short:32767,ushort:65535,int:2147483647,uint:4294967295,float:1,double:1},Vs={0:0,9:1,24:2,45:3},js={0:0,1:9,2:24,3:45},Zt=/^f_rest_([0-9]{1,2})$/;function $s(s){const A={};for(const[t,e]of Object.entries(s))Zt.test(t)?A.f_rest=new Array(Xt(s)):A[t]=e.isList?[]:0;return A}function Ai(s,A){return si(s)?ii(s,A):ni(s,A)}const ti=(()=>{try{new Function("return 42;")}catch{return!1}return!0})(),ei=/^[a-zA-Z0-9_]+$/;function si(s){if(!ti)return!1;for(const[A,t]of Object.entries(s))if(!ei.test(A)||t.isList&&!We.includes(t.countType)||!We.includes(t.type))return!1;return!0}function ii(s,A){const t=["let list;"];for(const[i,n]of Object.entries(s)){const r=i.match(Zt);if(r){const g=+r[1];t.push(`\n        item.f_rest[${g}] = PARSE_FIELD[\'${n.type}\'](data, offset, ${A});\n        offset += ${mA[n.type]};\n      `)}else n.isList?t.push(`\n        list = item[\'${i}\'];\n        list.length = PARSE_FIELD[\'${n.countType}\'](data, offset, ${A});\n        offset += ${mA[n.countType]};\n        for (let i = 0; i < list.length; i++) {\n          list[i] = PARSE_FIELD[\'${n.type}\'](data, offset, ${A});\n          offset += ${mA[n.type]};\n        }\n      `):t.push(`\n        item[\'${i}\'] = PARSE_FIELD[\'${n.type}\'](data, offset, ${A});\n        offset += ${mA[n.type]};\n      `)}t.push("return offset;");const e=new Function("data","offset","item","PARSE_FIELD",t.join(`\n`));return(i,n,r)=>e(i,n,r,OA)}function ni(s,A){const t=[];for(const[e,i]of Object.entries(s)){const n=e.match(Zt);if(n){const r=+n[1];t.push((g,o,a)=>(a.f_rest[r]=OA[i.type](g,o,A),o+mA[i.type]))}else i.isList?t.push((r,g,o)=>{const a=o[e];a.length=OA[i.countType](r,g,A);let I=g+mA[i.countType];for(let C=0;C<a.length;C++)a[C]=OA[i.type](r,I,A),I+=mA[i.type];return I}):t.push((r,g,o)=>(o[e]=OA[i.type](r,g,A),g+mA[i.type]))}return(e,i,n)=>{let r=i;for(let g=0;g<t.length;g++)r=t[g](e,r,n);return r}}function Xt(s){let A=0;for(;s[`f_rest_${A}`];)A+=1;const t=Vs[A];if(t==null)throw new Error(`Unsupported number of SH coefficients: ${A}`);return t}var st=(s=>(s.PLY="ply",s.SPZ="spz",s.SPLAT="splat",s.KSPLAT="ksplat",s.PCSOGS="pcsogs",s.PCSOGSZIP="pcsogszip",s))(st||{});function ri(s){const A=new DataView(s.buffer);if((A.getUint32(0,!0)&16777215)===7957616)return"ply";if((A.getUint32(0,!0)&16777215)===559903){const t=Zs(s,4);return new DataView(t.buffer).getUint32(0,!0)===1347635022?"spz":void 0}if(A.getUint32(0,!0)===67324752)return Ve(s)?"pcsogszip":void 0}function gi(s){const A=s.split(/[?#]/,1)[0],t=Math.max(A.lastIndexOf("/"),A.lastIndexOf("\\\\")),e=A.slice(t+1),i=e.lastIndexOf(".");return i<=0||i===e.length-1?"":e.slice(i+1).toLowerCase()}function oi(s){const A=gi(s);if(A==="ply")return"ply";if(A==="spz")return"spz";if(A==="splat")return"splat";if(A==="ksplat")return"ksplat";if(A==="sog")return"pcsogszip"}function ai(s){try{let A;if(typeof s=="string")A=s;else{const i=s instanceof ArrayBuffer?new Uint8Array(s):s;if(i.length>65536)return;A=new TextDecoder().decode(i)}const t=JSON.parse(A);if(!t||typeof t!="object"||Array.isArray(t))return;const e=t.version===2;for(const i of["means","scales","quats","sh0"]){if(!t[i]||typeof t[i]!="object"||Array.isArray(t[i]))return;if(e){if(!t[i].files||(i==="scales"||i==="sh0")&&!t[i].codebook||i==="means"&&(!t[i].mins||!t[i].maxs))return}else if(!t[i].shape||!t[i].files||i!=="quats"&&(!t[i].mins||!t[i].maxs))return}return t}catch{return}}function Ve(s){try{const A=s instanceof ArrayBuffer?new Uint8Array(s):s;let t=null;const e=Fs(A,{filter:({name:n})=>n.split(/[\\\\/]/).pop()==="meta.json"?(t=n,!0):!1});if(!t)return;const i=ai(e[t]);return i?{name:t,json:i}:void 0}catch{return}}class Ii{constructor({maxSplats:A=1}={}){this.numSplats=0,this.maxSplats=Ks(A).maxSplats,this.centers=new Float32Array(this.maxSplats*3),this.scales=new Float32Array(this.maxSplats*3),this.quaternions=new Float32Array(this.maxSplats*4),this.opacities=new Float32Array(this.maxSplats),this.colors=new Float32Array(this.maxSplats*3)}pushSplat(){const A=this.numSplats;return this.ensureIndex(A),this.numSplats+=1,A}unpushSplat(A){if(A===this.numSplats-1)this.numSplats-=1;else throw new Error("Cannot unpush splat from non-last position")}ensureCapacity(A){if(A>this.maxSplats){const t=Math.max(A,this.maxSplats*2),e=new Float32Array(t*3),i=new Float32Array(t*3),n=new Float32Array(t*4),r=new Float32Array(t),g=new Float32Array(t*3);if(e.set(this.centers),i.set(this.scales),n.set(this.quaternions),r.set(this.opacities),g.set(this.colors),this.centers=e,this.scales=i,this.quaternions=n,this.opacities=r,this.colors=g,this.sh1){const o=new Float32Array(t*9);o.set(this.sh1),this.sh1=o}if(this.sh2){const o=new Float32Array(t*15);o.set(this.sh2),this.sh2=o}if(this.sh3){const o=new Float32Array(t*21);o.set(this.sh3),this.sh3=o}this.maxSplats=t}}ensureIndex(A){this.ensureCapacity(A+1)}setCenter(A,t,e,i){this.centers[A*3]=t,this.centers[A*3+1]=e,this.centers[A*3+2]=i}setScale(A,t,e,i){this.scales[A*3]=t,this.scales[A*3+1]=e,this.scales[A*3+2]=i}setQuaternion(A,t,e,i,n){this.quaternions[A*4]=t,this.quaternions[A*4+1]=e,this.quaternions[A*4+2]=i,this.quaternions[A*4+3]=n}setOpacity(A,t){this.opacities[A]=t}setColor(A,t,e,i){this.colors[A*3]=t,this.colors[A*3+1]=e,this.colors[A*3+2]=i}setSh1(A,t){this.sh1||(this.sh1=new Float32Array(this.maxSplats*9));for(let e=0;e<9;++e)this.sh1[A*9+e]=t[e]}setSh2(A,t){this.sh2||(this.sh2=new Float32Array(this.maxSplats*15));for(let e=0;e<15;++e)this.sh2[A*15+e]=t[e]}setSh3(A,t){this.sh3||(this.sh3=new Float32Array(this.maxSplats*21));for(let e=0;e<21;++e)this.sh3[A*21+e]=t[e]}}async function je(s,A,t){const e="version"in s;if(!e&&s.quats.encoding!=="quaternion_packed")throw new Error("Unsupported quaternion encoding");const i=e?s.count:s.means.shape[0],n=lt(i),r=new Uint32Array(n*4),g={},o=Promise.all([it(A[s.means.files[0]]),it(A[s.means.files[1]])]).then(B=>{for(let E=0;E<i;++E){const u=E*4,l=(B[0][u+0]+(B[1][u+0]<<8))/65535,Q=(B[0][u+1]+(B[1][u+1]<<8))/65535,y=(B[0][u+2]+(B[1][u+2]<<8))/65535;let c=s.means.mins[0]+(s.means.maxs[0]-s.means.mins[0])*l,f=s.means.mins[1]+(s.means.maxs[1]-s.means.mins[1])*Q,p=s.means.mins[2]+(s.means.maxs[2]-s.means.mins[2])*y;c=Math.sign(c)*(Math.exp(Math.abs(c))-1),f=Math.sign(f)*(Math.exp(Math.abs(f))-1),p=Math.sign(p)*(Math.exp(Math.abs(p))-1),Le(r,E,c,f,p)}}),a=it(A[s.scales.files[0]]).then(B=>{let E,u,l;e?E=u=l=s.scales.codebook.map(Q=>Math.exp(Q)):(E=new Array(256).fill(0).map((Q,y)=>s.scales.mins[0]+(s.scales.maxs[0]-s.scales.mins[0])*(y/255)).map(Q=>Math.exp(Q)),u=new Array(256).fill(0).map((Q,y)=>s.scales.mins[1]+(s.scales.maxs[1]-s.scales.mins[1])*(y/255)).map(Q=>Math.exp(Q)),l=new Array(256).fill(0).map((Q,y)=>s.scales.mins[2]+(s.scales.maxs[2]-s.scales.mins[2])*(y/255)).map(Q=>Math.exp(Q)));for(let Q=0;Q<i;++Q){const y=Q*4;Te(r,Q,E[B[y+0]],u[B[y+1]],l[B[y+2]],t)}}),I=it(A[s.quats.files[0]]).then(B=>{const E=Math.sqrt(2),u=new Array(256).fill(0).map((l,Q)=>(Q/255-.5)*E);for(let l=0;l<i;++l){const Q=l*4,y=u[B[Q+0]],c=u[B[Q+1]],f=u[B[Q+2]],p=Math.sqrt(Math.max(0,1-y*y-c*c-f*f)),d=B[Q+3]-252,z=d===0?y:d===1?p:c,m=d<=1?c:d===2?p:f,w=d<=2?f:p;Ke(r,l,z,m,w,d===0?p:y)}}),C=it(A[s.sh0.files[0]]).then(B=>{const E=.28209479177387814;let u,l,Q,y;e?(u=l=Q=s.sh0.codebook.map(c=>E*c+.5),y=new Array(256).fill(0).map((c,f)=>f/255)):(u=new Array(256).fill(0).map((c,f)=>s.sh0.mins[0]+(s.sh0.maxs[0]-s.sh0.mins[0])*(f/255)).map(c=>E*c+.5),l=new Array(256).fill(0).map((c,f)=>s.sh0.mins[1]+(s.sh0.maxs[1]-s.sh0.mins[1])*(f/255)).map(c=>E*c+.5),Q=new Array(256).fill(0).map((c,f)=>s.sh0.mins[2]+(s.sh0.maxs[2]-s.sh0.mins[2])*(f/255)).map(c=>E*c+.5),y=new Array(256).fill(0).map((c,f)=>s.sh0.mins[3]+(s.sh0.maxs[3]-s.sh0.mins[3])*(f/255)).map(c=>1/(1+Math.exp(-c))));for(let c=0;c<i;++c){const f=c*4;Ls(r,c,u[B[f+0]],l[B[f+1]],Q[B[f+2]],y[B[f+3]],t)}}),h=[o,a,I,C];if(s.shN){const B=e?s.shN.bands>=3:s.shN.shape[1]>=45,E=e?s.shN.bands>=2:s.shN.shape[1]>=24,u=e?s.shN.bands>=1:s.shN.shape[1]>=9;u&&(g.sh1=new Uint32Array(i*2)),E&&(g.sh2=new Uint32Array(i*4)),B&&(g.sh3=new Uint32Array(i*4));const l=new Float32Array(9),Q=new Float32Array(15),y=new Float32Array(21),c=s.shN,f=Promise.all([Pt(A[s.shN.files[0]]),Pt(A[s.shN.files[1]])]).then(([p,d])=>{const z="codebook"in c?c.codebook:new Array(256).fill(0).map((m,w)=>c.mins+(c.maxs-c.mins)*(w/255));for(let m=0;m<i;++m){const w=m*4,Y=d.rgba[w+0]+(d.rgba[w+1]<<8),D=(Y&63)*15,M=(Y>>>6)*p.width+D;for(let F=0;F<3;++F){if(u)for(let S=0;S<3;++S)l[S*3+F]=z[p.rgba[(M+S)*4+F]];if(E)for(let S=0;S<5;++S)Q[S*3+F]=z[p.rgba[(M+3+S)*4+F]];if(B)for(let S=0;S<7;++S)y[S*3+F]=z[p.rgba[(M+8+S)*4+F]]}u&&ft(g.sh1,m,l,t),E&&yt(g.sh2,m,Q,t),B&&wt(g.sh3,m,y,t)}});h.push(f)}return await Promise.all(h),{packedArray:r,numSplats:i,extra:g}}let St=null;async function Pt(s){if(!St&&(St=new OffscreenCanvas(1,1).getContext("webgl2"),!St))throw new Error("Failed to create WebGL2 context");const A=new Blob([s]),t=await createImageBitmap(A,{premultiplyAlpha:"none"}),e=St,i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0);const r=new Uint8Array(t.width*t.height*4);return e.readPixels(0,0,t.width,t.height,e.RGBA,e.UNSIGNED_BYTE,r),e.deleteTexture(i),e.deleteFramebuffer(n),{rgba:r,width:t.width,height:t.height}}async function it(s){const{rgba:A}=await Pt(s);return A}async function Ci(s,A){var h;const t=Ve(s);if(!t)throw new Error("Invalid PC SOGS zip file");const{name:e,json:i}=t,n=e.lastIndexOf("/"),r=e.lastIndexOf("\\\\"),g=e.slice(0,Math.max(n,r)+1),o=new Map,a=[...i.means.files,...i.scales.files,...i.quats.files,...i.sh0.files,...((h=i.shN)==null?void 0:h.files)??[]];for(const B of a)o.set(g+B,B);const I=await new Promise((B,E)=>{Ss(s,{filter:({name:u})=>o.has(u)},(u,l)=>{u?E(u):B(l)})}),C={};for(const[B,E]of o.entries())C[E]=I[B];return await je(i,C,A)}class $e{constructor({fileBytes:A}){this.version=-1,this.numSplats=0,this.shDegree=0,this.fractionalBits=0,this.flags=0,this.flagAntiAlias=!1,this.reserved=0,this.headerParsed=!1,this.parsed=!1,this.fileBytes=A instanceof ArrayBuffer?new Uint8Array(A):A,this.reader=new Xs({fileBytes:this.fileBytes})}async parseHeader(){if(this.headerParsed)throw new Error("SPZ file header already parsed");const A=new DataView((await this.reader.read(16)).buffer);if(A.getUint32(0,!0)!==1347635022)throw new Error("Invalid SPZ file");if(this.version=A.getUint32(4,!0),this.version<1||this.version>3)throw new Error(`Unsupported SPZ version: ${this.version}`);this.numSplats=A.getUint32(8,!0),this.shDegree=A.getUint8(12),this.fractionalBits=A.getUint8(13),this.flags=A.getUint8(14),this.flagAntiAlias=(this.flags&1)!==0,this.reserved=A.getUint8(15),this.headerParsed=!0,this.parsed=!1}async parseSplats(A,t,e,i,n,r){if(!this.headerParsed)throw new Error("SPZ file header must be parsed first");if(this.parsed)throw new Error("SPZ file already parsed");if(this.parsed=!0,this.version===1){const g=await this.reader.read(this.numSplats*3*2),o=new Uint16Array(g.buffer);for(let a=0;a<this.numSplats;a++){const I=a*3,C=$(o[I]),h=$(o[I+1]),B=$(o[I+2]);A==null||A(a,C,h,B)}}else if(this.version===2||this.version===3){const g=1<<this.fractionalBits,o=await this.reader.read(this.numSplats*3*3);for(let a=0;a<this.numSplats;a++){const I=a*9,C=((o[I+2]<<24|o[I+1]<<16|o[I]<<8)>>8)/g,h=((o[I+5]<<24|o[I+4]<<16|o[I+3]<<8)>>8)/g,B=((o[I+8]<<24|o[I+7]<<16|o[I+6]<<8)>>8)/g;A==null||A(a,C,h,B)}}else throw new Error("Unreachable");{const g=await this.reader.read(this.numSplats);for(let o=0;o<this.numSplats;o++)t==null||t(o,g[o]/255)}{const g=await this.reader.read(this.numSplats*3),o=ts/.15;for(let a=0;a<this.numSplats;a++){const I=a*3,C=(g[I]/255-.5)*o+.5,h=(g[I+1]/255-.5)*o+.5,B=(g[I+2]/255-.5)*o+.5;e==null||e(a,C,h,B)}}{const g=await this.reader.read(this.numSplats*3);for(let o=0;o<this.numSplats;o++){const a=o*3,I=Math.exp(g[a]/16-10),C=Math.exp(g[a+1]/16-10),h=Math.exp(g[a+2]/16-10);i==null||i(o,I,C,h)}}if(this.version===3){const g=1/Math.sqrt(2),o=await this.reader.read(this.numSplats*4);for(let a=0;a<this.numSplats;a++){const I=a*4,C=[0,0,0,0],h=[o[I],o[I+1],o[I+2],o[I+3]],B=h[0]+(h[1]<<8)+(h[2]<<16)+(h[3]<<24),E=511,u=B>>>30;let l=B,Q=0;for(let c=3;c>=0;--c)if(c!==u){const f=l&E,p=l>>>9&1;l=l>>>10,C[c]=g*(f/E),C[c]=p===0?C[c]:-C[c],Q+=C[c]*C[c]}const y=1-Q;C[u]=Math.sqrt(Math.max(y,0)),n==null||n(a,C[0],C[1],C[2],C[3])}}else{const g=await this.reader.read(this.numSplats*3);for(let o=0;o<this.numSplats;o++){const a=o*3,I=g[a]/127.5-1,C=g[a+1]/127.5-1,h=g[a+2]/127.5-1,B=Math.sqrt(Math.max(0,1-I*I-C*C-h*h));n==null||n(o,I,C,h,B)}}if(r&&this.shDegree>=1){const g=new Float32Array(9),o=this.shDegree>=2?new Float32Array(5*3):void 0,a=this.shDegree>=3?new Float32Array(7*3):void 0,I=await this.reader.read(this.numSplats*As[this.shDegree]*3);let C=0;for(let h=0;h<this.numSplats;h++){for(let B=0;B<9;++B)g[B]=(I[C+B]-128)/128;if(C+=9,o){for(let B=0;B<15;++B)o[B]=(I[C+B]-128)/128;C+=15}if(a){for(let B=0;B<21;++B)a[B]=(I[C+B]-128)/128;C+=21}r==null||r(h,g,o,a)}}}}const As={1:3,2:8,3:15},ts=.28209479177387814,Bi=1347635022,hi=3,Ei=1;class JA{constructor({numSplats:A,shDegree:t,fractionalBits:e=12,flagAntiAlias:i=!0}){this.clippedCount=0;const n=20+(t>=1?9:0)+(t>=2?15:0)+(t>=3?21:0),r=16+A*n;this.buffer=new ArrayBuffer(r),this.view=new DataView(this.buffer),this.view.setUint32(0,Bi,!0),this.view.setUint32(4,hi,!0),this.view.setUint32(8,A,!0),this.view.setUint8(12,t),this.view.setUint8(13,e),this.view.setUint8(14,i?Ei:0),this.view.setUint8(15,0),this.numSplats=A,this.shDegree=t,this.fractionalBits=e,this.fraction=1<<e,this.flagAntiAlias=i}setCenter(A,t,e,i){const n=Math.round(t*this.fraction),r=Math.max(-8388607,Math.min(8388607,n)),g=Math.round(e*this.fraction),o=Math.max(-8388607,Math.min(8388607,g)),a=Math.round(i*this.fraction),I=Math.max(-8388607,Math.min(8388607,a));(n!==r||g!==o||a!==I)&&(this.clippedCount+=1);const B=16+A*9;this.view.setUint8(B,r&255),this.view.setUint8(B+1,r>>8&255),this.view.setUint8(B+2,r>>16&255),this.view.setUint8(B+3,o&255),this.view.setUint8(B+4,o>>8&255),this.view.setUint8(B+5,o>>16&255),this.view.setUint8(B+6,I&255),this.view.setUint8(B+7,I>>8&255),this.view.setUint8(B+8,I>>16&255)}setAlpha(A,t){const e=16+this.numSplats*9+A;this.view.setUint8(e,Math.max(0,Math.min(255,Math.round(t*255))))}static scaleRgb(A){const t=((A-.5)/(ts/.15)+.5)*255;return Math.max(0,Math.min(255,Math.round(t)))}setRgb(A,t,e,i){const n=16+this.numSplats*10+A*3;this.view.setUint8(n,JA.scaleRgb(t)),this.view.setUint8(n+1,JA.scaleRgb(e)),this.view.setUint8(n+2,JA.scaleRgb(i))}setScale(A,t,e,i){const n=16+this.numSplats*13+A*3;this.view.setUint8(n,Math.max(0,Math.min(255,Math.round((Math.log(t)+10)*16)))),this.view.setUint8(n+1,Math.max(0,Math.min(255,Math.round((Math.log(e)+10)*16)))),this.view.setUint8(n+2,Math.max(0,Math.min(255,Math.round((Math.log(i)+10)*16))))}setQuat(A,...t){const e=16+this.numSplats*16+A*4,i=Js(t);let n=0;for(let o=1;o<4;++o)Math.abs(i[o])>Math.abs(i[n])&&(n=o);const r=i[n]<0?1:0;let g=n;for(let o=0;o<4;++o)if(o!==n){const a=(i[o]<0?1:0)^r,I=Math.floor(511*(Math.abs(i[o])/Math.SQRT1_2)+.5);g=g<<10|a<<9|I}this.view.setUint8(e,g&255),this.view.setUint8(e+1,g>>8&255),this.view.setUint8(e+2,g>>16&255),this.view.setUint8(e+3,g>>>24&255)}static quantizeSh(A,t){const e=Math.round(A*128)+128,i=1<<8-t,n=Math.floor((e+i/2)/i)*i;return Math.max(0,Math.min(255,n))}setSh(A,t,e,i){const n=As[this.shDegree]||0,r=16+this.numSplats*20+A*n*3;for(let g=0;g<9;++g)this.view.setUint8(r+g,JA.quantizeSh(t[g],5));if(e){const g=r+9;for(let o=0;o<15;++o)this.view.setUint8(g+o,JA.quantizeSh(e[o],4));if(i){const o=g+15;for(let a=0;a<21;++a)this.view.setUint8(o+a,JA.quantizeSh(i[a],4))}}}async finalize(){const A=new Uint8Array(this.buffer),e=new ReadableStream({async start(r){r.enqueue(A),r.close()}}).pipeThrough(new CompressionStream("gzip")),n=await new Response(e).arrayBuffer();return console.log("Compressed",A.length,"bytes to",n.byteLength,"bytes"),new Uint8Array(n)}}async function Qi(s){var I,C,h;const A=new Ii,{inputs:t,clipXyz:e,maxSh:i,fractionalBits:n=12,opacityThreshold:r}=s;for(const B of t){let E=function(m){return m.multiplyScalar(c),m.applyQuaternion(f),m.add(p),m},u=function(m){return m.multiplyScalar(c),m},l=function(m){return m.premultiply(f),m},Q=function(m){return!d||d.containsPoint(m)},y=function(m){return r!==void 0?m>=r:!0};const c=((I=B.transform)==null?void 0:I.scale)??1,f=new kA().fromArray(((C=B.transform)==null?void 0:C.quaternion)??[0,0,0,1]),p=new k().fromArray(((h=B.transform)==null?void 0:h.translate)??[0,0,0]),d=e?new Ye(new k().fromArray(e.min),new k().fromArray(e.max)):void 0;let z=B.fileType;switch(z||(z=ri(B.fileBytes),!z&&B.pathOrUrl&&(z=oi(B.pathOrUrl))),z){case st.PLY:{const m=new pt({fileBytes:B.fileBytes});await m.parseHeader();let w=null;m.parseSplats((Y,D,x,M,F,S,G,T,q,v,W,Z,P,H,K)=>{const R=E(new k(D,x,M));if(Q(R)&&y(Z)){w=A.pushSplat(),A.setCenter(w,R.x,R.y,R.z);const _=u(new k(F,S,G));A.setScale(w,_.x,_.y,_.z);const N=l(new kA(T,q,v,W));A.setQuaternion(w,N.x,N.y,N.z,N.w),A.setOpacity(w,Z),A.setColor(w,P,H,K)}else w=null},(Y,D,x,M)=>{D&&w!==null&&A.setSh1(w,D),x&&w!==null&&A.setSh2(w,x),M&&w!==null&&A.setSh3(w,M)});break}case st.SPZ:{const m=new $e({fileBytes:B.fileBytes});await m.parseHeader();const w=new Int32Array(m.numSplats);w.fill(-1);const Y=new Float32Array(m.numSplats*3),D=new k;m.parseSplats((x,M,F,S)=>{const G=E(new k(M,F,S));Y[x*3]=G.x,Y[x*3+1]=G.y,Y[x*3+2]=G.z},(x,M)=>{D.fromArray(Y,x*3),Q(D)&&y(M)&&(w[x]=A.pushSplat(),A.setCenter(w[x],D.x,D.y,D.z),A.setOpacity(w[x],M))},(x,M,F,S)=>{w[x]>=0&&A.setColor(w[x],M,F,S)},(x,M,F,S)=>{if(w[x]>=0){const G=u(new k(M,F,S));A.setScale(w[x],G.x,G.y,G.z)}},(x,M,F,S,G)=>{if(w[x]>=0){const T=l(new kA(M,F,S,G));A.setQuaternion(w[x],T.x,T.y,T.z,T.w)}},(x,M,F,S)=>{w[x]>=0&&(A.setSh1(w[x],M),F&&A.setSh2(w[x],F),S&&A.setSh3(w[x],S))});break}case st.SPLAT:Xe(B.fileBytes,m=>{},(m,w,Y,D,x,M,F,S,G,T,q,v,W,Z,P)=>{const H=E(new k(w,Y,D));if(Q(H)&&y(v)){const K=A.pushSplat();A.setCenter(K,H.x,H.y,H.z);const R=u(new k(x,M,F));A.setScale(K,R.x,R.y,R.z);const _=l(new kA(S,G,T,q));A.setQuaternion(K,_.x,_.y,_.z,_.w),A.setOpacity(K,v),A.setColor(K,W,Z,P)}});break;case st.KSPLAT:{let m=null;Ws(B.fileBytes,w=>{},(w,Y,D,x,M,F,S,G,T,q,v,W,Z,P,H)=>{const K=E(new k(Y,D,x));if(Q(K)&&y(W)){m=A.pushSplat(),A.setCenter(m,K.x,K.y,K.z);const R=u(new k(M,F,S));A.setScale(m,R.x,R.y,R.z);const _=l(new kA(G,T,q,v));A.setQuaternion(m,_.x,_.y,_.z,_.w),A.setOpacity(m,W),A.setColor(m,Z,P,H)}else m=null},(w,Y,D,x)=>{m!==null&&(A.setSh1(m,Y),D&&A.setSh2(m,D),x&&A.setSh3(m,x))});break}default:throw new Error(`transcodeSpz not implemented for ${z}`)}}const g=Math.min(i??3,A.sh3?3:A.sh2?2:A.sh1?1:0),o=new JA({numSplats:A.numSplats,shDegree:g,fractionalBits:n,flagAntiAlias:!0});for(let B=0;B<A.numSplats;++B){const E=B*3,u=B*4;o.setCenter(B,A.centers[E],A.centers[E+1],A.centers[E+2]),o.setScale(B,A.scales[E],A.scales[E+1],A.scales[E+2]),o.setQuat(B,A.quaternions[u],A.quaternions[u+1],A.quaternions[u+2],A.quaternions[u+3]),o.setAlpha(B,A.opacities[B]),o.setRgb(B,A.colors[E],A.colors[E+1],A.colors[E+2]),A.sh1&&g>=1&&o.setSh(B,A.sh1.slice(B*9,(B+1)*9),g>=2&&A.sh2?A.sh2.slice(B*15,(B+1)*15):void 0,g>=3&&A.sh3?A.sh3.slice(B*21,(B+1)*21):void 0)}return{fileBytes:await o.finalize(),clippedCount:o.clippedCount}}async function es(s){const{name:A,args:t,id:e}=s.data;let i,n;try{switch(A){case"unpackPly":{const{packedArray:r,fileBytes:g,splatEncoding:o}=t,a=await ci({packedArray:r,fileBytes:g,splatEncoding:o});i={id:e,numSplats:a.numSplats,packedArray:a.packedArray,extra:a.extra};break}case"decodeSpz":{const{fileBytes:r,splatEncoding:g}=t,o=await li(r,g);i={id:e,numSplats:o.numSplats,packedArray:o.packedArray,extra:o.extra};break}case"decodeAntiSplat":{const{fileBytes:r,splatEncoding:g}=t,o=Ps(r,g);i={id:e,numSplats:o.numSplats,packedArray:o.packedArray};break}case"decodeKsplat":{const{fileBytes:r,splatEncoding:g}=t,o=Os(r,g);i={id:e,numSplats:o.numSplats,packedArray:o.packedArray,extra:o.extra};break}case"decodePcSogs":{const{fileBytes:r,extraFiles:g,splatEncoding:o}=t,a=JSON.parse(new TextDecoder().decode(r)),I=await je(a,g,o);i={id:e,numSplats:I.numSplats,packedArray:I.packedArray,extra:I.extra};break}case"decodePcSogsZip":{const{fileBytes:r,splatEncoding:g}=t,o=await Ci(r,g);i={id:e,numSplats:o.numSplats,packedArray:o.packedArray,extra:o.extra};break}case"sortSplats":{const{totalSplats:r,readback:g,ordering:o}=t;i={id:e,readback:g,...ui({totalSplats:r,readback:g,ordering:o})};break}case"sortDoubleSplats":{const{numSplats:r,readback:g,ordering:o}=t;i={id:e,readback:g,ordering:o,activeSplats:rs(r,g,o)};break}case"sort32Splats":{const{numSplats:r,readback:g,ordering:o}=t;i={id:e,readback:g,ordering:o,activeSplats:gs(r,g,o)};break}case"transcodeSpz":{const r=t,g=await Qi(r);i={id:e,fileBytes:g,input:r};break}default:throw new Error(`Unknown name: ${A}`)}}catch(r){n=r,console.error(n)}self.postMessage({id:e,result:i,error:n},{transfer:Hs(i)})}async function ci({packedArray:s,fileBytes:A,splatEncoding:t}){const e=new pt({fileBytes:A});await e.parseHeader();const i=e.numSplats,n={};return e.parseSplats((r,g,o,a,I,C,h,B,E,u,l,Q,y,c,f)=>{qt(s,r,g,o,a,I,C,h,B,E,u,l,Q,y,c,f,t)},(r,g,o,a)=>{g&&(n.sh1||(n.sh1=new Uint32Array(i*2)),ft(n.sh1,r,g,t)),o&&(n.sh2||(n.sh2=new Uint32Array(i*4)),yt(n.sh2,r,o,t)),a&&(n.sh3||(n.sh3=new Uint32Array(i*4)),wt(n.sh3,r,a,t))}),{packedArray:s,numSplats:i,extra:n}}async function li(s,A){const t=new $e({fileBytes:s});await t.parseHeader();const e=t.numSplats,i=lt(e),n=new Uint32Array(i*4),r={};return await t.parseSplats((g,o,a,I)=>{Le(n,g,o,a,I)},(g,o)=>{vs(n,g,o)},(g,o,a,I)=>{Ts(n,g,o,a,I,A)},(g,o,a,I)=>{Te(n,g,o,a,I,A)},(g,o,a,I,C)=>{Ke(n,g,o,a,I,C)},(g,o,a,I)=>{o&&(r.sh1||(r.sh1=new Uint32Array(e*2)),ft(r.sh1,g,o,A)),a&&(r.sh2||(r.sh2=new Uint32Array(e*4)),yt(r.sh2,g,a,A)),I&&(r.sh3||(r.sh3=new Uint32Array(e*4)),wt(r.sh3,g,I,A))}),{packedArray:n,numSplats:e,extra:r}}const Wt=31744,Ft=Wt+1;let DA=null;function ui({totalSplats:s,readback:A,ordering:t}){DA||(DA=new Uint32Array(Ft)),DA.fill(0);const e=A.map(o=>new Uint32Array(o.buffer)),i=e[0].length,n=Math.ceil(s/i);let r=0;for(let o=0;o<n;++o){const a=e[o],I=Math.min(a.length,s-r);for(let C=0;C<I;++C){const h=a[C]&32767;h<Wt&&(DA[h]+=1)}r+=I}let g=0;for(let o=0;o<Ft;++o){const a=g+DA[o];DA[o]=g,g=a}r=0;for(let o=0;o<n;++o){const a=e[o],I=Math.min(a.length,s-r);for(let C=0;C<I;++C){const h=a[C]&32767;h<Wt&&(t[DA[h]]=r+C,DA[h]+=1)}r+=I}if(DA[Ft-1]!==g)throw new Error(`Expected ${g} active splats but got ${DA[Ft-1]}`);return{activeSplats:g,ordering:t}}const Ot=[];function ss(s){Ot.push(s)}async function fi(){self.addEventListener("message",ss),await ge(),self.removeEventListener("message",ss),self.addEventListener("message",es);for(const s of Ot)es(s);Ot.length=0}fi().catch(console.error)})();\n//# sourceMappingURL=worker-C1p-e5mc.js.map\n',ys=typeof self<"u"&&self.Blob&&new Blob([co],{type:"text/javascript;charset=utf-8"});function XI(t){let A;try{if(A=ys&&(self.URL||self.webkitURL).createObjectURL(ys),!A)throw"";const e=new Worker(A,{name:t==null?void 0:t.name});return e.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(A)}),e}catch{return new Worker("data:text/javascript;charset=utf-8,"+encodeURIComponent(co),{name:t==null?void 0:t.name})}finally{A&&(self.URL||self.webkitURL).revokeObjectURL(A)}}class ZI{constructor(){this.messages={},this.messageIdNext=0,this.worker=new XI,this.worker.onmessage=A=>this.onMessage(A)}makeMessageId(){return++this.messageIdNext}makeMessagePromiseId(){const A=this.makeMessageId(),e=new Promise((s,n)=>{this.messages[A]={resolve:s,reject:n}});return{id:A,promise:e}}onMessage(A){const{id:e,result:s,error:n}=A.data,i=this.messages[e];i&&(delete this.messages[e],n?i.reject(n):i.resolve(s))}async call(A,e){const{id:s,promise:n}=this.makeMessagePromiseId();return this.worker.postMessage({name:A,args:e,id:s},{transfer:Pn(e)}),n}}let go=4,fe=0;const lo=[],uo=[];async function jI(){const t=lo.shift();if(t)return t;if(fe<go){const A=new ZI;return fe+=1,A}return new Promise(A=>{uo.push(A)})}function WI(t){if(fe>go){fe-=1;return}const A=uo.shift();if(A){A(t);return}lo.push(t)}async function It(t){const A=await jI();try{return await t(A)}finally{WI(A)}}class Io extends sA.Loader{constructor(A){super(A),this.fileLoader=new sA.FileLoader(A)}load(A,e,s,n){const i=this.manager.resolveURL((this.path??"")+(A??"")),r=new Headers(this.requestHeader),a=this.withCredentials?"include":"same-origin",o=new Request(i,{headers:r,credentials:a});let g=this.fileType;this.manager.itemStart(i),ms(o,s).then(async l=>{var B;const c=[new ProgressEvent("progress",{lengthComputable:!0,loaded:l.byteLength,total:l.byteLength})];function u(){if(s){const Q=c.every(d=>d.lengthComputable||d.loaded===0&&d.total===0),f=c.reduce((d,y)=>d+y.loaded,0),p=c.reduce((d,y)=>d+y.total,0);s(new ProgressEvent("progress",{lengthComputable:Q,loaded:f,total:p}))}}const h={},E=[],C=Is(l);if(g==="pcsogs"&&C===void 0)throw new Error("Invalid PC SOGS file");if(C!==void 0){g="pcsogs";for(const Q of["means","scales","quats","sh0","shN"]){const f=C[Q];if(f)for(const p of f.files){const d=new URL(p,i).toString(),y=c.length;c.push(new ProgressEvent("progress")),this.manager.itemStart(d);const D=new Request(d,{headers:r,credentials:a}),x=ms(D,m=>{c[y]=m,u()}).then(m=>{h[p]=m}).catch(m=>{throw this.manager.itemError(d),m}).finally(()=>{this.manager.itemEnd(d)});E.push(x)}}}if(await Promise.all(E),e){const Q=((B=this.packedSplats)==null?void 0:B.splatEncoding)??De,f=await hs({input:l,extraFiles:h,fileType:g,pathOrUrl:i,splatEncoding:Q});this.packedSplats?(this.packedSplats.initialize(f),e(this.packedSplats)):e(new HA(f))}}).catch(l=>{this.manager.itemError(i),n==null||n(l)}).finally(()=>{this.manager.itemEnd(i)})}async loadAsync(A,e){return new Promise((s,n)=>{this.load(A,i=>{s(i)},e,n)})}parse(A){return new ct({packedSplats:A})}}async function ms(t,A){const e=await fetch(t);if(!e.ok)throw new Error(`${e.status} "${e.statusText}" fetching URL: ${t.url}`);if(!e.body)throw new Error(`Response body is null for URL: ${t.url}`);const s=e.body.getReader(),n=Number.parseInt(e.headers.get("Content-Length")||"0"),i=Number.isNaN(n)?0:n;let r=0;const a=[];for(;;){const{done:l,value:c}=await s.read();if(l)break;a.push(c),r+=c.length,A&&A(new ProgressEvent("progress",{lengthComputable:i!==0,loaded:r,total:i}))}const o=new Uint8Array(r);let g=0;for(const l of a)o.set(l,g),g+=l.length;return o.buffer}var Dt=(t=>(t.PLY="ply",t.SPZ="spz",t.SPLAT="splat",t.KSPLAT="ksplat",t.PCSOGS="pcsogs",t.PCSOGSZIP="pcsogszip",t))(Dt||{});function us(t){const A=new DataView(t.buffer);if((A.getUint32(0,!0)&16777215)===7957616)return"ply";if((A.getUint32(0,!0)&16777215)===559903){const e=oi(t,4);return new DataView(e.buffer).getUint32(0,!0)===1347635022?"spz":void 0}if(A.getUint32(0,!0)===67324752)return eh(t)?"pcsogszip":void 0}function Ah(t){const A=t.split(/[?#]/,1)[0],e=Math.max(A.lastIndexOf("/"),A.lastIndexOf("\\")),s=A.slice(e+1),n=s.lastIndexOf(".");return n<=0||n===s.length-1?"":s.slice(n+1).toLowerCase()}function ho(t){const A=Ah(t);if(A==="ply")return"ply";if(A==="spz")return"spz";if(A==="splat")return"splat";if(A==="ksplat")return"ksplat";if(A==="sog")return"pcsogszip"}function th(t){return Is(t)!==void 0}function Is(t){try{let A;if(typeof t=="string")A=t;else{const n=t instanceof ArrayBuffer?new Uint8Array(t):t;if(n.length>65536)return;A=new TextDecoder().decode(n)}const e=JSON.parse(A);if(!e||typeof e!="object"||Array.isArray(e))return;const s=e.version===2;for(const n of["means","scales","quats","sh0"]){if(!e[n]||typeof e[n]!="object"||Array.isArray(e[n]))return;if(s){if(!e[n].files||(n==="scales"||n==="sh0")&&!e[n].codebook||n==="means"&&(!e[n].mins||!e[n].maxs))return}else if(!e[n].shape||!e[n].files||n!=="quats"&&(!e[n].mins||!e[n].maxs))return}return e}catch{return}}function eh(t){try{const A=t instanceof ArrayBuffer?new Uint8Array(t):t;let e=null;const s=nc(A,{filter:({name:i})=>i.split(/[\\/]/).pop()==="meta.json"?(e=i,!0):!1});if(!e)return;const n=Is(s[e]);return n?{name:e,json:n}:void 0}catch{return}}async function hs({input:t,extraFiles:A,fileType:e,pathOrUrl:s,splatEncoding:n}){const i=t instanceof ArrayBuffer?new Uint8Array(t):t;let r=e;switch(e||(r=us(i),!r&&s&&(r=ho(s))),r){case"ply":{const a=new jt({fileBytes:i});await a.parseHeader();const o=a.numSplats,g=xA(o).maxSplats,l={fileBytes:i,packedArray:new Uint32Array(g*4),splatEncoding:n};return await It(async c=>{const{packedArray:u,numSplats:h,extra:E}=await c.call("unpackPly",l);return{packedArray:u,numSplats:h,extra:E}})}case"spz":return await It(async a=>{const{packedArray:o,numSplats:g,extra:l}=await a.call("decodeSpz",{fileBytes:i,splatEncoding:n});return{packedArray:o,numSplats:g,extra:l}});case"splat":return await It(async a=>{const{packedArray:o,numSplats:g}=await a.call("decodeAntiSplat",{fileBytes:i,splatEncoding:n});return{packedArray:o,numSplats:g}});case"ksplat":return await It(async a=>{const{packedArray:o,numSplats:g,extra:l}=await a.call("decodeKsplat",{fileBytes:i,splatEncoding:n});return{packedArray:o,numSplats:g,extra:l}});case"pcsogs":return await It(async a=>{const{packedArray:o,numSplats:g,extra:l}=await a.call("decodePcSogs",{fileBytes:i,extraFiles:A,splatEncoding:n});return{packedArray:o,numSplats:g,extra:l}});case"pcsogszip":return await It(async a=>{const{packedArray:o,numSplats:g,extra:l}=await a.call("decodePcSogsZip",{fileBytes:i,splatEncoding:n});return{packedArray:o,numSplats:g,extra:l}});default:throw new Error(`Unknown splat file type: ${r}`)}}class sh{constructor({maxSplats:A=1}={}){this.numSplats=0,this.maxSplats=xA(A).maxSplats,this.centers=new Float32Array(this.maxSplats*3),this.scales=new Float32Array(this.maxSplats*3),this.quaternions=new Float32Array(this.maxSplats*4),this.opacities=new Float32Array(this.maxSplats),this.colors=new Float32Array(this.maxSplats*3)}pushSplat(){const A=this.numSplats;return this.ensureIndex(A),this.numSplats+=1,A}unpushSplat(A){if(A===this.numSplats-1)this.numSplats-=1;else throw new Error("Cannot unpush splat from non-last position")}ensureCapacity(A){if(A>this.maxSplats){const e=Math.max(A,this.maxSplats*2),s=new Float32Array(e*3),n=new Float32Array(e*3),i=new Float32Array(e*4),r=new Float32Array(e),a=new Float32Array(e*3);if(s.set(this.centers),n.set(this.scales),i.set(this.quaternions),r.set(this.opacities),a.set(this.colors),this.centers=s,this.scales=n,this.quaternions=i,this.opacities=r,this.colors=a,this.sh1){const o=new Float32Array(e*9);o.set(this.sh1),this.sh1=o}if(this.sh2){const o=new Float32Array(e*15);o.set(this.sh2),this.sh2=o}if(this.sh3){const o=new Float32Array(e*21);o.set(this.sh3),this.sh3=o}this.maxSplats=e}}ensureIndex(A){this.ensureCapacity(A+1)}setCenter(A,e,s,n){this.centers[A*3]=e,this.centers[A*3+1]=s,this.centers[A*3+2]=n}setScale(A,e,s,n){this.scales[A*3]=e,this.scales[A*3+1]=s,this.scales[A*3+2]=n}setQuaternion(A,e,s,n,i){this.quaternions[A*4]=e,this.quaternions[A*4+1]=s,this.quaternions[A*4+2]=n,this.quaternions[A*4+3]=i}setOpacity(A,e){this.opacities[A]=e}setColor(A,e,s,n){this.colors[A*3]=e,this.colors[A*3+1]=s,this.colors[A*3+2]=n}setSh1(A,e){this.sh1||(this.sh1=new Float32Array(this.maxSplats*9));for(let s=0;s<9;++s)this.sh1[A*9+s]=e[s]}setSh2(A,e){this.sh2||(this.sh2=new Float32Array(this.maxSplats*15));for(let s=0;s<15;++s)this.sh2[A*15+s]=e[s]}setSh3(A,e){this.sh3||(this.sh3=new Float32Array(this.maxSplats*21));for(let s=0;s<21;++s)this.sh3[A*21+s]=e[s]}}const De={rgbMin:0,rgbMax:1,lnScaleMin:TA,lnScaleMax:kA,sh1Min:-1,sh1Max:1,sh2Min:-1,sh2Max:1,sh3Min:-1,sh3Max:1},iA=class iA{constructor(A={}){this.maxSplats=0,this.numSplats=0,this.packedArray=null,this.isInitialized=!1,this.target=null,this.source=null,this.needsUpdate=!0,this.extra={},this.dyno=new Cs({packedSplats:this}),this.dynoRgbMinMaxLnScaleMinMax=new Gt({key:"rgbMinMaxLnScaleMinMax",value:new I.Vector4(0,1,TA,kA),update:e=>{var s,n,i,r;return e.set(((s=this.splatEncoding)==null?void 0:s.rgbMin)??0,((n=this.splatEncoding)==null?void 0:n.rgbMax)??1,((i=this.splatEncoding)==null?void 0:i.lnScaleMin)??TA,((r=this.splatEncoding)==null?void 0:r.lnScaleMax)??kA),e}}),this.dynoSh1MinMax=new qt({key:"sh1MinMax",value:new I.Vector2(-1,1),update:e=>{var s,n;return e.set(((s=this.splatEncoding)==null?void 0:s.sh1Min)??-1,((n=this.splatEncoding)==null?void 0:n.sh1Max)??1),e}}),this.dynoSh2MinMax=new qt({key:"sh2MinMax",value:new I.Vector2(-1,1),update:e=>{var s,n;return e.set(((s=this.splatEncoding)==null?void 0:s.sh2Min)??-1,((n=this.splatEncoding)==null?void 0:n.sh2Max)??1),e}}),this.dynoSh3MinMax=new qt({key:"sh3MinMax",value:new I.Vector2(-1,1),update:e=>{var s,n;return e.set(((s=this.splatEncoding)==null?void 0:s.sh3Min)??-1,((n=this.splatEncoding)==null?void 0:n.sh3Max)??1),e}}),this.initialized=Promise.resolve(this),this.reinitialize(A)}reinitialize(A){this.isInitialized=!1,this.extra={},this.splatEncoding=A.splatEncoding,A.url||A.fileBytes||A.construct?this.initialized=this.asyncInitialize(A).then(()=>(this.isInitialized=!0,this)):(this.initialize(A),this.isInitialized=!0,this.initialized=Promise.resolve(this))}initialize(A){A.packedArray?(this.packedArray=A.packedArray,this.maxSplats=Math.floor(this.packedArray.length/4),this.maxSplats=Math.floor(this.maxSplats/O)*O,this.numSplats=Math.min(this.maxSplats,A.numSplats??Number.POSITIVE_INFINITY)):(this.maxSplats=A.maxSplats??0,this.numSplats=0),this.extra=A.extra??{}}async asyncInitialize(A){const{url:e,fileBytes:s,construct:n}=A;if(e){const i=new Io;i.packedSplats=this,await i.loadAsync(e)}else if(s){const i=await hs({input:s,fileType:A.fileType,pathOrUrl:A.fileName??e,splatEncoding:A.splatEncoding??De});this.initialize(i)}if(n){const i=n(this);i instanceof Promise&&await i}}dispose(){this.target&&(this.target.dispose(),this.target.texture.source.data=null,this.target=null),this.source&&(this.source.dispose(),this.source.source.data=null,this.source=null),this.packedArray=null;for(const A in this.extra){const e=this.extra[A];if(e instanceof N){const s=e.value;s!=null&&s.isTexture&&(s.dispose(),s.source.data=null)}}this.extra={}}ensureSplats(A){const e=A<=this.maxSplats?this.maxSplats:Math.max(A,2*this.maxSplats),s=this.packedArray?this.packedArray.length/4:0;if(!this.packedArray||e>s){this.maxSplats=xA(e).maxSplats;const n=new Uint32Array(this.maxSplats*4);this.packedArray&&n.set(this.packedArray),this.packedArray=n}return this.packedArray}ensureSplatsSh(A,e){let s,n;if(A===0)return this.ensureSplats(e);if(A===1)s=2,n="sh1";else if(A===2)s=4,n="sh2";else if(A===3)s=4,n="sh3";else throw new Error(`Invalid level: ${A}`);let i=this.extra[n]?this.extra[n].length/s:0;const r=e<=i?i:Math.max(e,2*i);if(!this.extra[n]||r>i){i=xA(r).maxSplats;const a=new Uint32Array(i*s);this.extra[n]&&a.set(this.extra[n]),this.extra[n]=a}return this.extra[n]}getSplat(A){if(!this.packedArray||A>=this.numSplats)throw new Error("Invalid index");return Ee(this.packedArray,A,this.splatEncoding)}setSplat(A,e,s,n,i,r){const a=this.ensureSplats(A+1);Be(a,A,e.x,e.y,e.z,s.x,s.y,s.z,n.x,n.y,n.z,n.w,i,r.r,r.g,r.b),this.numSplats=Math.max(this.numSplats,A+1)}pushSplat(A,e,s,n,i){const r=this.ensureSplats(this.numSplats+1);Be(r,this.numSplats,A.x,A.y,A.z,e.x,e.y,e.z,s.x,s.y,s.z,s.w,n,i.r,i.g,i.b),++this.numSplats}forEachSplat(A){if(!(!this.packedArray||!this.numSplats))for(let e=0;e<this.numSplats;++e){const s=Ee(this.packedArray,e,this.splatEncoding);A(e,s.center,s.scales,s.quaternion,s.opacity,s.color)}}ensureGenerate(A){if(this.target&&(A??1)<=this.maxSplats)return!1;this.target&&this.target.dispose();const e=xA(A??1),{width:s,height:n,depth:i}=e;return this.maxSplats=e.maxSplats,this.target=new I.WebGLArrayRenderTarget(s,n,i,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,magFilter:I.NearestFilter,minFilter:I.NearestFilter}),this.target.texture.format=I.RGBAIntegerFormat,this.target.texture.type=I.UnsignedIntType,this.target.texture.internalFormat="RGBA32UI",this.target.scissorTest=!0,!0}generateMapping(A){let e=0;const s=A.map(n=>{const i=e,r=Math.ceil(n/O)*O;return e+=r,{base:i,count:n}});return{maxSplats:e,mapping:s}}getTexture(){return this.target?this.target.texture:this.source||this.packedArray?this.maybeUpdateSource():iA.getEmpty()}maybeUpdateSource(){if(!this.packedArray)throw new Error("No packed splats");if(this.needsUpdate||!this.source){if(this.needsUpdate=!1,this.source){const{width:A,height:e,depth:s}=this.source.image;this.maxSplats!==A*e*s&&(this.source.dispose(),this.source=null)}if(this.source)this.packedArray.buffer!==this.source.image.data.buffer&&(this.source.image.data=new Uint8Array(this.packedArray.buffer));else{const{width:A,height:e,depth:s}=xA(this.maxSplats);this.source=new I.DataArrayTexture(this.packedArray,A,e,s),this.source.format=I.RGBAIntegerFormat,this.source.type=I.UnsignedIntType,this.source.internalFormat="RGBA32UI",this.source.needsUpdate=!0}this.source.needsUpdate=!0}return this.source}static getEmpty(){if(!iA.emptySource){const{width:A,height:e,depth:s,maxSplats:n}=xA(1),i=new Uint32Array(n*4);iA.emptySource=new I.DataArrayTexture(i,A,e,s),iA.emptySource.format=I.RGBAIntegerFormat,iA.emptySource.type=I.UnsignedIntType,iA.emptySource.internalFormat="RGBA32UI",iA.emptySource.needsUpdate=!0}return iA.emptySource}prepareProgramMaterial(A){let e=iA.generatorProgram.get(A);if(!e){const n=FA({index:"int"},{output:"uvec4"},({index:i})=>{A.inputs.index=i;const r=A.outputs.gsplat;return{output:nn(r,this.dynoRgbMinMaxLnScaleMinMax)}});iA.programTemplate||(iA.programTemplate=new rs(gs().computeUvec4Template)),e=new is({graph:n,inputs:{index:"index"},outputs:{output:"target"},template:iA.programTemplate}),Object.assign(e.uniforms,{targetLayer:{value:0},targetBase:{value:0},targetCount:{value:0}}),iA.generatorProgram.set(A,e)}const s=e.prepareMaterial();return iA.fullScreenQuad.material=s,{program:e,material:s}}saveRenderState(A){return{xrEnabled:A.xr.enabled,autoClear:A.autoClear}}resetRenderState(A,e){A.setRenderTarget(null),A.xr.enabled=e.xrEnabled,A.autoClear=e.autoClear}generate({generator:A,base:e,count:s,renderer:n}){if(!this.target)throw new Error("Target must be initialized with ensureSplats");if(e+s>this.maxSplats)throw new Error("Base + count exceeds maxSplats");const{program:i,material:r}=this.prepareProgramMaterial(A);i.update();const a=this.saveRenderState(n),o=Math.ceil((e+s)/O)*O,g=O*$A;for(r.uniforms.targetBase.value=e,r.uniforms.targetCount.value=s;e<o;){const l=Math.floor(e/g);r.uniforms.targetLayer.value=l;const c=l*g,u=Math.floor((e-c)/O),h=Math.min($A,Math.ceil((o-c)/O));this.target.scissor.set(0,u,O,h-u),n.setRenderTarget(this.target,l),n.xr.enabled=!1,n.autoClear=!1,iA.fullScreenQuad.render(n),e+=O*(h-u)}return this.resetRenderState(n,a),{nextBase:o}}};iA.emptySource=null,iA.programTemplate=null,iA.generatorProgram=new WeakMap,iA.fullScreenQuad=new Ds(new I.RawShaderMaterial({visible:!1}));let HA=iA;class Cs extends N{constructor({packedSplats:A}={}){super({key:"packedSplats",type:ie,globals:()=>[we],value:{texture:HA.getEmpty(),numSplats:0,rgbMinMaxLnScaleMinMax:new I.Vector4(0,1,TA,kA)},update:e=>{var s,n,i,r,a,o,g,l,c,u;return e.texture=((s=this.packedSplats)==null?void 0:s.getTexture())??HA.getEmpty(),e.numSplats=((n=this.packedSplats)==null?void 0:n.numSplats)??0,e.rgbMinMaxLnScaleMinMax.set(((r=(i=this.packedSplats)==null?void 0:i.splatEncoding)==null?void 0:r.rgbMin)??0,((o=(a=this.packedSplats)==null?void 0:a.splatEncoding)==null?void 0:o.rgbMax)??1,((l=(g=this.packedSplats)==null?void 0:g.splatEncoding)==null?void 0:l.lnScaleMin)??TA,((u=(c=this.packedSplats)==null?void 0:c.splatEncoding)==null?void 0:u.lnScaleMax)??kA),e}}),this.packedSplats=A}}class Xe extends I.InstancedBufferGeometry{constructor(A,e){super(),this.ordering=A,this.setAttribute("position",new I.BufferAttribute(nh,3)),this.setIndex(new I.BufferAttribute(ih,1)),this._maxInstanceCount=A.length,this.instanceCount=e,this.attribute=new I.InstancedBufferAttribute(A,1,!1,1),this.attribute.setUsage(I.DynamicDrawUsage),this.setAttribute("splatIndex",this.attribute)}update(A,e){this.ordering=A,this.attribute.array=A,this.instanceCount=e,this.attribute.addUpdateRange(0,e),this.attribute.needsUpdate=!0}}const nh=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),ih=new Uint16Array([0,1,2,0,2,3]),nt=class nt{constructor(A){if(this.lastTime=null,this.encodeLinear=!1,this.superXY=1,this.display=null,this.sorting=null,this.pending=null,this.sortingCheck=!1,this.readback16=new Uint16Array(0),this.readback32=new Uint32Array(0),this.spark=A.spark,this.camera=A.camera,this.viewToWorld=A.viewToWorld??new I.Matrix4,A.target){const{width:e,height:s,doubleBuffer:n}=A.target,i=Math.max(1,Math.min(4,A.target.superXY??1));if(this.superXY=i,e*i>8192||s*i>8192)throw new Error("Target size too large");this.target=new I.WebGLRenderTarget(e*i,s*i,{format:I.RGBAFormat,type:I.UnsignedByteType,colorSpace:I.SRGBColorSpace}),n&&(this.back=new I.WebGLRenderTarget(e*i,s*i,{format:I.RGBAFormat,type:I.UnsignedByteType,colorSpace:I.SRGBColorSpace})),this.encodeLinear=!0}this.onTextureUpdated=A.onTextureUpdated,this.sortRadial=A.sortRadial??!0,this.sortDistance=A.sortDistance,this.sortCoorient=A.sortCoorient,this.depthBias=A.depthBias,this.sort360=A.sort360,this.sort32=A.sort32,this.stochastic=A.stochastic??!1,this.orderingFreelist=new Vn({allocate:e=>new Uint32Array(e),valid:(e,s)=>e.length===s}),this.autoUpdate=!1,this.setAutoUpdate(A.autoUpdate??!1)}dispose(){var A;this.setAutoUpdate(!1),this.target&&(this.target.dispose(),this.target=void 0),this.back&&(this.back.dispose(),this.back=void 0),this.display&&(this.spark.releaseAccumulator(this.display.accumulator),this.display.geometry.dispose(),this.display=null),(A=this.pending)!=null&&A.accumulator&&(this.spark.releaseAccumulator(this.pending.accumulator),this.pending=null)}setAutoUpdate(A){!this.autoUpdate&&A?this.spark.autoViewpoints.push(this):this.autoUpdate&&!A&&(this.spark.autoViewpoints=this.spark.autoViewpoints.filter(e=>e!==this)),this.autoUpdate=A}async prepare({scene:A,camera:e,viewToWorld:s,update:n,forceOrigin:i}){for(s?this.viewToWorld=s:(this.camera=e??this.camera,this.camera&&(this.camera.updateMatrixWorld(),this.viewToWorld=this.camera.matrixWorld.clone()));n??!0;){const a=i?this.viewToWorld:this.spark.matrixWorld;if(this.spark.updateInternal({scene:A,originToWorld:a}))break;await new Promise(g=>setTimeout(g,10))}const r=this.spark.active;r.refCount+=1,await this.sortUpdate({accumulator:r,viewToWorld:this.viewToWorld}),this.spark.releaseAccumulator(r)}renderTarget({scene:A,camera:e}){var n;const s=this.back??this.target;if(!s)throw new Error("Must initialize SparkViewpoint with target");if(e=e??this.camera,!e)throw new Error("Must provide camera");if(e instanceof I.PerspectiveCamera){const i=new I.PerspectiveCamera().copy(e,!1);i.aspect=s.width/s.height,i.updateProjectionMatrix(),e=i}this.viewToWorld=e.matrixWorld.clone();try{this.spark.renderer.setRenderTarget(s),this.spark.prepareViewpoint(this),this.spark.renderer.render(A,e)}finally{this.spark.prepareViewpoint(this.spark.defaultView),this.spark.renderer.setRenderTarget(null)}s!==this.target&&([this.target,this.back]=[this.back,this.target]),(n=this.onTextureUpdated)==null||n.call(this,s.texture)}async readTarget(){if(!this.target)throw new Error("Must initialize SparkViewpoint with target");const{width:A,height:e}=this.target,s=A*e*4;(!this.superPixels||this.superPixels.length<s)&&(this.superPixels=new Uint8Array(s)),await this.spark.renderer.readRenderTargetPixelsAsync(this.target,0,0,A,e,this.superPixels);const{superXY:n}=this;if(n===1)return this.superPixels;const i=A/n,r=e/n,a=i*r*4;(!this.pixels||this.pixels.length<a)&&(this.pixels=new Uint8Array(a));const{superPixels:o,pixels:g}=this,l=n*n;for(let c=0;c<r;c++){const u=c*i;for(let h=0;h<i;h++){const E=h*n;let C=0,B=0,Q=0,f=0;for(let d=0;d<n;d++){const y=(c*n+d)*this.target.width;for(let D=0;D<n;D++){const x=(y+E+D)*4;C+=o[x],B+=o[x+1],Q+=o[x+2],f+=o[x+3]}}const p=(u+h)*4;g[p]=C/l,g[p+1]=B/l,g[p+2]=Q/l,g[p+3]=f/l}}return g}async prepareRenderPixels({scene:A,camera:e,viewToWorld:s,update:n,forceOrigin:i}){return await this.prepare({scene:A,camera:e,viewToWorld:s,update:n,forceOrigin:i}),this.renderTarget({scene:A,camera:e}),this.readTarget()}autoPoll({accumulator:A}){var i,r,a;this.camera&&(this.camera.updateMatrixWorld(),this.viewToWorld=this.camera.matrixWorld.clone());let e=!1,s=!1;if(!this.display)e=!0;else if(A){e=!0;const{mappingVersion:o}=this.display.accumulator;A.mappingVersion===o&&(A.refCount+=1,this.spark.releaseAccumulator(this.display.accumulator),this.display.accumulator=A,this.display.viewToWorld.copy(this.viewToWorld),s=!0,this.spark.viewpoint===this&&this.spark.prepareViewpoint(this))}const n=((i=this.sorting)==null?void 0:i.viewToWorld)??((r=this.display)==null?void 0:r.viewToWorld);n&&!Qe({matrix1:this.viewToWorld,matrix2:n,maxDistance:this.sortDistance??.01,minCoorient:this.sortCoorient??this.sortRadial?.99:.999})&&(e=!0),e&&(A&&(A.refCount+=1),(a=this.pending)!=null&&a.accumulator&&this.spark.releaseAccumulator(this.pending.accumulator),this.pending={accumulator:A,viewToWorld:this.viewToWorld,displayed:s},this.driveSort())}async driveSort(){var A;for(;;){if(this.sorting||!this.pending)return;const{viewToWorld:e,displayed:s}=this.pending;let n=this.pending.accumulator;if(n||(n=((A=this.display)==null?void 0:A.accumulator)??this.spark.active,n.refCount+=1),this.pending=null,!n)throw new Error("No accumulator to sort");this.sorting={viewToWorld:e},await this.sortUpdate({accumulator:n,viewToWorld:e,displayed:s}),this.sorting=null,this.spark.releaseAccumulator(n)}}async sortUpdate({accumulator:A,viewToWorld:e,displayed:s=!1}){if(this.sortingCheck)throw new Error("Only one sort at a time");this.sortingCheck=!0,A=A??this.spark.active;const{numSplats:n,maxSplats:i}=A.splats;let r=0,a=this.orderingFreelist.alloc(i);if(this.stochastic){r=n;for(let o=0;o<n;++o)a[o]=o}else if(n>0){const{reader:o,doubleSortReader:g,sort32Reader:l,dynoSortRadial:c,dynoOrigin:u,dynoDirection:h,dynoDepthBias:E,dynoSort360:C,dynoSplats:B}=nt.makeSorter(),Q=this.sort32??!1;let f;if(Q)this.readback32=o.ensureBuffer(i,this.readback32),f=this.readback32;else{const m=Math.ceil(i/2);this.readback16=o.ensureBuffer(m,this.readback16),f=this.readback16}const p=A.toWorld.clone().invert(),d=e.clone().premultiply(p);c.value=this.sort360?!0:this.sortRadial,u.value.set(0,0,0).applyMatrix4(d),h.value.set(0,0,-1).applyMatrix4(d).sub(u.value).normalize(),E.value=this.depthBias??1,C.value=this.sort360??!1,B.packedSplats=A.splats;const y=Q?l:g,D=Q?n:Math.ceil(n/2);await o.renderReadback({renderer:this.spark.renderer,reader:y,count:D,readback:f});const x=await It(async m=>{const w=Q?"sort32Splats":"sortDoubleSplats";return m.call(w,{maxSplats:i,numSplats:n,readback:f,ordering:a})});Q?this.readback32=x.readback:this.readback16=x.readback,a=x.ordering,r=x.activeSplats}this.updateDisplay({accumulator:A,viewToWorld:e,ordering:a,activeSplats:r,displayed:s}),this.sortingCheck=!1}updateDisplay({accumulator:A,viewToWorld:e,ordering:s,activeSplats:n,displayed:i=!1}){if(!this.display)A.refCount+=1,this.display={accumulator:A,viewToWorld:e,geometry:new Xe(s,n)};else{!i&&A!==this.display.accumulator&&(A.refCount+=1,this.spark.releaseAccumulator(this.display.accumulator),this.display.accumulator=A),this.display.viewToWorld=e;const r=this.display.geometry.ordering;r.length===s.length?this.display.geometry.update(s,n):(this.display.geometry.dispose(),this.display.geometry=new Xe(s,n)),this.orderingFreelist.free(r)}this.spark.viewpoint===this&&this.spark.prepareViewpoint(this)}static makeSorter(){if(!nt.dynos){const A=new Ce({value:!0}),e=new Nt({value:new I.Vector3}),s=new Nt({value:new I.Vector3}),n=new Et({value:1}),i=new Ce({value:!1}),r=new Cs,a=new Xt,o=FA({index:"int"},{rgba8:"vec4"},({index:l})=>{if(!l)throw new Error("No index");const c={sortRadial:A,sortOrigin:e,sortDirection:s,sortDepthBias:n,sort360:i},u=rA(l,J("int",2)),h=Ft(r,u),E=_e({gsplat:h,...c}),C=Ft(r,EA(u,J("int",1))),B=_e({gsplat:C,...c}),Q=PA({vectorType:"vec2",x:E,y:B});return{rgba8:$e(Ir(Q))}}),g=FA({index:"int"},{rgba8:"vec4"},({index:l})=>{if(!l)throw new Error("No index");const c={sortRadial:A,sortOrigin:e,sortDirection:s,sortDepthBias:n,sort360:i},u=Ft(r,l),h=_e({gsplat:u,...c});return{rgba8:$e(ur(h))}});nt.dynos={dynoSortRadial:A,dynoOrigin:e,dynoDirection:s,dynoDepthBias:n,dynoSort360:i,dynoSplats:r,reader:a,doubleSortReader:o,sort32Reader:g}}return nt.dynos}};nt.EMPTY_TEXTURE=new I.Texture,nt.dynos=null;let Wt=nt;const rh=CA(`
  float computeSort(Gsplat gsplat, bool sortRadial, vec3 sortOrigin, vec3 sortDirection, float sortDepthBias, bool sort360) {
    if (!isGsplatActive(gsplat.flags)) {
      return INFINITY;
    }

    vec3 center = gsplat.center - sortOrigin;
    float biasedDepth = dot(center, sortDirection) + sortDepthBias;
    if (!sort360 && (biasedDepth <= 0.0)) {
      return INFINITY;
    }

    return sortRadial ? length(center) : biasedDepth;
  }
`);function _e({gsplat:t,sortRadial:A,sortOrigin:e,sortDirection:s,sortDepthBias:n,sort360:i}){return ne({inTypes:{gsplat:AA,sortRadial:"bool",sortOrigin:"vec3",sortDirection:"vec3",sortDepthBias:"float",sort360:"bool"},outTypes:{metric:"float"},globals:()=>[NA,rh],inputs:{gsplat:t,sortRadial:A,sortOrigin:e,sortDirection:s,sortDepthBias:n,sort360:i},statements:({inputs:r,outputs:a})=>{const{gsplat:o,sortRadial:g,sortOrigin:l,sortDirection:c,sortDepthBias:u,sort360:h}=r;return YA(`
        ${a.metric} = computeSort(${o}, ${g}, ${l}, ${c}, ${u}, ${h});
      `)}}).outputs.metric}class Ie{constructor(){this.splats=new HA,this.toWorld=new I.Matrix4,this.mapping=[],this.refCount=0,this.splatsVersion=-1,this.mappingVersion=-1}ensureGenerate(A){this.splats.ensureGenerate(A)&&(this.mapping=[])}generateSplats({renderer:A,modifier:e,generators:s,forceUpdate:n,originToWorld:i}){const r=this.mapping.reduce((g,l)=>(g.set(l.node,l),g),new Map);let a=0,o=0;for(const{node:g,generator:l,version:c,base:u,count:h}of s){const E=r.get(g);if((n||l!==(E==null?void 0:E.generator)||c!==(E==null?void 0:E.version)||u!==(E==null?void 0:E.base)||h!==(E==null?void 0:E.count))&&l&&h>0){const C=e.apply(l);try{this.splats.generate({generator:C,base:u,count:h,renderer:A})}catch(B){g.generator=void 0,g.generatorError=B}a+=1}o=Math.max(o,u+h)}return this.splats.numSplats=o,this.toWorld.copy(i),this.mapping=s,a!==0}hasCorrespondence(A){return this.mapping.length!==A.mapping.length?!1:this.mapping.every(({node:e,base:s,count:n},i)=>{const{node:r,base:a,count:o}=A.mapping[i];return e===r&&s===a&&n===o})}}const ws=5,cA=class cA extends I.Mesh{constructor(A){const e=cA.makeUniforms(),s=gs(),n=A.premultipliedAlpha??!0,i=new I.ShaderMaterial({glslVersion:I.GLSL3,vertexShader:s.splatVertex,fragmentShader:s.splatFragment,uniforms:e,premultipliedAlpha:n,transparent:!0,depthTest:!0,depthWrite:!1,side:I.DoubleSide});super(xs,i),this.splatTexture=null,this.autoViewpoints=[],this.rotateToAccumulator=new Gt({value:new I.Quaternion}),this.translateToAccumulator=new Nt({value:new I.Vector3}),this.lastFrame=-1,this.lastUpdateTime=null,this.defaultCameras=[],this.lastStochastic=null,this.pendingUpdate={scene:null,originToWorld:new I.Matrix4,timeoutId:-1},this.envViewpoint=null,this.frustumCulled=!1,this.renderer=A.renderer,this.material=i,this.uniforms=e;const r=FA({gsplat:AA},{gsplat:AA},({gsplat:a})=>{if(!a)throw new Error("gsplat not defined");return a=ts(a,{rotate:this.rotateToAccumulator,translate:this.translateToAccumulator}),{gsplat:a}});this.modifier=new oo(r),this.premultipliedAlpha=n,this.autoUpdate=A.autoUpdate??!0,this.preUpdate=A.preUpdate??!1,this.needsUpdate=!1,this.originDistance=A.originDistance??1,this.maxStdDev=A.maxStdDev??Math.sqrt(8),this.minPixelRadius=A.minPixelRadius??0,this.maxPixelRadius=A.maxPixelRadius??512,this.minAlpha=A.minAlpha??.5*(1/255),this.enable2DGS=A.enable2DGS??!1,this.preBlurAmount=A.preBlurAmount??0,this.blurAmount=A.blurAmount??.3,this.focalDistance=A.focalDistance??0,this.apertureAngle=A.apertureAngle??0,this.falloff=A.falloff??1,this.clipXY=A.clipXY??1.4,this.focalAdjustment=A.focalAdjustment??1,this.splatEncoding=A.splatEncoding??{...De},this.active=new Ie,this.active.refCount=1,this.accumulatorCount=1,this.freeAccumulators=[];for(let a=0;a<1;++a)this.freeAccumulators.push(new Ie),this.accumulatorCount+=1;this.defaultView=new Wt({...A.view,autoUpdate:!0,spark:this}),this.viewpoint=this.defaultView,this.prepareViewpoint(this.viewpoint),this.clock=A.clock?ti(A.clock):new I.Clock}static makeUniforms(){return{renderSize:{value:new I.Vector2},near:{value:.1},far:{value:1e3},numSplats:{value:0},renderToViewQuat:{value:new I.Quaternion},renderToViewPos:{value:new I.Vector3},maxStdDev:{value:1},minPixelRadius:{value:0},maxPixelRadius:{value:512},minAlpha:{value:.00196078431372549},stochastic:{value:!1},enable2DGS:{value:!1},preBlurAmount:{value:0},blurAmount:{value:.3},focalDistance:{value:0},apertureAngle:{value:0},falloff:{value:1},clipXY:{value:1.4},focalAdjustment:{value:1},splatTexEnable:{value:!1},splatTexture:{type:"t",value:cA.EMPTY_SPLAT_TEXTURE},splatTexMul:{value:new I.Matrix2},splatTexAdd:{value:new I.Vector2},splatTexNear:{value:.1},splatTexFar:{value:1e3},splatTexMid:{value:0},packedSplats:{type:"t",value:HA.getEmpty()},rgbMinMaxLnScaleMinMax:{value:new I.Vector4},time:{value:0},deltaTime:{value:0},encodeLinear:{value:!1},debugFlag:{value:!1}}}canAllocAccumulator(){return this.freeAccumulators.length>0||this.accumulatorCount<ws}maybeAllocAccumulator(){let A=this.freeAccumulators.pop();if(A===void 0){if(this.accumulatorCount>=ws)return null;A=new Ie,this.accumulatorCount+=1}return A.refCount=1,A}releaseAccumulator(A){A.refCount-=1,A.refCount===0&&this.freeAccumulators.push(A)}newViewpoint(A){return new Wt({...A,spark:this})}onBeforeRender(A,e,s){var h,E;const n=this.time??this.clock.getElapsedTime(),i=n-(this.viewpoint.lastTime??n);this.viewpoint.lastTime=n;const r=A.info.render.frame,a=r!==this.lastFrame;this.lastFrame=r;const o=this.viewpoint;if(o===this.defaultView){if(a)if(!A.xr.isPresenting)this.defaultView.viewToWorld=s.matrixWorld.clone(),this.defaultCameras=[this.defaultView.viewToWorld];else{const C=A.xr.getCamera().cameras;this.defaultCameras=C.map(B=>B.matrixWorld),this.defaultView.viewToWorld=ah(this.defaultCameras)??new I.Matrix4}this.autoUpdate&&this.update({scene:e,viewToWorld:this.defaultView.viewToWorld})}if(a&&(this.material.premultipliedAlpha!==this.premultipliedAlpha&&(this.material.premultipliedAlpha=this.premultipliedAlpha,this.material.needsUpdate=!0),this.uniforms.time.value=n,this.uniforms.deltaTime.value=i,this.uniforms.debugFlag.value=performance.now()/1e3%2<1,o.display&&o.stochastic&&(this.geometry.instanceCount=this.uniforms.numSplats.value)),o.target)this.uniforms.renderSize.value.set(o.target.width,o.target.height);else{const C=A.getDrawingBufferSize(this.uniforms.renderSize.value);if(C.x===1&&C.y===1){const B=(h=A.xr.getSession())==null?void 0:h.renderState.baseLayer;B&&(C.x=B.framebufferWidth,C.y=B.framebufferHeight)}}const g=s;if(this.uniforms.near.value=g.near,this.uniforms.far.value=g.far,this.uniforms.encodeLinear.value=o.encodeLinear,this.uniforms.maxStdDev.value=this.maxStdDev,this.uniforms.minPixelRadius.value=this.minPixelRadius,this.uniforms.maxPixelRadius.value=this.maxPixelRadius,this.uniforms.minAlpha.value=this.minAlpha,this.uniforms.stochastic.value=o.stochastic,this.uniforms.enable2DGS.value=this.enable2DGS,this.uniforms.preBlurAmount.value=this.preBlurAmount,this.uniforms.blurAmount.value=this.blurAmount,this.uniforms.focalDistance.value=this.focalDistance,this.uniforms.apertureAngle.value=this.apertureAngle,this.uniforms.falloff.value=this.falloff,this.uniforms.clipXY.value=this.clipXY,this.uniforms.focalAdjustment.value=this.focalAdjustment,this.lastStochastic!==!o.stochastic&&(this.lastStochastic=!o.stochastic,this.material.transparent=!o.stochastic,this.material.depthWrite=o.stochastic,this.material.needsUpdate=!0),this.splatTexture){const{enable:C,texture:B,multiply:Q,add:f,near:p,far:d,mid:y}=this.splatTexture;C&&B?(this.uniforms.splatTexEnable.value=!0,this.uniforms.splatTexture.value=B,Q?this.uniforms.splatTexMul.value.fromArray(Q.elements):this.uniforms.splatTexMul.value.set(.5/this.maxStdDev,0,0,.5/this.maxStdDev),this.uniforms.splatTexAdd.value.set((f==null?void 0:f.x)??.5,(f==null?void 0:f.y)??.5),this.uniforms.splatTexNear.value=p??this.uniforms.near.value,this.uniforms.splatTexFar.value=d??this.uniforms.far.value,this.uniforms.splatTexMid.value=y??0):(this.uniforms.splatTexEnable.value=!1,this.uniforms.splatTexture.value=cA.EMPTY_SPLAT_TEXTURE)}else this.uniforms.splatTexEnable.value=!1,this.uniforms.splatTexture.value=cA.EMPTY_SPLAT_TEXTURE;const l=((E=o.display)==null?void 0:E.accumulator.toWorld)??new I.Matrix4,c=s.matrixWorld.clone().invert();l.clone().premultiply(c).decompose(this.uniforms.renderToViewPos.value,this.uniforms.renderToViewQuat.value,new I.Vector3)}prepareViewpoint(A){var e,s,n,i;if(this.viewpoint=A??this.viewpoint,this.viewpoint.display){const{accumulator:r,geometry:a}=this.viewpoint.display;this.uniforms.numSplats.value=r.splats.numSplats,this.uniforms.packedSplats.value=r.splats.getTexture(),this.uniforms.rgbMinMaxLnScaleMinMax.value.set(((e=r.splats.splatEncoding)==null?void 0:e.rgbMin)??0,((s=r.splats.splatEncoding)==null?void 0:s.rgbMax)??1,((n=r.splats.splatEncoding)==null?void 0:n.lnScaleMin)??TA,((i=r.splats.splatEncoding)==null?void 0:i.lnScaleMax)??kA),this.geometry=a,this.material.transparent=!this.viewpoint.stochastic,this.material.depthWrite=this.viewpoint.stochastic,this.material.needsUpdate=!0}else this.uniforms.numSplats.value=0,this.uniforms.packedSplats.value=HA.getEmpty(),this.geometry=xs}update({scene:A,viewToWorld:e}){const s=this.matrixWorld;this.preUpdate?this.updateInternal({scene:A,originToWorld:s.clone(),viewToWorld:e}):(this.pendingUpdate.scene=A,this.pendingUpdate.originToWorld.copy(s),this.pendingUpdate.timeoutId===-1&&(this.pendingUpdate.timeoutId=setTimeout(()=>{const{scene:n,originToWorld:i}=this.pendingUpdate;this.pendingUpdate.scene=null,this.pendingUpdate.timeoutId=-1,this.updateInternal({scene:n,originToWorld:i,viewToWorld:e})&&this.renderer.getContext().flush()},1)))}updateInternal({scene:A,originToWorld:e,viewToWorld:s}){var E;if(!this.canAllocAccumulator())return!1;e||(e=this.active.toWorld),s=s??e.clone();const n=this.time??this.clock.getElapsedTime(),i=n-(this.lastUpdateTime??n);this.lastUpdateTime=n;const r=this.active.mapping.reduce((C,B)=>(C.set(B.node,B),C),new Map),{generators:a,visibleGenerators:o,globalEdits:g}=this.compileScene(A);for(const C of a)(E=C.frameUpdate)==null||E.call(C,{object:C,time:n,deltaTime:i,viewToWorld:s,globalEdits:g});const l=new Set(o.map(C=>C.uuid));for(const C of a){const B=r.get(C),f=C.generator&&l.has(C.uuid)?C.numSplats:0;(this.needsUpdate||C.generator!==(B==null?void 0:B.generator)||f!==(B==null?void 0:B.count))&&C.updateVersion()}const c=!Qe({matrix1:e,matrix2:this.active.toWorld,maxDistance:this.originDistance}),u=this.needsUpdate||c||a.length!==r.size||a.some(C=>{var B;return C.version!==((B=r.get(C))==null?void 0:B.version)});this.needsUpdate=!1;let h=null;if(u){if(h=this.maybeAllocAccumulator(),!h)throw new Error("Unreachable");const C=!Qe({matrix1:e,matrix2:h.toWorld,maxDistance:1e-5,minCoorient:.99999}),Q=o.map((x,m)=>{const w=r.get(x);return w?[x.version-w.version,w.base,x]:[Number.POSITIVE_INFINITY,x.version,x]}).sort((x,m)=>x[0]!==m[0]?x[0]-m[0]:x[1]-m[1]).map(([x,m,w])=>w),f=Q.map(x=>x.numSplats),{maxSplats:p,mapping:d}=h.splats.generateMapping(f),y=Q.map((x,m)=>{const{base:w,count:T}=d[m];return{node:x,generator:x.generator,version:x.version,base:w,count:T}});e.clone().invert().decompose(this.translateToAccumulator.value,this.rotateToAccumulator.value,new I.Vector3),h.ensureGenerate(p),h.splats.splatEncoding={...this.splatEncoding},h.generateSplats({renderer:this.renderer,modifier:this.modifier,generators:y,forceUpdate:C,originToWorld:e}),h.splatsVersion=this.active.splatsVersion+1;const D=h.hasCorrespondence(this.active);h.mappingVersion=this.active.mappingVersion+(D?0:1),this.releaseAccumulator(this.active),this.active=h,this.prepareViewpoint()}return setTimeout(()=>{for(const C of this.autoViewpoints)C.autoPoll({accumulator:h??void 0})},1),!0}compileScene(A){const e=[];A.traverse(i=>{i instanceof Tt&&e.push(i)});const s=[];A.traverseVisible(i=>{i instanceof Tt&&s.push(i)});const n=new Set;return A.traverseVisible(i=>{if(i instanceof Zt){let r=i.parent;for(;r!=null&&!(r instanceof ct);)r=r.parent;r==null&&n.add(i)}}),{generators:e,visibleGenerators:s,globalEdits:Array.from(n)}}async renderEnvMap({renderer:A,scene:e,worldCenter:s,size:n=256,near:i=.1,far:r=1e3,hideObjects:a=[],update:o=!1}){var h,E;if(this.envViewpoint||(this.envViewpoint=this.newViewpoint({sort360:!0})),!cA.cubeRender||cA.cubeRender.target.width!==n||cA.cubeRender.near!==i||cA.cubeRender.far!==r){cA.cubeRender&&cA.cubeRender.target.dispose();const C=new I.WebGLCubeRenderTarget(n,{format:I.RGBAFormat,generateMipmaps:!0,minFilter:I.LinearMipMapLinearFilter}),B=new I.CubeCamera(i,r,C);cA.cubeRender={target:C,camera:B,near:i,far:r}}cA.pmrem||(cA.pmrem=new I.PMREMGenerator(A??this.renderer));const g=new I.Matrix4().setPosition(s);await((h=this.envViewpoint)==null?void 0:h.prepare({scene:e,viewToWorld:g,update:o}));const{target:l,camera:c}=cA.cubeRender;c.position.copy(s);const u=new Map;for(const C of a)u.set(C,C.visible),C.visible=!1;this.prepareViewpoint(this.envViewpoint),c.update(A??this.renderer,e),this.prepareViewpoint(this.defaultView);for(const[C,B]of u.entries())C.visible=B;return(E=cA.pmrem)==null?void 0:E.fromCubemap(l.texture).texture}recurseSetEnvMap(A,e){A.traverse(s=>{if(s instanceof I.Mesh)if(Array.isArray(s.material))for(const n of s.material)n instanceof I.MeshStandardMaterial&&(n.envMap=e);else s.material instanceof I.MeshStandardMaterial&&(s.material.envMap=e)})}getRgba({generator:A,rgba:e}){const s=this.active.mapping.find(({node:n})=>n===A);if(!s)throw new Error("Generator not found");return e=e??new pe,e.fromPackedSplats({packedSplats:this.active.splats,base:s.base,count:s.count,renderer:this.renderer}),e}async readRgba({generator:A,rgba:e}){return e=this.getRgba({generator:A,rgba:e}),e.read()}};cA.cubeRender=null,cA.pmrem=null,cA.EMPTY_SPLAT_TEXTURE=new I.Data3DTexture;let Ae=cA;const xs=new Xe(new Uint32Array(1),0);FA({packedSplats:ie,index:"int"},{gsplat:AA},({packedSplats:t,index:A})=>{if(!t||!A)throw new Error("Invalid input");return{gsplat:Ft(t,A)}});function ah(t){if(t.length===0)return null;const A=new I.Vector3,e=new I.Quaternion,s=new I.Vector3,n=[],i=[];for(const r of t)r.decompose(A,e,s),n.push(A),i.push(e);return new I.Matrix4().compose(si(n),ni(i),new I.Vector3(1,1,1))}function oh(t,A,e){const s=Math.floor(t.length/32);if(s*32!==t.length)throw new Error("Invalid .splat file size");const n=new Float32Array(t.buffer);for(let i=0;i<s;++i){const r=i*32,a=i*8,o=n[a+0],g=n[a+1],l=n[a+2],c=n[a+3],u=n[a+4],h=n[a+5],E=t[r+24]/255,C=t[r+25]/255,B=t[r+26]/255,Q=t[r+27]/255,f=(t[r+28]-128)/128,p=(t[r+29]-128)/128,d=(t[r+30]-128)/128,y=(t[r+31]-128)/128;e(i,o,g,l,c,u,h,p,d,y,f,Q,E,C,B)}}const Ss={0:{bytesPerCenter:12,bytesPerScale:12,bytesPerRotation:16,bytesPerColor:4,bytesPerSphericalHarmonicsComponent:4,scaleOffsetBytes:12,rotationOffsetBytes:24,colorOffsetBytes:40,sphericalHarmonicsOffsetBytes:44,scaleRange:1},1:{bytesPerCenter:6,bytesPerScale:6,bytesPerRotation:8,bytesPerColor:4,bytesPerSphericalHarmonicsComponent:2,scaleOffsetBytes:6,rotationOffsetBytes:12,colorOffsetBytes:20,sphericalHarmonicsOffsetBytes:24,scaleRange:32767},2:{bytesPerCenter:6,bytesPerScale:6,bytesPerRotation:8,bytesPerColor:4,bytesPerSphericalHarmonicsComponent:1,scaleOffsetBytes:6,rotationOffsetBytes:12,colorOffsetBytes:20,sphericalHarmonicsOffsetBytes:24,scaleRange:32767}},ch={0:0,1:9,2:24,3:45};function gh(t,A,e,s){var C;let r=0;const a=new DataView(t.buffer,r,4096);r+=4096;const o=a.getUint8(0),g=a.getUint8(1);if(o!==0||g<1)throw new Error(`Unsupported .ksplat version: ${o}.${g}`);const l=a.getUint32(4,!0);a.getUint32(16,!0);const c=a.getUint16(20,!0);if(c<0||c>2)throw new Error(`Invalid .ksplat compression level: ${c}`);const u=a.getFloat32(36,!0)||-1.5,h=a.getFloat32(40,!0)||1.5;let E=4096+l*1024;for(let B=0;B<l;++B){let Q=function(vA,z){if(c===0)return Y.getFloat32(vA+V+z*4,!0);if(c===1)return fA(Y.getUint16(vA+V+z*2,!0));const OA=Y.getUint8(vA+V+z)/255;return u+OA*(h-u)};const f=new DataView(t.buffer,r,1024);r+=1024;const p=f.getUint32(0,!0),d=f.getUint32(4,!0),y=f.getUint32(8,!0),D=f.getUint32(12,!0),x=f.getFloat32(16,!0),m=f.getUint16(20,!0),w=(f.getUint32(24,!0)||((C=Ss[c])==null?void 0:C.scaleRange))??1,T=f.getUint32(32,!0),M=T*y,S=f.getUint32(36,!0),U=S*4,F=m*D+U,b=f.getUint16(40,!0),k=ch[b],{bytesPerCenter:R,bytesPerScale:X,bytesPerRotation:_,bytesPerColor:eA,bytesPerSphericalHarmonicsComponent:q,scaleOffsetBytes:Z,rotationOffsetBytes:L,colorOffsetBytes:j,sphericalHarmonicsOffsetBytes:V}=Ss[c],W=R+X+_+eA+k*q,G=W*d,dA=G+F,lA=[0,3,6,1,4,7,2,5,8],yA=[9,14,19,10,15,20,11,16,21,12,17,22,13,18,23],mA=[24,31,38,25,32,39,26,33,40,27,34,41,28,35,42,29,36,43,30,37,44],SA=b>=1?new Float32Array(3*3):void 0,BA=b>=2?new Float32Array(5*3):void 0,JA=b>=3?new Float32Array(7*3):void 0,DA=x/2/w,jA=E+U,WA=E+F,Y=new DataView(t.buffer,WA,G),MA=new Float32Array(t.buffer,jA,D*3),uA=new Uint32Array(t.buffer,E,S);let Yt=T,ae=M;for(let vA=0;vA<p;++vA){const z=vA*W;let OA;if(vA<M)OA=Math.floor(vA/y);else{const At=uA[Yt-T];vA>=ae+At&&(Yt+=1,ae+=At),OA=Yt}const ve=c===0?Y.getFloat32(z+0,!0):(Y.getUint16(z+0,!0)-w)*DA+MA[3*OA+0],be=c===0?Y.getFloat32(z+4,!0):(Y.getUint16(z+2,!0)-w)*DA+MA[3*OA+1],Fe=c===0?Y.getFloat32(z+8,!0):(Y.getUint16(z+4,!0)-w)*DA+MA[3*OA+2],Ne=c===0?Y.getFloat32(z+Z+0,!0):fA(Y.getUint16(z+Z+0,!0)),Te=c===0?Y.getFloat32(z+Z+4,!0):fA(Y.getUint16(z+Z+2,!0)),Do=c===0?Y.getFloat32(z+Z+8,!0):fA(Y.getUint16(z+Z+4,!0)),Mo=c===0?Y.getFloat32(z+L+0,!0):fA(Y.getUint16(z+L+0,!0)),vo=c===0?Y.getFloat32(z+L+4,!0):fA(Y.getUint16(z+L+2,!0)),bo=c===0?Y.getFloat32(z+L+8,!0):fA(Y.getUint16(z+L+4,!0)),Fo=c===0?Y.getFloat32(z+L+12,!0):fA(Y.getUint16(z+L+6,!0)),No=Y.getUint8(z+j+0)/255,To=Y.getUint8(z+j+1)/255,ko=Y.getUint8(z+j+2)/255,Uo=Y.getUint8(z+j+3)/255;if(e(vA,ve,be,Fe,Ne,Te,Do,vo,bo,Fo,Mo,Uo,No,To,ko),b>=1&&SA){for(const[At,Jt]of lA.entries())SA[At]=Q(z,Jt);if(BA)for(const[At,Jt]of yA.entries())BA[At]=Q(z,Jt);if(JA)for(const[At,Jt]of mA.entries())JA[At]=Q(z,Jt);s==null||s(vA,SA,BA,JA)}}E+=dA}}class Co{constructor({fileBytes:A}){this.version=-1,this.numSplats=0,this.shDegree=0,this.fractionalBits=0,this.flags=0,this.flagAntiAlias=!1,this.reserved=0,this.headerParsed=!1,this.parsed=!1,this.fileBytes=A instanceof ArrayBuffer?new Uint8Array(A):A,this.reader=new ci({fileBytes:this.fileBytes})}async parseHeader(){if(this.headerParsed)throw new Error("SPZ file header already parsed");const A=new DataView((await this.reader.read(16)).buffer);if(A.getUint32(0,!0)!==1347635022)throw new Error("Invalid SPZ file");if(this.version=A.getUint32(4,!0),this.version<1||this.version>3)throw new Error(`Unsupported SPZ version: ${this.version}`);this.numSplats=A.getUint32(8,!0),this.shDegree=A.getUint8(12),this.fractionalBits=A.getUint8(13),this.flags=A.getUint8(14),this.flagAntiAlias=(this.flags&1)!==0,this.reserved=A.getUint8(15),this.headerParsed=!0,this.parsed=!1}async parseSplats(A,e,s,n,i,r){if(!this.headerParsed)throw new Error("SPZ file header must be parsed first");if(this.parsed)throw new Error("SPZ file already parsed");if(this.parsed=!0,this.version===1){const a=await this.reader.read(this.numSplats*3*2),o=new Uint16Array(a.buffer);for(let g=0;g<this.numSplats;g++){const l=g*3,c=fA(o[l]),u=fA(o[l+1]),h=fA(o[l+2]);A==null||A(g,c,u,h)}}else if(this.version===2||this.version===3){const a=1<<this.fractionalBits,o=await this.reader.read(this.numSplats*3*3);for(let g=0;g<this.numSplats;g++){const l=g*9,c=((o[l+2]<<24|o[l+1]<<16|o[l]<<8)>>8)/a,u=((o[l+5]<<24|o[l+4]<<16|o[l+3]<<8)>>8)/a,h=((o[l+8]<<24|o[l+7]<<16|o[l+6]<<8)>>8)/a;A==null||A(g,c,u,h)}}else throw new Error("Unreachable");{const a=await this.reader.read(this.numSplats);for(let o=0;o<this.numSplats;o++)e==null||e(o,a[o]/255)}{const a=await this.reader.read(this.numSplats*3),o=Eo/.15;for(let g=0;g<this.numSplats;g++){const l=g*3,c=(a[l]/255-.5)*o+.5,u=(a[l+1]/255-.5)*o+.5,h=(a[l+2]/255-.5)*o+.5;s==null||s(g,c,u,h)}}{const a=await this.reader.read(this.numSplats*3);for(let o=0;o<this.numSplats;o++){const g=o*3,l=Math.exp(a[g]/16-10),c=Math.exp(a[g+1]/16-10),u=Math.exp(a[g+2]/16-10);n==null||n(o,l,c,u)}}if(this.version===3){const a=1/Math.sqrt(2),o=await this.reader.read(this.numSplats*4);for(let g=0;g<this.numSplats;g++){const l=g*4,c=[0,0,0,0],u=[o[l],o[l+1],o[l+2],o[l+3]],h=u[0]+(u[1]<<8)+(u[2]<<16)+(u[3]<<24),E=511,C=h>>>30;let B=h,Q=0;for(let p=3;p>=0;--p)if(p!==C){const d=B&E,y=B>>>9&1;B=B>>>10,c[p]=a*(d/E),c[p]=y===0?c[p]:-c[p],Q+=c[p]*c[p]}const f=1-Q;c[C]=Math.sqrt(Math.max(f,0)),i==null||i(g,c[0],c[1],c[2],c[3])}}else{const a=await this.reader.read(this.numSplats*3);for(let o=0;o<this.numSplats;o++){const g=o*3,l=a[g]/127.5-1,c=a[g+1]/127.5-1,u=a[g+2]/127.5-1,h=Math.sqrt(Math.max(0,1-l*l-c*c-u*u));i==null||i(o,l,c,u,h)}}if(r&&this.shDegree>=1){const a=new Float32Array(9),o=this.shDegree>=2?new Float32Array(5*3):void 0,g=this.shDegree>=3?new Float32Array(7*3):void 0,l=await this.reader.read(this.numSplats*Bo[this.shDegree]*3);let c=0;for(let u=0;u<this.numSplats;u++){for(let h=0;h<9;++h)a[h]=(l[c+h]-128)/128;if(c+=9,o){for(let h=0;h<15;++h)o[h]=(l[c+h]-128)/128;c+=15}if(g){for(let h=0;h<21;++h)g[h]=(l[c+h]-128)/128;c+=21}r==null||r(u,a,o,g)}}}}const Bo={1:3,2:8,3:15},Eo=.28209479177387814,lh=1347635022,uh=3,Ih=1;class XA{constructor({numSplats:A,shDegree:e,fractionalBits:s=12,flagAntiAlias:n=!0}){this.clippedCount=0;const i=20+(e>=1?9:0)+(e>=2?15:0)+(e>=3?21:0),r=16+A*i;this.buffer=new ArrayBuffer(r),this.view=new DataView(this.buffer),this.view.setUint32(0,lh,!0),this.view.setUint32(4,uh,!0),this.view.setUint32(8,A,!0),this.view.setUint8(12,e),this.view.setUint8(13,s),this.view.setUint8(14,n?Ih:0),this.view.setUint8(15,0),this.numSplats=A,this.shDegree=e,this.fractionalBits=s,this.fraction=1<<s,this.flagAntiAlias=n}setCenter(A,e,s,n){const i=Math.round(e*this.fraction),r=Math.max(-8388607,Math.min(8388607,i)),a=Math.round(s*this.fraction),o=Math.max(-8388607,Math.min(8388607,a)),g=Math.round(n*this.fraction),l=Math.max(-8388607,Math.min(8388607,g));(i!==r||a!==o||g!==l)&&(this.clippedCount+=1);const h=16+A*9;this.view.setUint8(h,r&255),this.view.setUint8(h+1,r>>8&255),this.view.setUint8(h+2,r>>16&255),this.view.setUint8(h+3,o&255),this.view.setUint8(h+4,o>>8&255),this.view.setUint8(h+5,o>>16&255),this.view.setUint8(h+6,l&255),this.view.setUint8(h+7,l>>8&255),this.view.setUint8(h+8,l>>16&255)}setAlpha(A,e){const s=16+this.numSplats*9+A;this.view.setUint8(s,Math.max(0,Math.min(255,Math.round(e*255))))}static scaleRgb(A){const e=((A-.5)/(Eo/.15)+.5)*255;return Math.max(0,Math.min(255,Math.round(e)))}setRgb(A,e,s,n){const i=16+this.numSplats*10+A*3;this.view.setUint8(i,XA.scaleRgb(e)),this.view.setUint8(i+1,XA.scaleRgb(s)),this.view.setUint8(i+2,XA.scaleRgb(n))}setScale(A,e,s,n){const i=16+this.numSplats*13+A*3;this.view.setUint8(i,Math.max(0,Math.min(255,Math.round((Math.log(e)+10)*16)))),this.view.setUint8(i+1,Math.max(0,Math.min(255,Math.round((Math.log(s)+10)*16)))),this.view.setUint8(i+2,Math.max(0,Math.min(255,Math.round((Math.log(n)+10)*16))))}setQuat(A,...e){const s=16+this.numSplats*16+A*4,n=qn(e);let i=0;for(let o=1;o<4;++o)Math.abs(n[o])>Math.abs(n[i])&&(i=o);const r=n[i]<0?1:0;let a=i;for(let o=0;o<4;++o)if(o!==i){const g=(n[o]<0?1:0)^r,l=Math.floor(511*(Math.abs(n[o])/Math.SQRT1_2)+.5);a=a<<10|g<<9|l}this.view.setUint8(s,a&255),this.view.setUint8(s+1,a>>8&255),this.view.setUint8(s+2,a>>16&255),this.view.setUint8(s+3,a>>>24&255)}static quantizeSh(A,e){const s=Math.round(A*128)+128,n=1<<8-e,i=Math.floor((s+n/2)/n)*n;return Math.max(0,Math.min(255,i))}setSh(A,e,s,n){const i=Bo[this.shDegree]||0,r=16+this.numSplats*20+A*i*3;for(let a=0;a<9;++a)this.view.setUint8(r+a,XA.quantizeSh(e[a],5));if(s){const a=r+9;for(let o=0;o<15;++o)this.view.setUint8(a+o,XA.quantizeSh(s[o],4));if(n){const o=a+15;for(let g=0;g<21;++g)this.view.setUint8(o+g,XA.quantizeSh(n[g],4))}}}async finalize(){const A=new Uint8Array(this.buffer),s=new ReadableStream({async start(r){r.enqueue(A),r.close()}}).pipeThrough(new CompressionStream("gzip")),i=await new Response(s).arrayBuffer();return console.log("Compressed",A.length,"bytes to",i.byteLength,"bytes"),new Uint8Array(i)}}async function hh(t){var l,c,u;const A=new sh,{inputs:e,clipXyz:s,maxSh:n,fractionalBits:i=12,opacityThreshold:r}=t;for(const h of e){let E=function(m){return m.multiplyScalar(p),m.applyQuaternion(d),m.add(y),m},C=function(m){return m.multiplyScalar(p),m},B=function(m){return m.premultiply(d),m},Q=function(m){return!D||D.containsPoint(m)},f=function(m){return r!==void 0?m>=r:!0};const p=((l=h.transform)==null?void 0:l.scale)??1,d=new I.Quaternion().fromArray(((c=h.transform)==null?void 0:c.quaternion)??[0,0,0,1]),y=new I.Vector3().fromArray(((u=h.transform)==null?void 0:u.translate)??[0,0,0]),D=s?new I.Box3(new I.Vector3().fromArray(s.min),new I.Vector3().fromArray(s.max)):void 0;let x=h.fileType;switch(x||(x=us(h.fileBytes),!x&&h.pathOrUrl&&(x=ho(h.pathOrUrl))),x){case Dt.PLY:{const m=new jt({fileBytes:h.fileBytes});await m.parseHeader();let w=null;m.parseSplats((T,M,S,U,F,b,k,R,X,_,eA,q,Z,L,j)=>{const V=E(new I.Vector3(M,S,U));if(Q(V)&&f(q)){w=A.pushSplat(),A.setCenter(w,V.x,V.y,V.z);const W=C(new I.Vector3(F,b,k));A.setScale(w,W.x,W.y,W.z);const G=B(new I.Quaternion(R,X,_,eA));A.setQuaternion(w,G.x,G.y,G.z,G.w),A.setOpacity(w,q),A.setColor(w,Z,L,j)}else w=null},(T,M,S,U)=>{M&&w!==null&&A.setSh1(w,M),S&&w!==null&&A.setSh2(w,S),U&&w!==null&&A.setSh3(w,U)});break}case Dt.SPZ:{const m=new Co({fileBytes:h.fileBytes});await m.parseHeader();const w=new Int32Array(m.numSplats);w.fill(-1);const T=new Float32Array(m.numSplats*3),M=new I.Vector3;m.parseSplats((S,U,F,b)=>{const k=E(new I.Vector3(U,F,b));T[S*3]=k.x,T[S*3+1]=k.y,T[S*3+2]=k.z},(S,U)=>{M.fromArray(T,S*3),Q(M)&&f(U)&&(w[S]=A.pushSplat(),A.setCenter(w[S],M.x,M.y,M.z),A.setOpacity(w[S],U))},(S,U,F,b)=>{w[S]>=0&&A.setColor(w[S],U,F,b)},(S,U,F,b)=>{if(w[S]>=0){const k=C(new I.Vector3(U,F,b));A.setScale(w[S],k.x,k.y,k.z)}},(S,U,F,b,k)=>{if(w[S]>=0){const R=B(new I.Quaternion(U,F,b,k));A.setQuaternion(w[S],R.x,R.y,R.z,R.w)}},(S,U,F,b)=>{w[S]>=0&&(A.setSh1(w[S],U),F&&A.setSh2(w[S],F),b&&A.setSh3(w[S],b))});break}case Dt.SPLAT:oh(h.fileBytes,m=>{},(m,w,T,M,S,U,F,b,k,R,X,_,eA,q,Z)=>{const L=E(new I.Vector3(w,T,M));if(Q(L)&&f(_)){const j=A.pushSplat();A.setCenter(j,L.x,L.y,L.z);const V=C(new I.Vector3(S,U,F));A.setScale(j,V.x,V.y,V.z);const W=B(new I.Quaternion(b,k,R,X));A.setQuaternion(j,W.x,W.y,W.z,W.w),A.setOpacity(j,_),A.setColor(j,eA,q,Z)}});break;case Dt.KSPLAT:{let m=null;gh(h.fileBytes,w=>{},(w,T,M,S,U,F,b,k,R,X,_,eA,q,Z,L)=>{const j=E(new I.Vector3(T,M,S));if(Q(j)&&f(eA)){m=A.pushSplat(),A.setCenter(m,j.x,j.y,j.z);const V=C(new I.Vector3(U,F,b));A.setScale(m,V.x,V.y,V.z);const W=B(new I.Quaternion(k,R,X,_));A.setQuaternion(m,W.x,W.y,W.z,W.w),A.setOpacity(m,eA),A.setColor(m,q,Z,L)}else m=null},(w,T,M,S)=>{m!==null&&(A.setSh1(m,T),M&&A.setSh2(m,M),S&&A.setSh3(m,S))});break}default:throw new Error(`transcodeSpz not implemented for ${x}`)}}const a=Math.min(n??3,A.sh3?3:A.sh2?2:A.sh1?1:0),o=new XA({numSplats:A.numSplats,shDegree:a,fractionalBits:i,flagAntiAlias:!0});for(let h=0;h<A.numSplats;++h){const E=h*3,C=h*4;o.setCenter(h,A.centers[E],A.centers[E+1],A.centers[E+2]),o.setScale(h,A.scales[E],A.scales[E+1],A.scales[E+2]),o.setQuat(h,A.quaternions[C],A.quaternions[C+1],A.quaternions[C+2],A.quaternions[C+3]),o.setAlpha(h,A.opacities[h]),o.setRgb(h,A.colors[E],A.colors[E+1],A.colors[E+2]),A.sh1&&a>=1&&o.setSh(h,A.sh1.slice(h*9,(h+1)*9),a>=2&&A.sh2?A.sh2.slice(h*15,(h+1)*15):void 0,a>=3&&A.sh3?A.sh3.slice(h*21,(h+1)*21):void 0)}return{fileBytes:await o.finalize(),clippedCount:o.clippedCount}}class Ch{constructor(A){this.mesh=A.mesh,this.numSplats=A.numSplats??this.mesh.numSplats;const{width:e,height:s,depth:n,maxSplats:i}=xA(this.numSplats);this.skinData=new Uint16Array(i*4),this.skinTexture=new I.DataArrayTexture(this.skinData,e,s,n),this.skinTexture.format=I.RGBAIntegerFormat,this.skinTexture.type=I.UnsignedShortType,this.skinTexture.internalFormat="RGBA16UI",this.skinTexture.needsUpdate=!0,this.numBones=A.numBones??256,this.boneData=new Float32Array(this.numBones*16),this.boneTexture=new I.DataTexture(this.boneData,4,this.numBones,I.RGBAFormat,I.FloatType),this.boneTexture.internalFormat="RGBA32F",this.boneTexture.needsUpdate=!0,this.uniform=new N({key:"skinning",type:Qo,globals:()=>[po],value:{numSplats:this.numSplats,numBones:this.numBones,skinTexture:this.skinTexture,boneTexture:this.boneTexture}})}modify(A){return Eh(A,this.uniform)}setRestQuatPos(A,e,s){const n=A*16;this.boneData[n+0]=e.x,this.boneData[n+1]=e.y,this.boneData[n+2]=e.z,this.boneData[n+3]=e.w,this.boneData[n+4]=s.x,this.boneData[n+5]=s.y,this.boneData[n+6]=s.z,this.boneData[n+7]=0,this.boneData[n+8]=0,this.boneData[n+9]=0,this.boneData[n+10]=0,this.boneData[n+11]=1,this.boneData[n+12]=0,this.boneData[n+13]=0,this.boneData[n+14]=0,this.boneData[n+15]=0}setBoneQuatPos(A,e,s){const n=A*16,i=new I.Quaternion(this.boneData[n+0],this.boneData[n+1],this.boneData[n+2],this.boneData[n+3]),r=new I.Vector3(this.boneData[n+4],this.boneData[n+5],this.boneData[n+6]),a=i.clone().invert(),o=s.clone().sub(r);o.applyQuaternion(a),a.multiply(e);const g=new I.Quaternion(o.x,o.y,o.z,0).multiply(i);this.boneData[n+8]=a.x,this.boneData[n+9]=a.y,this.boneData[n+10]=a.z,this.boneData[n+11]=a.w,this.boneData[n+12]=.5*g.x,this.boneData[n+13]=.5*g.y,this.boneData[n+14]=.5*g.z,this.boneData[n+15]=.5*g.w}setSplatBones(A,e,s){const n=A*4;this.skinData[n+0]=Math.min(255,Math.max(0,Math.round(s.x*255)))+(e.x<<8),this.skinData[n+1]=Math.min(255,Math.max(0,Math.round(s.y*255)))+(e.y<<8),this.skinData[n+2]=Math.min(255,Math.max(0,Math.round(s.z*255)))+(e.z<<8),this.skinData[n+3]=Math.min(255,Math.max(0,Math.round(s.w*255)))+(e.w<<8)}updateBones(){this.boneTexture.needsUpdate=!0,this.mesh.needsUpdate=!0}}const Qo={type:"GsplatSkinning"},po=CA(`
  struct GsplatSkinning {
    int numSplats;
    int numBones;
    usampler2DArray skinTexture;
    sampler2D boneTexture;
  };
`),Bh=CA(`
  void applyGsplatSkinning(
    int numSplats, int numBones,
    usampler2DArray skinTexture, sampler2D boneTexture,
    int splatIndex, inout vec3 center, inout vec4 quaternion
  ) {
    if ((splatIndex < 0) || (splatIndex >= numSplats)) {
      return;
    }

    uvec4 skinData = texelFetch(skinTexture, splatTexCoord(splatIndex), 0);

    float weights[4];
    weights[0] = float(skinData.x & 0xffu) / 255.0;
    weights[1] = float(skinData.y & 0xffu) / 255.0;
    weights[2] = float(skinData.z & 0xffu) / 255.0;
    weights[3] = float(skinData.w & 0xffu) / 255.0;

    uint boneIndices[4];
    boneIndices[0] = (skinData.x >> 8u) & 0xffu;
    boneIndices[1] = (skinData.y >> 8u) & 0xffu;
    boneIndices[2] = (skinData.z >> 8u) & 0xffu;
    boneIndices[3] = (skinData.w >> 8u) & 0xffu;

    vec4 quat = vec4(0.0);
    vec4 dual = vec4(0.0);
    for (int i = 0; i < 4; i++) {
      if (weights[i] > 0.0) {
        int boneIndex = int(boneIndices[i]);
        vec4 boneQuat = vec4(0.0, 0.0, 0.0, 1.0);
        vec4 boneDual = vec4(0.0);
        if (boneIndex < numBones) {
          boneQuat = texelFetch(boneTexture, ivec2(2, boneIndex), 0);
          boneDual = texelFetch(boneTexture, ivec2(3, boneIndex), 0);
        }

        if ((i > 0) && (dot(quat, boneQuat) < 0.0)) {
          // Flip sign if next blend is pointing in the opposite direction
          boneQuat = -boneQuat;
          boneDual = -boneDual;
        }
        quat += weights[i] * boneQuat;
        dual += weights[i] * boneDual;
      }
    }

    // Normalize dual quaternion
    float norm = length(quat);
    quat /= norm;
    dual /= norm;
    vec3 translate = vec3(
      2.0 * (-dual.w * quat.x + dual.x * quat.w - dual.y * quat.z + dual.z * quat.y),
      2.0 * (-dual.w * quat.y + dual.x * quat.z + dual.y * quat.w - dual.z * quat.x),
      2.0 * (-dual.w * quat.z - dual.x * quat.y + dual.y * quat.x + dual.z * quat.w)
    );

    center = quatVec(quat, center) + translate;
    quaternion = quatQuat(quat, quaternion);
  }
`);function Eh(t,A){return new P({inTypes:{gsplat:AA,skinning:Qo},outTypes:{gsplat:AA},globals:()=>[po,Bh],inputs:{gsplat:t,skinning:A},statements:({inputs:s,outputs:n})=>{const{skinning:i}=s,{gsplat:r}=n;return YA(`
        ${r} = ${s.gsplat};
        if (isGsplatActive(${r}.flags)) {
          applyGsplatSkinning(
            ${i}.numSplats, ${i}.numBones,
            ${i}.skinTexture, ${i}.boneTexture,
            ${r}.index, ${r}.center, ${r}.quaternion
          );
        }
      `)}}).outputs.gsplat}function Qh({splats:t,extents:A,stepSize:e=1,pointRadius:s=.01,pointShadowScale:n=2,opacity:i=1,color:r}){const o=new I.Vector3,g=new I.Vector3,l=new I.Quaternion(0,0,0,1);r==null&&(r=(u,h)=>u.set(.55+.45*Math.cos(h.x*1),.55+.45*Math.cos(h.y*1),.55+.45*Math.cos(h.z*1)));const c=new I.Color;for(let u=A.min.z;u<A.max.z+1e-6;u+=e)for(let h=A.min.y;h<A.max.y+1e-6;h+=e)for(let E=A.min.x;E<A.max.x+1e-6;E+=e){o.set(E,h,u);for(let C=0;C<2;++C)g.setScalar(s*(C?1:n)),C?typeof r=="function"?r(c,o):c.copy(r):c.setScalar(0),t.pushSplat(o,g,l,i,c)}}function ph({splats:t,scale:A=.25,axisRadius:e=.0075,axisShadowScale:s=2,origins:n=[new I.Vector3]}){const i=new I.Vector3,r=new I.Vector3,a=new I.Quaternion(0,0,0,1),o=new I.Color,g=1;for(const l of n)for(let c=0;c<3;++c){i.set(l.x+(c===0?A:0),l.y+(c===1?A:0),l.z+(c===2?A:0));for(let u=0;u<2;++u)r.set((c===0?A:e)*(u?1:s),(c===1?A:e)*(u?1:s),(c===2?A:e)*(u?1:s)),o.setRGB(u===0?0:c===0?1:0,u===0?0:c===1?1:0,u===0?0:c===2?1:0),t.pushSplat(i,r,a,g,o)}}function fh({splats:t,origin:A=new I.Vector3,radius:e=1,maxDepth:s=3,filter:n=null,pointRadius:i=.02,pointThickness:r=.001,color:a=new I.Color(1,1,1)}){const o={};function g(C){if(n&&!n(C))return;const B=`${C.x},${C.y},${C.z}`;o[B]||(o[B]=C)}function l(C,B,Q,f){if(g(B),g(Q),g(f),C>=s)return;const p=new I.Vector3().addVectors(B,Q).normalize(),d=new I.Vector3().addVectors(Q,f).normalize(),y=new I.Vector3().addVectors(f,B).normalize();l(C+1,B,p,y),l(C+1,p,Q,d),l(C+1,y,d,f),l(C+1,p,d,y)}for(const C of[-1,1])for(const B of[-1,1])for(const Q of[-1,1]){const f=new I.Vector3(C,0,0),p=new I.Vector3(0,B,0),d=new I.Vector3(0,0,Q);l(0,f,p,d)}const c=Object.values(o),u=new I.Vector3(i,i,r),h=new I.Quaternion,E=typeof a=="function"?new I.Color:a;for(const C of c)h.setFromUnitVectors(new I.Vector3(0,0,-1),C),typeof a=="function"&&a(E,C),C.multiplyScalar(e),C.add(A),t.pushSplat(C,u,h,1,E)}function dh({text:t,font:A,fontSize:e,color:s,rgb:n,dotRadius:i,textAlign:r,lineHeight:a,objectScale:o}){A=A??"Arial",e=e??32,s=s??new I.Color(1,1,1),i=i??.8,r=r??"start",a=a??1,o=o??1;const g=t.split(`
`),l=document.createElement("canvas"),c=l.getContext("2d");if(!c)throw new Error("Failed to create canvas context");c.font=`${e}px ${A}`,c.textAlign=r;const u=c.measureText(""),h=u.fontBoundingBoxAscent+u.fontBoundingBoxDescent;let E=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,B=Number.POSITIVE_INFINITY,Q=Number.NEGATIVE_INFINITY;for(let F=0;F<g.length;++F){const b=c.measureText(g[F]),k=h*a*F;E=Math.min(E,-b.actualBoundingBoxLeft),C=Math.max(C,b.actualBoundingBoxRight),B=Math.min(B,k-b.actualBoundingBoxAscent),Q=Math.max(Q,k+b.actualBoundingBoxDescent)}const f=Math.floor(E),p=Math.floor(B),d=Math.ceil(C)-f,y=Math.ceil(Q)-p;l.width=d,l.height=y,c.font=`${e}px ${A}`,c.textAlign=r,c.textBaseline="alphabetic",c.fillStyle="#FFFFFF";for(let F=0;F<g.length;++F){const b=h*a*F-p;c.fillText(g[F],-f,b)}const D=c.getImageData(0,0,d,y),x=new Uint8Array(D.data.buffer),m=new HA,w=new I.Vector3,T=new I.Vector3().setScalar(i*o),M=new I.Quaternion(0,0,0,1);n=n??new I.Color(1,1,1);let S=0;for(let F=0;F<y;++F)for(let b=0;b<d;++b){const k=x[S+3];if(k>0){const R=k/255;w.set(b-.5*(d-1),.5*(y-1)-F,0),w.multiplyScalar(o),m.pushSplat(w,T,M,R,n)}S+=4}const U=new ct({packedSplats:m});return U.recolor=s,U}function yh({url:t,dotRadius:A,subXY:e,forEachSplat:s}){return A=A??.8,e=Math.max(1,Math.floor(e??1)),new ct({constructSplats:async n=>new Promise((i,r)=>{const a=new Image;a.crossOrigin="anonymous",a.onerror=r,a.onload=()=>{const{width:o,height:g}=a,l=document.createElement("canvas");l.width=o,l.height=g;const c=l.getContext("2d");if(!c){r(new Error("Failed to create canvas context"));return}c.imageSmoothingEnabled=!0,c.imageSmoothingQuality="high";const u=Math.round(o/e),h=Math.round(g/e);c.drawImage(a,0,0,u,h);try{const E=c.getImageData(0,0,u,h),C=new Uint8Array(E.data.buffer),B=new I.Vector3,Q=new I.Vector3().setScalar(A),f=new I.Quaternion(0,0,0,1),p=new I.Color;let d=0;for(let y=0;y<h;++y)for(let D=0;D<u;++D){const x=d*4,m=C[x+3];if(m>0){let w=m/255;p.set(C[x+0]/255,C[x+1]/255,C[x+2]/255),B.set(D-.5*(u-1),.5*(h-1)-y,0),Q.setScalar(A),f.set(0,0,0,1);let T=!0;if(s){const M=s(u,h,d,B,Q,f,w,p);w=M??w,T=M!==null}T&&n.pushSplat(B,Q,f,w,p)}d+=1}i()}catch(E){r(E)}},a.src=t})})}function mh({box:t,cells:A,dotScale:e,color:s,opacity:n}){A.x=Math.max(1,Math.round(A.x)),A.y=Math.max(1,Math.round(A.y)),A.z=Math.max(1,Math.round(A.z)),n=n??1;const i=A.x*A.y*A.z,r=J("int",A.x),a=J("int",A.y);J("int",A.z);const o=qA(0),g=new Tt({numSplats:i,generator:FA({index:"int"},{gsplat:AA},({index:c})=>{if(!c)throw new Error("index is undefined");const u=Ke(c,r),h=le(c,r),E=Ke(h,a),C=le(h,a),B=PA({vectorType:"ivec3",x:u,y:E,z:C}),Q=lr(o),f=PA({vectorType:"ivec2",x:c,y:Q}),p=Ca(f),d=J("vec3",t.min),y=J("vec3",t.max),D=ft(y,d),x=le(EA(Qt(B),p),J("vec3",A));let m,w,T;s?(m=J("float",s.r),w=J("float",s.g),T=J("float",s.b)):{r:m,g:w,b:T}=pt(x).outputs;const M=PA({vectorType:"vec4",r:m,g:w,b:T,a:J("float",n)}),S=EA(d,rA(D,x)),U=Qt(J("float",e)),F=J("vec4",new I.Quaternion(0,0,0,1));let b=rt({flags:he("uint","GSPLAT_FLAG_ACTIVE"),index:c,center:S,scales:U,quaternion:F,rgba:M});return b=l.applyGsplat(b),{gsplat:b}},{globals:()=>[NA]}),update:({time:c})=>{o.value=c,l.update(g),g.updateVersion()}}),l=new ht;return g}const wh={box:new I.Box3(new I.Vector3(-1,-1,-1),new I.Vector3(1,1,1)),density:100,fallDirection:new I.Vector3(-1,-3,1).normalize(),fallVelocity:.02,wanderScale:.04,wanderVariance:2,color1:new I.Color(1,1,1),color2:new I.Color(.5,.5,1),minScale:.001,maxScale:.005,anisoScale:new I.Vector3(1,1,1)},xh={box:new I.Box3(new I.Vector3(-2,-1,-2),new I.Vector3(2,5,2)),density:10,fallDirection:new I.Vector3(0,-1,0),fallVelocity:2,wanderScale:.1,wanderVariance:1,color1:new I.Color(1,1,1),color2:new I.Color(.25,.25,.5),minScale:.005,maxScale:.01,anisoScale:new I.Vector3(.1,1,.1)};function Sh({box:t,minY:A,numSplats:e,density:s,anisoScale:n,minScale:i,maxScale:r,fallDirection:a,fallVelocity:o,wanderScale:g,wanderVariance:l,color1:c,color2:u,opacity:h,onFrame:E}){t=t??new I.Box3(new I.Vector3(-1,-1,-1),new I.Vector3(1,1,1));const C=(t.max.x-t.min.x)*(t.max.y-t.min.y)*(t.max.z-t.min.z);s=s??100,e=e??Math.max(1,Math.min(1e6,Math.round(C*s)));const B=qA(i??.001),Q=qA(r??.005),f=et(((n==null?void 0:n.clone())??new I.Vector3(1,1,1)).normalize()),p=et((a??new I.Vector3(0,-1,0)).normalize()),d=qA(o??.02),y=qA(g??.01),D=qA(l??2),x=et(c??new I.Color(1,1,1)),m=et(u??new I.Color(.5,.5,1)),w=qA(h??1),T=qA(0),M=et(new I.Vector3(0,0,0)),S=et(t.min),U=et(t.max),F=qA(A??Number.NEGATIVE_INFINITY),b=ft(U,S),k=new Tt({numSplats:e,generator:FA({index:"int"},{gsplat:AA},({index:X})=>{if(!X)throw new Error("index not defined");const _=Pe(X),eA=pt(_).outputs.w;let q=Qt(_),Z=ue(rA(eA,J("float",100)));Z=Ve(rA(he("float","PI"),Z)),Z=EA(B,rA(Z,ft(Q,B)));const L=rA(Z,f),j=ue(rA(eA,J("float",10))),V=ue(eA),W=hi(x,m,V),G=rA(W,j),dA=Pe(PA({vectorType:"ivec2",x:X,y:J("int",6837)}));let lA=Qt(dA),yA=rA(pt(dA).outputs.w,D);yA=EA(T,yA),q=EA(q,M);const mA=ui(q,J("vec3",new I.Vector3(1,1,1)));q=EA(S,rA(b,mA));const SA=J("vec4",new I.Quaternion(0,0,0,1));lA=Ve(EA(Qt(yA),lA)),lA=rA(lA,y);let BA=EA(q,lA),JA=pt(BA).outputs.y;JA=Ii(F,JA),BA=PA({vector:BA,y:JA});let DA=rt({flags:he("uint","GSPLAT_FLAG_ACTIVE"),index:X,center:BA,scales:L,quaternion:SA,rgb:G,opacity:w});return DA=R.applyGsplat(DA),{gsplat:DA}},{globals:()=>[NA]}),update:({object:X,time:_,deltaTime:eA})=>{T.value=_,R.update(k);const q=p.value.clone().multiplyScalar(d.value*eA);M.value.add(q),X.visible=w.value>0,E==null||E({object:X,time:_,deltaTime:eA}),k.updateVersion()}}),R=new ht;return{snow:k,min:S,max:U,minY:F,color1:x,color2:m,opacity:w,fallVelocity:d,wanderVariance:D,wanderScale:y,fallDirection:p,minScale:B,maxScale:Q,anisoScale:f}}const Dh=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_RAIN:xh,DEFAULT_SNOW:wh,snowBox:Sh,staticBox:mh},Symbol.toStringTag,{value:"Module"}));function fo(t){return FA({gsplat:AA},{gsplat:AA},({gsplat:A})=>{if(!A)throw new Error("No gsplat input");let e=He(A);const s=t.applyGsplat(A),n=Bt(s).outputs.center,i=He(s),r=qr(n,i),a=$i(r,J("float",0));e=cs(a,os(e),e);const o=EA(rA(e,J("float",.5)),J("float",.5));return A=rt({gsplat:A,rgb:o}),{gsplat:A}})}function Mh(t){t.enableWorldToView=!0,t.worldModifier=fo(t.context.worldToView),t.updateGenerator()}function yo(t,A,e,s){return FA({gsplat:AA},{gsplat:AA},({gsplat:n})=>{if(!n)throw new Error("No gsplat input");let{center:i}=Bt(n).outputs;i=t.apply(i);const{z:r}=pt(i).outputs;let a=Ba(os(r),A,e);return a=cs(s,ft(J("float",1),a),a),n=rt({gsplat:n,r:a,g:a,b:a}),{gsplat:n}})}function vh(t,A,e,s){t.enableWorldToView=!0;const n=J("float",A),i=J("float",e),r=J("bool",s??!1);return t.worldModifier=yo(t.context.worldToView,n,i,r),t.updateGenerator(),{minDepth:n,maxDepth:i,reverse:r}}const bh=Object.freeze(Object.defineProperty({__proto__:null,makeDepthColorModifier:yo,makeNormalColorModifier:fo,setDepthColor:vh,setWorldNormalColor:Mh},Symbol.toStringTag,{value:"Module"})),Vt=class Vt{static createButton(A,e={}){const s=navigator.xr;if(!s)return null;const n=s,i=document.createElement("button");A.xr.enabled=!0,A.xr.setReferenceSpaceType("local");function r(){let c=null;async function u(C){console.log("onSessionStarted"),C.addEventListener("end",h),await A.xr.setSession(C),i.textContent="EXIT VR",c=C}function h(){console.log("onSessionEnded"),c==null||c.removeEventListener("end",h),i.textContent="ENTER VR",c=null}i.style.display="",i.style.cursor="pointer",i.style.left="calc(50% - 100px)",i.style.width="200px",i.style.height="100px",i.textContent="ENTER VR";const E={...e,optionalFeatures:[...e.optionalFeatures||[]]};i.onmouseenter=()=>{i.style.opacity="1.0"},i.onmouseleave=()=>{i.style.opacity="0.5"},i.onclick=()=>{c===null?(console.log("requesting session"),n.requestSession("immersive-vr",E).then(u)):(console.log("ending session"),c.end())}}function a(){i.style.display="none",i.style.cursor="auto",i.style.left="calc(50% - 75px)",i.style.width="150px",i.onmouseenter=null,i.onmouseleave=null,i.onclick=null}function o(){a(),i.textContent="VR NOT SUPPORTED"}function g(c){a(),console.warn("Exception when trying to call xr.isSessionSupported",c),i.textContent="VR NOT ALLOWED"}function l(c){c.style.position="absolute",c.style.bottom="20px",c.style.padding="12px 6px",c.style.border="1px solid #fff",c.style.borderRadius="4px",c.style.background="rgba(0,0,0,0.1)",c.style.color="#fff",c.style.font="normal 13px sans-serif",c.style.textAlign="center",c.style.opacity="0.5",c.style.outline="none",c.style.zIndex="999"}return i.id="VRButton",i.style.display="none",l(i),n.isSessionSupported("immersive-vr").then(c=>{c?r():o(),c&&Vt.xrSessionIsGranted&&i.click()}).catch(g),i}static registerSessionGrantedListener(){const A=navigator.xr;if(!A)return null;const e=A;/WebXRViewer\//i.test(navigator.userAgent)||e.addEventListener("sessiongranted",()=>{Vt.xrSessionIsGranted=!0})}};Vt.xrSessionIsGranted=!1;let de=Vt;de.registerSessionGrantedListener();const Fh=.5,Nh=.5,Th=0;var Me=(t=>(t.w="wrist",t.t0="thumb-metacarpal",t.t1="thumb-phalanx-proximal",t.t2="thumb-phalanx-distal",t.t3="thumb-tip",t.i0="index-finger-metacarpal",t.i1="index-finger-phalanx-proximal",t.i2="index-finger-phalanx-intermediate",t.i3="index-finger-phalanx-distal",t.i4="index-finger-tip",t.m0="middle-finger-metacarpal",t.m1="middle-finger-phalanx-proximal",t.m2="middle-finger-phalanx-intermediate",t.m3="middle-finger-phalanx-distal",t.m4="middle-finger-tip",t.r0="ring-finger-metacarpal",t.r1="ring-finger-phalanx-proximal",t.r2="ring-finger-phalanx-intermediate",t.r3="ring-finger-phalanx-distal",t.r4="ring-finger-tip",t.p0="pinky-finger-metacarpal",t.p1="pinky-finger-phalanx-proximal",t.p2="pinky-finger-phalanx-intermediate",t.p3="pinky-finger-phalanx-distal",t.p4="pinky-finger-tip",t))(Me||{});const Bs=Object.keys(Me),kh=Bs.length,Uh={w:0,t0:1,t1:2,t2:3,t3:4,i0:5,i1:6,i2:7,i3:8,i4:9,m0:10,m1:11,m2:12,m3:13,m4:14,r0:15,r1:16,r2:17,r3:18,r4:19,p0:20,p1:21,p2:22,p3:23,p4:24},zt={w:.02,t0:.02,t1:.014,t2:.0115,t3:.0085,i0:.022,i1:.012,i2:.0085,i3:.0075,i4:.0065,m0:.021,m1:.012,m2:.008,m3:.0075,m4:.0065,r0:.019,r1:.011,r2:.0075,r3:.007,r4:.006,p0:.012,p1:.01,p2:.007,p3:.0065,p4:.0055},mo=[["w","t0","t1","t2","t3"],["w","i0","i1","i2","i3","i4"],["w","m0","m1","m2","m3","m4"],["w","r0","r1","r2","r3","r4"],["w","p0","p1","p2","p3","p4"]],wo=[[8,10,8,6],[8,19,14,8,6],[8,19,14,8,6],[8,19,14,8,6],[8,19,14,8,6]],Gh=["t3","i4","m4","r4","p4"],Rh=["i4","m4","r4","p4"];var Es=(t=>(t.left="left",t.right="right",t))(Es||{});const ye=Object.keys(Es);class Yh{constructor(){this.hands={},this.last={},this.values={},this.tests={},this.lastTests={},this.updated=!1}update({xr:A,xrFrame:e}){const s=A.getSession();if(!s)return;const n=A.getReferenceSpace();if(n&&e.getJointPose){this.last=this.hands,this.lastTests=this.tests,this.hands={},this.values={},this.tests={};for(const i of s.inputSources){if(!i.hand)continue;const r=i.handedness;this.hands[r]={};for(const a of Bs){const o=i.hand.get(Me[a]);if(o){const g=e.getJointPose(o,n);if(g){const{position:l,orientation:c}=g.transform;this.hands[r][a]={position:new sA.Vector3(l.x,l.y,l.z),quaternion:new sA.Quaternion(c.x,c.y,c.z,c.w),radius:g.radius||.001}}}}}for(const i of ye)for(const{key:r,value:a}of[{key:`${i}AllTips`,value:this.allTipsTouching(i)},{key:`${i}IndexThumb`,value:this.touching(i,"i4",i,"t3")},{key:`${i}MiddleThumb`,value:this.touching(i,"m4",i,"t3")},{key:`${i}RingThumb`,value:this.touching(i,"r4",i,"t3")},{key:`${i}PinkyThumb`,value:this.touching(i,"p4",i,"t3")},{key:`${i}TriTips`,value:this.triTipsTouching(i)}])this.values[r]=a,this.tests[r]=a===1?!0:a===0?!1:this.lastTests[r]??!1}}makeGhostMesh(){const A=new sA.Vector3,e=new sA.Vector3(.01,.01,.01),s=new sA.Quaternion(0,0,0,1),n=new sA.Color(1,1,1),i=Math.PI*3;new sA.Color(1,1,1);let r=1;const a=new ct({onFrame:()=>{let o=0;for(const g of ye){const l=this.hands[g];for(const[c,u]of mo.entries())for(let h=1;h<u.length;++h){const E=wo[c][h-1]*2,C=h+1===u.length,B=l==null?void 0:l[u[h-1]],Q=l==null?void 0:l[u[h]];for(let f=0;f<E;++f){const p=(f+.5)/E;if(r=0,B&&Q){A.copy(B.position).lerp(Q.position,p),s.copy(B.quaternion).slerp(Q.quaternion,p);const d=zt[u[h-1]],y=zt[u[h]];let D=(1-p)*d+p*y;C&&p>.8&&(D*=Math.sqrt(1-((p-.8)/.2)**2)),e.set(.65*D,.5*D,.003),n.set(.55+.45*Math.sin(A.x*i),.55+.45*Math.sin(A.y*i),.55+.45*Math.sin(A.z*i)),g==="right"&&n.set(1-n.r,1-n.g,1-n.b),r=.75}a.packedSplats.setSplat(o,A,e,s,r,n),o+=1}}}a.packedSplats.numSplats=o,a.packedSplats.needsUpdate=!0,a.numSplats=o,a.updateVersion()}});return a}distance(A,e,s,n,i=!1){const r=i?this.last[A]:this.hands[A],a=i?this.last[s]:this.hands[s],o=r==null?void 0:r[e],g=a==null?void 0:a[n];return!o||!g?Number.POSITIVE_INFINITY:o.position.distanceTo(g.position)}separation(A,e,s,n,i=!1){const r=this.distance(A,e,s,n,i);return r===Number.POSITIVE_INFINITY?Number.POSITIVE_INFINITY:r-zt[e]-zt[n]}touching(A,e,s,n,i=!1){const r=this.separation(A,e,s,n,i);return r===Number.POSITIVE_INFINITY?Number.POSITIVE_INFINITY:1-Math.max(0,Math.min(1,r/.01-Th))}allTipsTouching(A,e=!1){return Math.min(this.touching(A,"t3",A,"i4",e),this.touching(A,"i4",A,"m4",e),this.touching(A,"m4",A,"r4",e),this.touching(A,"r4",A,"p4",e))}triTipsTouching(A,e=!1){return Math.min(this.touching(A,"t3",A,"i4",e),this.touching(A,"i4",A,"m4",e),this.touching(A,"m4",A,"t3",e))}}class Jh{constructor({xrHands:A,control:e,moveInertia:s,rotateInertia:n}){this.lastGrip={},this.lastPivot=new sA.Vector3,this.rotateVelocity=0,this.velocity=new sA.Vector3,this.xrHands=A,this.control=e,this.moveInertia=s??Fh,this.rotateInertia=n??Nh}update(A){var i,r,a,o,g;const e={};for(const l of ye){const c=this.xrHands.hands[l];c&&this.xrHands.tests[`${l}MiddleThumb`]&&(e[l]=new sA.Vector3().add(((i=c.t3)==null?void 0:i.position)??new sA.Vector3).add(((r=c.i4)==null?void 0:r.position)??new sA.Vector3).add(((a=c.m4)==null?void 0:a.position)??new sA.Vector3).add(((o=c.r4)==null?void 0:o.position)??new sA.Vector3).add(((g=c.p4)==null?void 0:g.position)??new sA.Vector3).multiplyScalar(1/5))}if(e.left&&e.right&&this.lastGrip.left&&this.lastGrip.right){const l=e.left.clone().add(e.right).multiplyScalar(.5),c=this.lastGrip.left.clone().add(this.lastGrip.right).multiplyScalar(.5);this.lastPivot=l;const u=l.clone().applyMatrix4(this.control.matrix);u.sub(c.clone().applyMatrix4(this.control.matrix)),u.multiplyScalar(1/A),this.velocity.lerp(u,1-Math.exp(-20*A));const h=Math.atan2(e.left.z-l.z,e.left.x-l.x),E=Math.atan2(this.lastGrip.left.z-c.z,this.lastGrip.left.x-c.x);let C=h-E;C>Math.PI?C-=Math.PI*2:C<-Math.PI&&(C+=Math.PI*2);const B=C/A,Q=Math.exp(-20*A);this.rotateVelocity=this.rotateVelocity*Q+B*(1-Q)}else if(this.rotateVelocity*=Math.exp(-A/this.rotateInertia),e.left&&this.lastGrip.left){const l=e.left.clone().applyMatrix4(this.control.matrix);l.sub(this.lastGrip.left.clone().applyMatrix4(this.control.matrix)),l.multiplyScalar(1/A),this.velocity.lerp(l,1-Math.exp(-20*A))}else if(e.right&&this.lastGrip.right){const l=e.right.clone().applyMatrix4(this.control.matrix);l.sub(this.lastGrip.right.clone().applyMatrix4(this.control.matrix)),l.multiplyScalar(1/A),this.velocity.lerp(l,1-Math.exp(-20*A))}else this.velocity.multiplyScalar(Math.exp(-A/this.moveInertia));const s=this.lastPivot.clone().negate(),n=new sA.Matrix4().makeTranslation(s).premultiply(new sA.Matrix4().makeRotationY(this.rotateVelocity*A)).premultiply(new sA.Matrix4().makeTranslation(this.lastPivot));this.control.matrix.multiply(n),this.control.matrix.decompose(this.control.position,this.control.quaternion,this.control.scale),this.control.updateMatrixWorld(!0),this.control.position.sub(this.velocity.clone().multiplyScalar(A)),this.lastGrip=e}}const _h=1,Lh=2,zh=.002,Hh=.006,qh=.0015,Kh=.15,$h=.15,Ph=.1,Vh=2,Oh=1,Xh=200,Zh=400,jh=50,Wh={KeyW:new I.Vector3(0,0,-1),KeyS:new I.Vector3(0,0,1),KeyA:new I.Vector3(-1,0,0),KeyD:new I.Vector3(1,0,0),KeyR:new I.Vector3(0,1,0),KeyF:new I.Vector3(0,-1,0)},AC={ArrowUp:new I.Vector3(0,0,-1),ArrowDown:new I.Vector3(0,0,1),ArrowLeft:new I.Vector3(-1,0,0),ArrowRight:new I.Vector3(1,0,0),PageUp:new I.Vector3(0,1,0),PageDown:new I.Vector3(0,-1,0)},tC={KeyQ:new I.Vector3(0,0,1),KeyE:new I.Vector3(0,0,-1)},eC={Home:new I.Vector3(0,-1,0),End:new I.Vector3(0,1,0),Insert:new I.Vector3(-1,0,0),Delete:new I.Vector3(1,0,0)};class sC{constructor({canvas:A}){this.lastTime=0,this.fpsMovement=new xo({}),this.pointerControls=new So({canvas:A})}update(A){const e=performance.now(),s=(e-(this.lastTime||e))/1e3;this.lastTime=e,this.fpsMovement.update(s,A),this.pointerControls.update(s,A)}}class xo{constructor({moveSpeed:A,rollSpeed:e,stickThreshold:s,rotateSpeed:n,keycodeMoveMapping:i,keycodeRotateMapping:r,gamepadMapping:a,capsMultiplier:o,shiftMultiplier:g,ctrlMultiplier:l,xr:c}={}){this.enable=!0,this.moveSpeed=A??_h,this.rollSpeed=e??Lh,this.stickThreshold=s??Ph,this.rotateSpeed=n??Vh,this.keycodeMoveMapping=i??{...Wh,...AC},this.keycodeRotateMapping=r??{...tC,...eC},this.gamepadMapping=a??{4:"rollLeft",5:"rollRight",6:"ctrl",7:"shift"},this.capsMultiplier=o??10,this.shiftMultiplier=g??5,this.ctrlMultiplier=l??1/5,this.xr=c,this.keydown={},this.keycode={},document.addEventListener("keydown",u=>{this.keydown[u.key]=!0,this.keycode[u.code]=!0}),document.addEventListener("keyup",u=>{this.keydown[u.key]=!1,this.keycode[u.code]=!1}),window.addEventListener("blur",()=>{this.keydown={},this.keycode={}})}update(A,e){var l,c;if(!this.enable)return;const s=[new I.Vector2,new I.Vector2],n=navigator.getGamepads()[0];n&&(s[0].set(n.axes[0],n.axes[1]),s[1].set(n.axes[2],n.axes[3]));const i=(n==null?void 0:n.buttons.map(u=>u.pressed))||[],r=Array.from(((c=(l=this.xr)==null?void 0:l.getSession())==null?void 0:c.inputSources)??[]);for(const u of r){const h=u.gamepad;if(h)switch(u.handedness){case"none":{s[0].x+=h.axes[0],s[0].y+=h.axes[1],s[1].x+=h.axes[2],s[1].y+=h.axes[3];break}case"left":{s[0].x+=h.axes[2],s[0].y+=h.axes[3];break}case"right":{s[1].x+=h.axes[2],s[1].y+=h.axes[3];break}}}for(const u of s)u.x=Math.abs(u.x)>=this.stickThreshold?u.x:0,u.y=Math.abs(u.y)>=this.stickThreshold?u.y:0;const a=new I.Vector3(s[1].x,s[1].y,0).multiplyScalar(this.rotateSpeed);for(const[u,h]of Object.entries(this.keycodeRotateMapping))this.keycode[u]&&a.add(h);for(const u in this.gamepadMapping)if(i[Number.parseInt(u)])switch(this.gamepadMapping[u]){case"rollLeft":a.z+=1;break;case"rollRight":a.z-=1;break}if(a.multiply(new I.Vector3(this.rotateSpeed,this.rotateSpeed,this.rollSpeed)),a.manhattanLength()>0){a.multiplyScalar(A);const u=new I.Euler().setFromQuaternion(e.quaternion,"YXZ");u.y-=a.x,u.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,u.x-a.y)),u.z=Math.max(-Math.PI,Math.min(Math.PI,u.z+a.z)),e.quaternion.setFromEuler(u)}const o=new I.Vector3(s[0].x,0,s[0].y);for(const[u,h]of Object.entries(this.keycodeMoveMapping))this.keycode[u]&&o.add(h);let g=1;this.keydown.CapsLock&&(g*=this.capsMultiplier),(this.keycode.ShiftLeft||this.keycode.ShiftRight)&&(g*=this.shiftMultiplier),(this.keycode.ControlLeft||this.keycode.ControlRight)&&(g*=this.ctrlMultiplier);for(const u in this.gamepadMapping)if(i[Number.parseInt(u)])switch(this.gamepadMapping[u]){case"shift":g*=this.shiftMultiplier;break;case"ctrl":g*=this.ctrlMultiplier;break}o.applyQuaternion(e.quaternion),e.position.add(o.multiplyScalar(this.moveSpeed*g*A))}}class So{constructor({canvas:A,rotateSpeed:e,slideSpeed:s,scrollSpeed:n,swapRotateSlide:i,reverseRotate:r,reverseSlide:a,reverseSwipe:o,reverseScroll:g,moveInertia:l,rotateInertia:c,pointerRollScale:u,doublePress:h}){this.enable=!0,this.canvas=A,this.rotateSpeed=e??zh,this.slideSpeed=s??Hh,this.scrollSpeed=n??qh,this.swapRotateSlide=i??!1,this.reverseRotate=r??!1,this.reverseSlide=a??!1,this.reverseSwipe=o??!1,this.reverseScroll=g??!1,this.moveInertia=l??$h,this.rotateInertia=c??Kh,this.pointerRollScale=u??Oh,this.doublePress=h??(()=>{}),this.doublePressLimitMs=Zh,this.doublePressDistance=jh,this.lastUp=null,this.rotating=null,this.sliding=null,this.dualPress=!1,this.scroll=new I.Vector3,this.rotateVelocity=new I.Vector3,this.moveVelocity=new I.Vector3,A.addEventListener("pointerdown",C=>{const B=this.getPointerPosition(C),Q=B.clone(),f=B.clone(),p=!this.swapRotateSlide&&!this.rotating&&(C.pointerType!=="mouse"||C.button===0)||this.swapRotateSlide&&this.sliding&&!this.rotating&&(C.pointerType!=="mouse"||C.button===1),{pointerId:d,timeStamp:y}=C;if(p)this.rotating={initial:Q,last:f,position:B,pointerId:d,timeStamp:y},A.setPointerCapture(C.pointerId),this.dualPress=!1;else if(!this.sliding){const D=C.pointerType==="mouse"?C.button:void 0;this.sliding={initial:Q,last:f,position:B,pointerId:d,button:D,timeStamp:y},A.setPointerCapture(C.pointerId),this.dualPress=this.rotating!=null&&y-this.rotating.timeStamp<Xh}});const E=C=>{var f,p;((f=this.rotating)==null?void 0:f.pointerId)===C.pointerId?(this.rotating=null,A.releasePointerCapture(C.pointerId),this.dualPress&&this.sliding&&(A.releasePointerCapture(this.sliding.pointerId),this.sliding=null)):((p=this.sliding)==null?void 0:p.pointerId)===C.pointerId&&(this.sliding=null,A.releasePointerCapture(C.pointerId),this.dualPress&&this.rotating&&(A.releasePointerCapture(this.rotating.pointerId),this.rotating=null));const B=this.getPointerPosition(C),Q=this.lastUp;if(this.lastUp={position:B,time:C.timeStamp},Q&&Q.position.distanceTo(B)<this.doublePressDistance){const y=C.timeStamp-Q.time;y<this.doublePressLimitMs&&(this.lastUp=null,this.doublePress({position:B,intervalMs:y}))}};document.addEventListener("pointerup",E),document.addEventListener("pointercancel",E),document.addEventListener("pointermove",C=>{var B,Q;((B=this.rotating)==null?void 0:B.pointerId)===C.pointerId?this.rotating.position=this.getPointerPosition(C):((Q=this.sliding)==null?void 0:Q.pointerId)===C.pointerId&&(this.sliding.position=this.getPointerPosition(C))}),A.addEventListener("contextmenu",C=>{C.preventDefault()}),A.addEventListener("wheel",C=>{this.scroll.add(new I.Vector3(C.deltaX,C.deltaY,C.deltaZ)),C.preventDefault()})}getPointerPosition(A){const e=this.canvas.getBoundingClientRect();return new I.Vector2(A.clientX-e.left,A.clientY-e.top)}update(A,e){if(!this.enable)return;if(this.dualPress&&this.rotating&&this.sliding){const n=[this.rotating.position.clone().sub(this.rotating.last),this.sliding.position.clone().sub(this.sliding.last)],i=n[0].dot(n[1]);if(i>=.2){const r=n[0].clone().add(n[1]),a=new I.Vector3(r.x,-r.y,0);a.multiplyScalar(this.slideSpeed*(this.reverseSwipe?1:-1)),a.applyQuaternion(e.quaternion),e.position.add(a),this.moveVelocity=a.clone().multiplyScalar(1/A)}else if(i<=-.2){const r=this.sliding.last.clone().sub(this.rotating.last),a=r.length();r.multiplyScalar(1/a).normalize();const o=new I.Vector2(-r.y,r.x),g=[n[0].dot(r),n[1].dot(r)],l=[n[0].dot(o),n[1].dot(o)],c=this.rotating.last.clone().add(this.sliding.last).multiplyScalar(.5);let u=new I.Vector3;if(e instanceof I.Camera){const f=new I.Vector2(c.x/this.canvas.clientWidth*2-1,-(c.y/this.canvas.clientHeight)*2+1),p=new I.Raycaster;p.setFromCamera(f,e),u=p.ray.direction}const h=g[1]-g[0],E=u.multiplyScalar(h*this.slideSpeed);e.position.add(E),this.moveVelocity=E.clone().multiplyScalar(1/A);const C=[Math.atan(l[0]/(-.5*a)),Math.atan(l[1]/(.5*a))],B=.5*(C[0]+C[1])*this.pointerRollScale,Q=new I.Euler().setFromQuaternion(e.quaternion,"YXZ");Q.z=Math.max(-Math.PI,Math.min(Math.PI,Q.z+.5*B)),e.quaternion.setFromEuler(Q)}this.rotating.last.copy(this.rotating.position),this.sliding.last.copy(this.sliding.position)}else{const n=new I.Vector3;if(this.rotating&&!this.dualPress){const r=this.rotating.position.clone().sub(this.rotating.last);this.rotating.last.copy(this.rotating.position),n.set(r.x,r.y,0),n.multiplyScalar(this.rotateSpeed*(this.reverseRotate?-1:1)),this.rotateVelocity=n.clone().multiplyScalar(1/A)}else this.rotateVelocity.multiplyScalar(Math.exp(-A/this.rotateInertia)),n.addScaledVector(this.rotateVelocity,A);const i=new I.Euler().setFromQuaternion(e.quaternion,"YXZ");if(i.y-=n.x,i.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,i.x-n.y)),i.z*=Math.exp(-0*A),e.quaternion.setFromEuler(i),this.sliding&&!this.dualPress){const r=this.sliding.position.clone().sub(this.sliding.last);this.sliding.last.copy(this.sliding.position);const a=this.sliding.button!==2?new I.Vector3(r.x,0,r.y):new I.Vector3(r.x,-r.y,0);a.multiplyScalar(this.slideSpeed*(this.reverseSlide?-1:1)),a.applyQuaternion(e.quaternion),e.position.add(a),this.moveVelocity=a.clone().multiplyScalar(1/A)}else this.moveVelocity.multiplyScalar(Math.exp(-A/this.moveInertia)),e.position.addScaledVector(this.moveVelocity,A)}const s=this.scroll.multiplyScalar(this.scrollSpeed);s.set(s.x,s.z,s.y),this.reverseScroll&&s.multiplyScalar(-1),s.applyQuaternion(e.quaternion),e.position.add(s),this.scroll.set(0,0,0)}}exports.FINGER_TIPS=Rh;exports.FpsMovement=xo;exports.HANDS=ye;exports.Hand=Es;exports.HandMovement=Jh;exports.JOINT_IDS=Bs;exports.JOINT_INDEX=Uh;exports.JOINT_RADIUS=zt;exports.JOINT_SEGMENTS=mo;exports.JOINT_SEGMENT_STEPS=wo;exports.JOINT_TIPS=Gh;exports.JointEnum=Me;exports.LN_SCALE_MAX=kA;exports.LN_SCALE_MIN=TA;exports.NUM_JOINTS=kh;exports.PackedSplats=HA;exports.PlyReader=jt;exports.PointerControls=So;exports.Readback=Xt;exports.RgbaArray=pe;exports.Sint8ToFloat=$n;exports.SparkControls=sC;exports.SparkRenderer=Ae;exports.SparkViewpoint=Wt;exports.SplatAccumulator=Ie;exports.SplatEdit=Zt;exports.SplatEditRgbaBlendMode=eo;exports.SplatEditSdf=so;exports.SplatEditSdfType=to;exports.SplatEdits=no;exports.SplatFileType=Dt;exports.SplatGenerator=Tt;exports.SplatLoader=Io;exports.SplatMesh=ct;exports.SplatModifier=oo;exports.SplatSkinning=Ch;exports.SplatTransformer=ht;exports.SpzReader=Co;exports.SpzWriter=XA;exports.Uint8ToFloat=Kn;exports.VRButton=de;exports.XrHands=Yh;exports.constructAxes=ph;exports.constructGrid=Qh;exports.constructSpherePoints=fh;exports.defines=pc;exports.dyno=mI;exports.flipPixels=Wn;exports.floatToSint8=Pt;exports.floatToUint8=bA;exports.fromHalf=fA;exports.generators=Dh;exports.getSplatFileType=us;exports.imageSplats=yh;exports.isAndroid=Zn;exports.isMobile=Xn;exports.isOculus=jn;exports.isPcSogs=th;exports.modifiers=bh;exports.pixelsToPngUrl=Ai;exports.readRgbaArray=Ao;exports.setPackedSplat=Be;exports.textSplats=dh;exports.toHalf=at;exports.transcodeSpz=hh;exports.unpackSplat=Ee;exports.unpackSplats=hs;exports.utils=Og;
//# sourceMappingURL=spark.cjs.min.js.map
